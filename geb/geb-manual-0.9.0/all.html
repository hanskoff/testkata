<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link href="css/stylesheet.css" rel="stylesheet" type="text/css" media="all">
  <title>The Book Of Geb</title>
  
  <link type="text/css" rel="stylesheet" href="css/shCore.css"></link>
  <link type="text/css" rel="stylesheet" href="css/shThemeEclipse.css"></link>
  <script language="javascript" src="js/shCore.js"></script>
  <script language="javascript" src="js/shBrushGroovy.js"></script>
  <script type="text/javascript" src="js/jquery-1.6.1.min.js"></script>
  <script type="text/javascript" src="js/syntaxhighlight.js"></script>
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-15031038-2']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body>
<div id="wrapper">
  <h1 class="title">The Book Of Geb</h1>
  <p class="tag">— Very Groovy browser automation… web testing, screen scraping and more —</p>
  <div class="toc">
      <h2>Version: 0.9.0</h2>
	  <p class="manual-links"> - <a href="index.html">Multi Page</a> | <strong>Single Page</strong> | <a href="https://oss.sonatype.org/content/repositories/releases/org/gebish/geb-manual/0.9.0/geb-manual-0.9.0.zip">Zip Download</a> -</p>
    <ul><li><span class='toc_number'>1</span><a href='all.html#introduction'>Introduction</a><ul><li><span class='toc_number'>1.1</span><a href='all.html#the_browser_automation_technology'>The Browser Automation Technology</a></li><li><span class='toc_number'>1.2</span><a href='all.html#the_page_object_pattern'>The Page Object Pattern</a></li><li><span class='toc_number'>1.3</span><a href='all.html#the_jquery_ish_navigator_api'>The jQuery-ish Navigator API</a></li><li><span class='toc_number'>1.4</span><a href='all.html#full_examples'>Full Examples</a><ul><li><span class='toc_number'>1.4.1</span><a href='all.html#inline_scripting'>Inline Scripting</a></li><li><span class='toc_number'>1.4.2</span><a href='all.html#scripting_with_page_objects'>Scripting with Page Objects</a></li><li><span class='toc_number'>1.4.3</span><a href='all.html#testing'>Testing</a></li></ul><span class='toc_number'>1.5</span><a href='all.html#installation__usage'>Installation & Usage</a></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>2</span><a href='all.html#the_browser'>The Browser</a><ul><li><span class='toc_number'>2.1</span><a href='all.html#the_drive_method'>The drive() method</a></li><li><span class='toc_number'>2.2</span><a href='all.html#making_requests'>Making requests</a><ul><li><span class='toc_number'>2.2.1</span><a href='all.html#the_base_url'>The base URL</a></li><li><span class='toc_number'>2.2.2</span><a href='all.html#using_pages'>Using pages</a></li><li><span class='toc_number'>2.2.3</span><a href='all.html#direct'>Direct</a></li></ul><span class='toc_number'>2.3</span><a href='all.html#the_page'>The Page</a><ul><li><span class='toc_number'>2.3.1</span><a href='all.html#changing_the_page'>Changing the page</a></li></ul><span class='toc_number'>2.4</span><a href='all.html#at_checking'>At checking</a></li><li><span class='toc_number'>2.5</span><a href='all.html#page_change_listening'>Page change listening</a></li><li><span class='toc_number'>2.6</span><a href='all.html#working_with_multiple_tabs_and_windows'>Working with multiple tabs and windows</a><ul><li><span class='toc_number'>2.6.1</span><a href='all.html#switching_context_to_already_opened_windows'>Switching context to already opened windows</a></li><li><span class='toc_number'>2.6.2</span><a href='all.html#switching_context_to_newly_opened_windows'>Switching context to newly opened windows</a><ul><li><span class='toc_number'>2.6.2.1</span><a href='all.html#passing_options_when_working_with_newly_opened_windows'>Passing options when working with newly opened windows</a><ul><li><span class='toc_number'>2.6.2.1.1</span><a href='all.html#close'>close</a></li><li><span class='toc_number'>2.6.2.1.2</span><a href='all.html#page'>page</a></li><li><span class='toc_number'>2.6.2.1.3</span><a href='all.html#wait'>wait</a></li></ul></li></ul></li></ul><span class='toc_number'>2.7</span><a href='all.html#quitting_the_browser'>Quitting the browser</a></li></ul></li></ul></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>3</span><a href='all.html#the_webdriver_implementation'>The WebDriver Implementation</a><ul><li><span class='toc_number'>3.1</span><a href='all.html#explicit_driver_management'>Explicit Driver Management</a><ul><li><span class='toc_number'>3.1.1</span><a href='all.html#explicit_lifecycle'>Explicit Lifecycle</a></li></ul><span class='toc_number'>3.2</span><a href='all.html#implicit_driver_management'>Implicit Driver Management</a><ul><li><span class='toc_number'>3.2.1</span><a href='all.html#implicit_lifecycle'>Implicit Lifecycle</a></li></ul><span class='toc_number'>3.3</span><a href='all.html#driver_quirks'>Driver Quirks</a><ul><li><span class='toc_number'>3.3.1</span><a href='all.html#htmlunitdriver'>HTMLUnitDriver</a><ul><li><span class='toc_number'>3.3.1.1</span><a href='all.html#dealing_with_pages_that_use_html_refreshes'>Dealing with pages that use HTML refreshes</a></li><li><span class='toc_number'>3.3.1.2</span><a href='all.html#configuring_logging'>Configuring logging</a></li></ul></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>4</span><a href='all.html#interacting_with_content'>Interacting with content</a><ul><li><span class='toc_number'>4.1</span><a href='all.html#the__function'>The $ Function</a><ul><li><span class='toc_number'>4.1.1</span><a href='all.html#css_selectors'>CSS Selectors</a></li><li><span class='toc_number'>4.1.2</span><a href='all.html#indexes_and_ranges'>Indexes and Ranges</a></li><li><span class='toc_number'>4.1.3</span><a href='all.html#attribute_and_text_matching'>Attribute and Text Matching</a><ul><li><span class='toc_number'>4.1.3.1</span><a href='all.html#using_patterns'>Using Patterns</a></li></ul><span class='toc_number'>4.1.4</span><a href='all.html#navigators_are_iterable'>Navigators are Iterable</a></li></ul><span class='toc_number'>4.2</span><a href='all.html#finding__filtering'>Finding & Filtering</a></li><li><span class='toc_number'>4.3</span><a href='all.html#traversing'>Traversing</a></li><li><span class='toc_number'>4.4</span><a href='all.html#composition'>Composition</a></li><li><span class='toc_number'>4.5</span><a href='all.html#clicking'>Clicking</a></li><li><span class='toc_number'>4.6</span><a href='all.html#determining_visibility'>Determining Visibility</a></li><li><span class='toc_number'>4.7</span><a href='all.html#size_and_location'>Size and Location</a></li><li><span class='toc_number'>4.8</span><a href='all.html#accessing_tag_name_attributes_text_and_classes'>Accessing tag name, attributes, text and classes</a></li><li><span class='toc_number'>4.9</span><a href='all.html#sending_keystrokes'>Sending keystrokes</a><ul><li><span class='toc_number'>4.9.1</span><a href='all.html#non_characters_eg_delete_key'>Non characters (e.g. delete key)</a></li></ul><span class='toc_number'>4.10</span><a href='all.html#accessing_input_values'>Accessing input values</a></li><li><span class='toc_number'>4.11</span><a href='all.html#form_control_shortcuts'>Form Control Shortcuts</a><ul><li><span class='toc_number'>4.11.1</span><a href='all.html#setting_values'>Setting Values</a><ul><li><span class='toc_number'>4.11.1.1</span><a href='all.html#select'>select</a></li><li><span class='toc_number'>4.11.1.2</span><a href='all.html#multiple_select'>multiple select</a></li><li><span class='toc_number'>4.11.1.3</span><a href='all.html#checkbox'>checkbox</a></li><li><span class='toc_number'>4.11.1.4</span><a href='all.html#radio'>radio</a></li><li><span class='toc_number'>4.11.1.5</span><a href='all.html#text_inputs_and_textareas'>text inputs and textareas</a></li><li><span class='toc_number'>4.11.1.6</span><a href='all.html#file_upload'>file upload</a></li></ul></li></ul><span class='toc_number'>4.12</span><a href='all.html#complex_interactions'>Complex Interactions</a><ul><li><span class='toc_number'>4.12.1</span><a href='all.html#using_the_webdriver_api_directly'>Using the WebDriver API directly</a></li><li><span class='toc_number'>4.12.2</span><a href='all.html#using_actions'>Using Actions</a></li><li><span class='toc_number'>4.12.3</span><a href='all.html#using_interact_closures'>Using Interact Closures</a></li><li><span class='toc_number'>4.12.4</span><a href='all.html#interact_examples'>Interact Examples</a><ul><li><span class='toc_number'>4.12.4.1</span><a href='all.html#drag_and_drop'>Drag and Drop</a></li><li><span class='toc_number'>4.12.4.2</span><a href='all.html#control_clicking'>Control-Clicking</a></li></ul></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>5</span><a href='all.html#pages'>Pages</a><ul><li><span class='toc_number'>5.1</span><a href='all.html#the_page_object_pattern'>The Page Object pattern</a></li><li><span class='toc_number'>5.2</span><a href='all.html#the_page_superclass'>The Page superclass</a></li><li><span class='toc_number'>5.3</span><a href='all.html#the_content_dsl'>The Content DSL</a><ul><li><span class='toc_number'>5.3.1</span><a href='all.html#template_options'>Template Options</a><ul><li><span class='toc_number'>5.3.1.1</span><a href='all.html#required'>required</a></li><li><span class='toc_number'>5.3.1.2</span><a href='all.html#cache'>cache</a></li><li><span class='toc_number'>5.3.1.3</span><a href='all.html#to'>to</a></li><li><span class='toc_number'>5.3.1.4</span><a href='all.html#wait'>wait</a></li><li><span class='toc_number'>5.3.1.5</span><a href='all.html#page'>page</a></li></ul><span class='toc_number'>5.3.2</span><a href='all.html#aliasing'>Aliasing</a></li></ul><span class='toc_number'>5.4</span><a href='all.html#at_verification'>“At” Verification</a></li><li><span class='toc_number'>5.5</span><a href='all.html#page_urls'>Page URLs</a></li><li><span class='toc_number'>5.6</span><a href='all.html#advanced_page_navigation'>Advanced Page Navigation</a><ul><li><span class='toc_number'>5.6.1</span><a href='all.html#named_params'>Named params</a></li></ul><span class='toc_number'>5.7</span><a href='all.html#inheritance'>Inheritance</a></li><li><span class='toc_number'>5.8</span><a href='all.html#lifecycle_hooks'>Lifecycle Hooks</a><ul><li><span class='toc_number'>5.8.1</span><a href='all.html#onloadpage_previouspage'>onLoad(Page previousPage)</a></li><li><span class='toc_number'>5.8.2</span><a href='all.html#onunloadpage_newpage'>onUnload(Page newPage)</a></li></ul><span class='toc_number'>5.9</span><a href='all.html#dealing_with_frames'>Dealing with frames</a><ul><li><span class='toc_number'>5.9.1</span><a href='all.html#executing_code_in_the_context_of_a_frame'>Executing code in the context of a frame</a></li><li><span class='toc_number'>5.9.2</span><a href='all.html#switching_pages_and_frames_at_once'>Switching pages and frames at once</a></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>6</span><a href='all.html#modules'>Modules</a><ul><li><span class='toc_number'>6.1</span><a href='all.html#base_and_context'>Base And Context</a></li><li><span class='toc_number'>6.2</span><a href='all.html#reusing_modules_across_pages'>Reusing modules across pages</a></li><li><span class='toc_number'>6.3</span><a href='all.html#using_modules_for_repeating_content_on_a_page'>Using modules for repeating content on a page</a></li><li><span class='toc_number'>6.4</span><a href='all.html#the_content_dsl'>The Content DSL</a></li><li><span class='toc_number'>6.5</span><a href='all.html#inheritance'>Inheritance</a></li><li><span class='toc_number'>6.6</span><a href='all.html#size_and_location'>Size and Location</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>7</span><a href='all.html#configuration'>Configuration</a><ul><li><span class='toc_number'>7.1</span><a href='all.html#mechanisms_'>Mechanisms </a><ul><li><span class='toc_number'>7.1.1</span><a href='all.html#the_config_script'>The Config Script</a><ul><li><span class='toc_number'>7.1.1.1</span><a href='all.html#environment_sensitivity'>Environment Sensitivity</a></li></ul><span class='toc_number'>7.1.2</span><a href='all.html#system_properties'>System Properties</a></li><li><span class='toc_number'>7.1.3</span><a href='all.html#build_adapter'>Build Adapter</a></li></ul><span class='toc_number'>7.2</span><a href='all.html#config_options'>Config Options</a><ul><li><span class='toc_number'>7.2.1</span><a href='all.html#driver_implementation'>Driver Implementation</a><ul><li><span class='toc_number'>7.2.1.1</span><a href='all.html#factory_closure'>Factory Closure</a></li><li><span class='toc_number'>7.2.1.2</span><a href='all.html#driver_class_name'>Driver Class Name</a></li></ul><span class='toc_number'>7.2.2</span><a href='all.html#navigator_factory'>Navigator Factory</a></li><li><span class='toc_number'>7.2.3</span><a href='all.html#driver_caching'>Driver Caching</a></li><li><span class='toc_number'>7.2.4</span><a href='all.html#base_url'>Base URL</a></li><li><span class='toc_number'>7.2.5</span><a href='all.html#waiting'>Waiting</a><ul><li><span class='toc_number'>7.2.5.1</span><a href='all.html#defaults'>Defaults</a></li><li><span class='toc_number'>7.2.5.2</span><a href='all.html#presets'>Presets</a></li></ul><span class='toc_number'>7.2.6</span><a href='all.html#reporter'>Reporter</a></li><li><span class='toc_number'>7.2.7</span><a href='all.html#reports_dir'>Reports Dir</a></li><li><span class='toc_number'>7.2.8</span><a href='all.html#report_test_failures_only'>Report Test Failures Only</a></li><li><span class='toc_number'>7.2.9</span><a href='all.html#reporting_listener'>Reporting listener</a></li><li><span class='toc_number'>7.2.10</span><a href='all.html#auto_clearing_cookies'>Auto Clearing Cookies</a></li></ul><span class='toc_number'>7.3</span><a href='all.html#runtime_overrides'>Runtime Overrides</a></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>8</span><a href='all.html#implicit_assertions'>Implicit Assertions</a><ul><li><span class='toc_number'>8.1</span><a href='all.html#at_verification'>At Verification</a></li><li><span class='toc_number'>8.2</span><a href='all.html#waiting'>Waiting</a><ul><li><span class='toc_number'>8.2.1</span><a href='all.html#waiting_content'>Waiting Content</a></li></ul><span class='toc_number'>8.3</span><a href='all.html#how_it_works_'>How it works </a></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>9</span><a href='all.html#javascript_ajax_and_dynamic_pages'>Javascript, AJAX and Dynamic Pages</a><ul><li><span class='toc_number'>9.1</span><a href='all.html#the_js_object'>The “js” object</a><ul><li><span class='toc_number'>9.1.1</span><a href='all.html#accessing_variables'>Accessing Variables</a></li><li><span class='toc_number'>9.1.2</span><a href='all.html#calling_methods'>Calling Methods</a></li><li><span class='toc_number'>9.1.3</span><a href='all.html#executing_arbitrary_code'>Executing Arbitrary Code</a></li></ul><span class='toc_number'>9.2</span><a href='all.html#waiting'>Waiting</a><ul><li><span class='toc_number'>9.2.1</span><a href='all.html#examples'>Examples</a></li><li><span class='toc_number'>9.2.2</span><a href='all.html#custom_message'>Custom message</a></li></ul><span class='toc_number'>9.3</span><a href='all.html#alert_and_confirm_dialogs'>Alert and Confirm Dialogs</a><ul><li><span class='toc_number'>9.3.1</span><a href='all.html#alert'>alert()</a></li><li><span class='toc_number'>9.3.2</span><a href='all.html#confirm'>confirm()</a></li><li><span class='toc_number'>9.3.3</span><a href='all.html#about_prompt'>About prompt()</a></li></ul><span class='toc_number'>9.4</span><a href='all.html#jquery_integration'>jQuery Integration</a><ul><li><span class='toc_number'>9.4.1</span><a href='all.html#why'>Why?</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>10</span><a href='all.html#direct_downloading'>Direct Downloading</a><ul><li><span class='toc_number'>10.1</span><a href='all.html#downloading_example'>Downloading Example</a></li><li><span class='toc_number'>10.2</span><a href='all.html#fine_grained_request'>Fine Grained Request</a></li><li><span class='toc_number'>10.3</span><a href='all.html#errors'>Errors</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>11</span><a href='all.html#scripts_and_binding'>Scripts and Binding</a><ul><li><span class='toc_number'>11.1</span><a href='all.html#setup'>Setup</a></li><li><span class='toc_number'>11.2</span><a href='all.html#the_binding_environment'>The binding environment</a><ul><li><span class='toc_number'>11.2.1</span><a href='all.html#browser_methods__properties'>Browser methods & properties</a></li><li><span class='toc_number'>11.2.2</span><a href='all.html#the_current_page'>The current page</a></li></ul></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>12</span><a href='all.html#reporting'>Reporting</a><ul><li><span class='toc_number'>12.1</span><a href='all.html#the_report_group'>The report group</a></li><li><span class='toc_number'>12.2</span><a href='all.html#listening_to_reporting'>Listening to reporting</a></li><li><span class='toc_number'>12.3</span><a href='all.html#cleaning'>Cleaning</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>13</span><a href='all.html#testing'>Testing</a><ul><li><span class='toc_number'>13.1</span><a href='all.html#spock_junit__testng'>Spock, JUnit & TestNG</a><ul><li><span class='toc_number'>13.1.1</span><a href='all.html#configuration'>Configuration</a></li><li><span class='toc_number'>13.1.2</span><a href='all.html#reporting'>Reporting</a></li><li><span class='toc_number'>13.1.3</span><a href='all.html#cookie_management'>Cookie management</a></li><li><span class='toc_number'>13.1.4</span><a href='all.html#jar_and_class_names'>Jar and class names</a></li><li><span class='toc_number'>13.1.5</span><a href='all.html#example_projects'>Example Projects</a></li></ul><span class='toc_number'>13.2</span><a href='all.html#easyb'>EasyB</a><ul><li><span class='toc_number'>13.2.1</span><a href='all.html#configuration'>Configuration</a></li></ul><span class='toc_number'>13.3</span><a href='all.html#cucumber_cuke4duke'>Cucumber (Cuke4Duke)</a><ul><li><span class='toc_number'>13.3.1</span><a href='all.html#example_projects'>Example Projects</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>14</span><a href='all.html#build_system__framework_integrations'>Build System & Framework Integrations</a><ul><li><span class='toc_number'>14.1</span><a href='all.html#grails'>Grails</a></li><li><span class='toc_number'>14.2</span><a href='all.html#gradle'>Gradle</a></li><li><span class='toc_number'>14.3</span><a href='all.html#maven'>Maven</a></li></ul></li></ul></li></ul><ul><li><span class='toc_number'>15</span><a href='all.html#about_the_project'>About the Project</a><ul><li><span class='toc_number'>15.1</span><a href='all.html#api_reference'>API Reference</a></li><li><span class='toc_number'>15.2</span><a href='all.html#support__development'>Support & Development</a></li><li><span class='toc_number'>15.3</span><a href='all.html#credits'>Credits</a><ul><li><span class='toc_number'>15.3.1</span><a href='all.html#committers'>Committers</a></li><li><span class='toc_number'>15.3.2</span><a href='all.html#contributors'>Contributors</a></li></ul><span class='toc_number'>15.4</span><a href='all.html#history'>History</a><ul><li><span class='toc_number'>15.4.1</span><a href='all.html#090'>0.9.0</a><ul><li><span class='toc_number'>15.4.1.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.1.2</span><a href='all.html#fixes'>Fixes</a></li><li><span class='toc_number'>15.4.1.3</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.2</span><a href='all.html#072'>0.7.2</a><ul><li><span class='toc_number'>15.4.2.1</span><a href='all.html#fixes'>Fixes</a></li></ul><span class='toc_number'>15.4.3</span><a href='all.html#071'>0.7.1</a><ul><li><span class='toc_number'>15.4.3.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.3.2</span><a href='all.html#fixes'>Fixes</a></li></ul><span class='toc_number'>15.4.4</span><a href='all.html#070'>0.7.0</a><ul><li><span class='toc_number'>15.4.4.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.4.2</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.5</span><a href='all.html#063_'>0.6.3 </a><ul><li><span class='toc_number'>15.4.5.1</span><a href='all.html#new_features'>New Features</a></li></ul><span class='toc_number'>15.4.6</span><a href='all.html#062'>0.6.2</a><ul><li><span class='toc_number'>15.4.6.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.6.2</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.7</span><a href='all.html#061'>0.6.1</a><ul><li><span class='toc_number'>15.4.7.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.7.2</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.8</span><a href='all.html#06'>0.6</a><ul><li><span class='toc_number'>15.4.8.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.8.2</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.9</span><a href='all.html#051'>0.5.1</a></li><li><span class='toc_number'>15.4.10</span><a href='all.html#05'>0.5</a><ul><li><span class='toc_number'>15.4.10.1</span><a href='all.html#new_features'>New Features</a></li><li><span class='toc_number'>15.4.10.2</span><a href='all.html#breaking_changes'>Breaking Changes</a></li></ul><span class='toc_number'>15.4.11</span><a href='all.html#04'>0.4</a></li></ul></li></ul></li></ul></li></ul></li></ul>
  </div>
  
    <div class="chapter">
      <h1><span id='introduction'>1</span> Introduction</h1><p>Geb is a developer focused tool for automating the interaction between web browsers and web content. It uses the dynamic language features of <a href="http://groovy.codehaus.org/" title="Groovy - Home">Groovy</a> to provide a powerful content definition DSL (for modelling content for reuse) and key concepts from <a href="http://jquery.com/" title="jQuery: The Write Less, Do More, JavaScript Library">jQuery</a> to provide a powerful content inspection and traveral API (for finding and interacting with content).</p><p>Geb was born out of a desire to make browser automation (originally for web testing) easier and more productive. It aims to be a <strong>developer tool</strong> in that it allows and encourages the using of programming and language constructs instead of creating a restricted environment. It uses Groovy&rsquo;s dynamism to remove the noise and boiler plate code in order to focus on what&rsquo;s important — the content and interaction.</p><h2><span id='the_browser_automation_technology'>1.1</span> The Browser Automation Technology</h2><p>Geb builds on the <a href="http://code.google.com/p/selenium/">WebDriver</a> browser automation library, which means that Geb can work with <a href="http://code.google.com/p/selenium/wiki/FrequentlyAskedQuestions#Q:_Which_browsers_does_support?">any browser that WebDriver can</a>. While Geb provides an extra layer of convenience and productivity, it is always possible to “drop down” to the WebDriver level to do something directly should you need to.</p><p>For more information see the manual section on <a href="driver.html">using a driver implementation</a>.</p><h2><span id='the_page_object_pattern'>1.2</span> The Page Object Pattern</h2><p>The Page Object Pattern gives us a common sense way to model content in a reusable and maintainable way. From the <a href="http://code.google.com/p/selenium/wiki/PageObjects">WebDriver wiki page on the Page Object Pattern</a>:</p>
<blockquote><p>Within your web app&rsquo;s UI there are areas that your tests interact with. A Page Object simply models these as objects within the test code. This reduces the amount of duplicated code and means that if the UI changes, the fix need only be applied in one place.</p>
</blockquote><p>Furthermore (from the same document):</p>
<blockquote><p>PageObjects can be thought of as facing in two directions simultaneously. Facing towards the developer of a test, they represent the services offered by a particular page. Facing away from the developer, they should be the only thing that has a deep knowledge of the structure of the HTML of a page (or part of a page) It&rsquo;s simplest to think of the methods on a Page Object as offering the &ldquo;services&rdquo; that a page offers rather than exposing the details and mechanics of the page. As an example, think of the inbox of any web-based email system. Amongst the services that it offers are typically the ability to compose a new email, to choose to read a single email, and to list the subject lines of the emails in the inbox. How these are implemented shouldn&rsquo;t matter to the test.</p>
</blockquote><p>The Page Object Pattern is an important technique, and Geb provides first class support via its <a href="pages.html">page</a> and <a href="modules.html">module</a> constructs.</p><h2><span id='the_jquery_ish_navigator_api'>1.3</span> The jQuery-ish Navigator API</h2><p>The <a href="http://jquery.com/" title="jQuery: The Write Less, Do More, JavaScript Library">jQuery</a> JavaScript library provides an excellent API for (among other things) selecting or targeting content on a page and traversing through and around content. Geb takes a lot of inspiration from this. </p><p>In Geb, content is selected through the <code>$</code> function, which returns a <a href="api/geb/navigator/Navigator.html"><code>Navigator</code></a> object. A <a href="api/geb/navigator/Navigator.html"><code>Navigator</code></a> object is in someways analogous to the <code>jQuery</code> data type in jQuery in that it represents one or more targeted elements on the page.</p><p>Let&rsquo;s see some examples:</p>
<pre><code>// match all &#39;div&#39; elements on the page
$(&quot;div&quot;)

// match the first &#39;div&#39; element on the page
$(&quot;div&quot;, 0)

// match all &#39;div&#39; elements with a title attribute value of &#39;section&#39;
$(&quot;div&quot;, title: &quot;section&quot;)

// match the first &#39;div&#39; element with a title attribute value of &#39;section&#39;
$(&quot;div&quot;, 0, title: &quot;section&quot;)

// match all &#39;div&#39; elements who have the class &#39;main&#39;
$(&quot;div.main&quot;) 

// match the first &#39;div&#39; element with the class &#39;main&#39;
$(&quot;div.main&quot;, 0) 
</code></pre><p>These methods return <code>Navigator</code> objects that can be used to further refine the content.</p>
<pre><code>// The parent of the first paragraph
$(&quot;p&quot;, 0).parent()

// All tables with a cellspacing attribute value of 0 that are nested in a paragraph
$(&quot;p&quot;).find(&quot;table&quot;, cellspacing: &#39;0&#39;)
</code></pre><p>This is just the beginning of what is possible with the Navigator API. See the <a href="navigator.html">chapter on the navigator</a> for more details.</p><h2><span id='full_examples'>1.4</span> Full Examples</h2><p>Let&rsquo;s have a look at a simple case of wanting to search for “wikipedia” on Google and follow the first result returned.</p><h3><span id='inline_scripting'>1.4.1</span> Inline Scripting</h3><p>Here&rsquo;s an example of using Geb in an inline (i.e. no page objects or predefined content) scripting style…</p>
<pre><code>import geb.Browser

Browser.drive {
    go &quot;http://google.com/ncr&quot;

    // make sure we actually got to the page
    assert title == &quot;Google&quot;

    // enter wikipedia into the search field
    $(&quot;input&quot;, name: &quot;q&quot;).value(&quot;wikipedia&quot;)

    // wait for the change to results page to happen
    // (google updates the page dynamically without a new request)
    waitFor { title.endsWith(&quot;Google Search&quot;) }

    // is the first link to wikipedia?
    def firstLink = $(&quot;li.g&quot;, 0).find(&quot;a.l&quot;)
    assert firstLink.text() == &quot;Wikipedia&quot;

    // click the link 
    firstLink.click()

    // wait for Google&#39;s javascript to redirect to Wikipedia
    waitFor { title == &quot;Wikipedia&quot; }
}
</code></pre><h3><span id='scripting_with_page_objects'>1.4.2</span> Scripting with Page Objects</h3><p>This time let us define our content up front using the Page Object pattern…</p>
<pre><code>import geb.Browser
import geb.Page
import geb.Module

// modules are reusable fragments that can be used across pages that can be paramaterised
// here we are using a module to model the search function on the home and results pages
class GoogleSearchModule extends Module {

    // a paramaterised value set when the module is included
    def buttonValue

    // the content DSL
    static content = {

        // name the search input control “field”, defining it with the jQuery like navigator
        field { $(&quot;input&quot;, name: &quot;q&quot;) }

        // the search button declares that it takes us to the results page, and uses the 
        // parameterised buttonValue to define itself
        button(to: GoogleResultsPage) { 
            $(&quot;input&quot;, value: buttonValue)
        }
    }
}

class GoogleHomePage extends Page {

    // pages can define their location, either absolutely or relative to a base
    static url = &quot;http://google.com/ncr&quot;

    // “at checkers” allow verifying that the browser is at the expected page
    static at = { title == &quot;Google&quot; }

    static content = {
        // include the previously defined module
        search { module GoogleSearchModule, buttonValue: &quot;Google Search&quot; }
    }
}

class GoogleResultsPage extends Page {
    static at = { title.endsWith &quot;Google Search&quot; }
    static content = {
        // reuse our previously defined module
        search { module GoogleSearchModule, buttonValue: &quot;Search&quot; }

        // content definitions can compose and build from other definitions
        results { $(&quot;li.g&quot;) }
        result { i -&gt; results[i] }
        resultLink { i -&gt; result(i).find(&quot;a.l&quot;) }
        firstResultLink { resultLink(0) }
    }
}

class WikipediaPage extends Page {
    static at = { title == &quot;Wikipedia&quot; }
}
</code></pre><p>Now our script again, using the above defined content…</p>
<pre><code>Browser.drive {
    to GoogleHomePage
    assert at(GoogleHomePage)
    search.field.value(&quot;wikipedia&quot;)
    waitFor { at GoogleResultsPage }
    assert firstResultLink.text() == &quot;Wikipedia&quot;
    firstResultLink.click()
    waitFor { at WikipediaPage }
}
</code></pre><h3><span id='testing'>1.4.3</span> Testing</h3><p>Geb itself does not include any kind of testing or execution framework. Rather, it works with existing popular tools like <a href="http://spockframework.org/">Spock</a>, <a href="http://www.junit.org/">JUnit</a>, <a href="http://testng.org/">TestNG</a>, <a href="https://github.com/cucumber/cuke4duke/wiki">Cucumber</a> and <a href="http://www.easyb.org/">EasyB</a>. While Geb works well with all of these test tools, we encourage the use of <a href="http://spockframework.org/">Spock</a> as it&rsquo;s a great match for Geb with its focus and style.</p><p>Here is our Google case again, this time use Geb&rsquo;s <a href="http://spockframework.org/">Spock</a> integration…</p>
<pre><code>import geb.spock.GebSpec

class GoogleWikipediaSpec extends GebSpec {

    def &quot;first result for wikipedia search should be wikipedia&quot;() {
        given:
        to GoogleHomePage

        expect:
        at GoogleHomePage

        when:
        search.field.value(&quot;wikipedia&quot;)

        then:
        waitFor { at GoogleResultsPage }

        and:
        firstResultLink.text() == &quot;Wikipedia&quot;

        when:
        firstResultLink.click()

        then:
        waitFor { at WikipediaPage }
    }
}
</code></pre><p>For more information on using Geb for web and functional testing, see the <a href="testing.html">testing chapter</a>.</p><h2><span id='installation__usage'>1.5</span> Installation &amp; Usage</h2><p>Geb itself is a available as a single <a href="http://mvnrepository.com/artifact/org.gebish/geb-core"><code>geb-core</code> jar from the central Maven repository</a>. To get up and running you simply need this jar, a WebDriver driver implementation and the <code>selenium-support</code> jar.</p><p>Via <code>@Grab</code>…</p>
<pre><code>@Grapes([
    @Grab(&quot;org.gebish:geb-core:0.9.0&quot;),
    @Grab(&quot;org.seleniumhq.selenium:selenium-firefox-driver:2.26.0&quot;),
    @Grab(&quot;org.seleniumhq.selenium:selenium-support:2.26.0&quot;)
])
import geb.Browser
</code></pre><p>Via Maven…</p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.gebish&lt;/groupId&gt;
  &lt;artifactId&gt;geb-core&lt;/artifactId&gt;
  &lt;version&gt;0.9.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
  &lt;artifactId&gt;selenium-firefox-driver&lt;/artifactId&gt;
  &lt;version&gt;2.26.0&lt;/version&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
  &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
  &lt;artifactId&gt;selenium-support&lt;/artifactId&gt;
  &lt;version&gt;2.26.0&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><p>Via Gradle…</p>
<pre><code>compile &quot;org.gebish:geb-core:0.9.0&quot;, &quot;org.seleniumhq.selenium:selenium-firefox-driver:2.26.0&quot;, &quot;org.seleniumhq.selenium:selenium-support:2.26.0&quot;
</code></pre><p>Alternatively, if using an integration such as <code>geb-spock</code> or <code>geb-junit</code> you can depend on that instead of <code>geb-core</code>.</p>
<blockquote><p>Be sure to check the chapter on <a href="build-integrations.html">build integrations</a> for information on using Geb with particular environments<br/>, like <a href="http://grails.org">Grails</a>.</p>
</blockquote>
    </div>
  
    <div class="chapter">
      <h1><span id='the_browser'>2</span> The Browser</h1><p>The entry point to Geb is the <a href="api/geb/Browser.html"><code>Browser</code></a> object.<br/>A browser object marries a <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html"><code>WebDriver</code></a> instance (which drives the actual web browser being automated) with the concept of a “current page”.</p><p>Browser objects are created with a <a href="api/geb/Configuration.html">configuration</a> that specifies which driver implemenation to use, the base url to resolve relative links against and other bits of config. The configuration mechansism allows you to externalise how Geb should operate, which means you can use the same suite of Geb code or tests with different browsers or site instances. The <a href="configuration.html">chapter on configuration</a> contains more details on how to manage the configuration parameters and what they are.</p><p>The default constructor of <a href="api/geb/Browser.html"><code>Browser</code></a> simply loads its settings from the config mechanism.</p>
<pre><code>import geb.Browser

def browser = new Browser()
</code></pre><p>However, if you prefer to specify the driver implementation (or any other settable property on the <a href="api/geb/Browser.html">browser</a>) you can by using Groovy&rsquo;s map constructor syntax.</p>
<pre><code>import geb.Browser
import org.openqa.selenium.firefox.FirefoxDriver

def browser = new Browser(driver: new FirefoxDriver())
</code></pre><p>Which is that same as…</p>
<pre><code>def browser = new Browser()
browser.driver = new FirefoxDriver()
</code></pre><p>Any property set this way will <strong>override</strong> any settings coming from the config mechanism.</p>
<blockquote><p>Note: The behaviour is undefined if a browser&rsquo;s driver is changed after its first use so you should avoid setting the driver this way and prefer the configuration mechanism.</p>
</blockquote><p>For drastically custom configuration requirements, you can create your own <a href="api/geb/Configuration.html">configuration</a> object and construct the browser with it, likely using the <a href="api/geb/ConfigurationLoader.html">configuration loader</a>.</p>
<pre><code>import geb.Browser
import geb.Configuration
import geb.ConfigurationLoader

def loader = new ConfigurationLoader(&quot;a-custom-environment&quot;)
def config = loader.conf
def browser = new Browser(config)
</code></pre><p>Wherever possible, you should strive to use the no-arg constructor and manage Geb through the inbuilt <a href="configuration.html">configuration mechanism</a> as it offers a great deal of flexibility and separates your configuration from your code.</p>
<blockquote><p>Geb integrations typically remove the need to construct a browser object and do this for you, leaving you to just manage the configuration.</p>
</blockquote><h2><span id='the_drive_method'>2.1</span> The drive() method</h2><p>The Browser class features a static method, <a href="api/geb/Browser.html#drive(groovy.lang.Closure)"><code>drive()</code></a>, that makes Geb scripting a little more convenient.</p>
<pre><code>Browser.drive {
    go &quot;signup&quot;
    $(&quot;h1&quot;).text() == &quot;Signup Page&quot;
}
</code></pre><p>Which is equivalent to:</p>
<pre><code>def browser = new Browser()
browser.go &quot;signup&quot;
browser.$(&quot;h1&quot;).text() == &quot;Signup Page&quot;
</code></pre><p>The <code>drive()</code> method takes all of the arguments that the<br/><a href="api/geb/Browser.html"><code>Browser</code></a> constructor takes (i.e. none, a<br/><a href="api/geb/Configuration.html">configuration</a> and/or property overrides) or an existing browser instance, and a<br/>closure. The closure is evaluated against created browser instance (i.e. the browser is made the <em>delegate</em> of the closure). The net result is that all top level method calls and property accesses are implied to be against the browser.</p><p>The <code>drive()</code> method always returns the browser object that was used, so if you need to quit the browser after the drive session you can do something like…</p>
<pre><code>Browser.drive(&quot;http://myapp.com&quot;) {
    …
}.quit()
</code></pre>
<blockquote><p>For more on when/why you need to manually quit the browser, see the section on the <a href="driver.html">driver</a></p>
</blockquote><h2><span id='making_requests'>2.2</span> Making requests</h2><h3><span id='the_base_url'>2.2.1</span> The base URL</h3><p>Browser instances maintain a <a href="api/geb/Browser.html#getBaseUrl()"><code>baseUrl</code></a> property that is used to resolve all non absolute URLs.<br/>This value can come from <a href="configuration.html#base_url">configuration</a> or can be<br/><a href="api/geb/Browser.html#setBaseUrl(java.lang.String)">explicitly set</a> on the browser.</p><p>Care must be taken with slashes when specifying both the base URL and the relative URL as trailing and leading slashes have significant meaning. The following table illustrates the resolution of different types of URLs.</p>
<table class="graybox" border="0" cellspacing="0" cellpadding="5">
    <tr><th>Base</th><th>Navigating To</th><th>Result</th></tr>
    <tr><td>http://myapp.com/</td><td>abc</td><td>http://myapp.com/abc</td></tr>
    <tr><td>http://myapp.com</td><td>abc</td><td>http://myapp.comabc</td></tr>
    <tr><td>http://myapp.com</td><td>/abc</td><td>http://myapp.com/abc</td></tr>
    <tr><td>http://myapp.com/abc/</td><td>def</td><td>http://myapp.com/abc/def</td></tr>
    <tr><td>http://myapp.com/abc</td><td>def</td><td>http://myapp.com/def</td></tr>
    <tr><td>http://myapp.com/abc/</td><td>/def</td><td>http://myapp.com/def</td></tr>
    <tr><td>http://myapp.com/abc/def/</td><td>jkl</td><td>http://myapp.com/abc/def/jkl</td></tr>
    <tr><td>http://myapp.com/abc/def</td><td>jkl</td><td>http://myapp.com/abc/jkl</td></tr>
    <tr><td>http://myapp.com/abc/def</td><td>/jkl</td><td>http://myapp.com/jkl</td></tr>
</table><p>It is usually most desirable to define your base urls with trailing slashes and not to use leading slashes on relative URLs.</p><h3><span id='using_pages'>2.2.2</span> Using pages</h3><p>Page objects (discussed further shortly) can define a url that will be used when explicitly navigating to that page. This is done with the <a href="api/geb/Browser.html#to(java.lang.Class,%20Object[])"><code>to()</code></a> and <a href="api/geb/Browser.html#via(java.lang.Class,%20Object[])"><code>via()</code></a> methods.</p>
<pre><code>class SignupPage extends Page {
    static url = &quot;signup&quot;
}

Browser.drive {
    to SignupPage
    assert $(&quot;h1&quot;).text() == &quot;Signup Page&quot;
    assert page instanceof SignupPage
}
</code></pre><p>The <code>to()</code> and <code>via()</code> method makes a request to the resolved URL and sets the browser&rsquo;s page instance to an instance of the given class. Most Geb scripts and tests start with a <code>to()</code> or <code>via()</code> call.</p>
<blockquote><p>See the section on <a href="page-navigation.html">Advanced Page Navigation</a> for more information on how to use more complicated URL resolution for pages.</p>
</blockquote><h3><span id='direct'>2.2.3</span> Direct</h3><p>You can also make a new request to a URL without setting or changing the page using the <a href="api/geb/Browser.html#go()"><code>go()</code></a> methods. The following examples use a baseUrl of “<code>http://myapp.com/</code>”.</p>
<pre><code>Browser.drive {
    // Go to the Base URL
    go()

    // Go to a URL relative to Base URL
    go &quot;signup&quot;

    // Go to a URL with request params, i.e http://myapp.com/signup?param1=value1&amp;param2=value2
    go &quot;signup&quot;, param1: &quot;value1&quot;, param2: &quot;value2&quot;
}
</code></pre><h2><span id='the_page'>2.3</span> The Page</h2><p>Browser instances hold a reference to a <em>page</em>. This page instance is retrievable via the <a href="api/geb/Browser.html#getPage()"><code>page</code></a> property. Initially, all browser instances have a page of type <a href="api/geb/Page.html"><code>Page</code></a> which provides the basic navigation functions and is the super class for all page objects.</p><p>However, the page property is rarely accessed directly. The browser object will <em>forward</em> any method calls or property read/writes that it can&rsquo;t handle to the current page instance. </p>
<pre><code>Browser.drive {
    go &quot;signup&quot;

    // The following two lines are equivalent
    assert $(&quot;h1&quot;).text() == &quot;Signup Page&quot;
    assert page.$(&quot;h1&quot;).text() == &quot;Signup Page&quot;
}
</code></pre><p>The <em>page</em> is providing the $() function, not the browser. This forwarding facilitates very concise code, void of unnecessary noise.</p>
<blockquote><p>for more information on the $() function which is used to interact with page content, see the section on the <a href="navigator.html">Navigator API</a>.</p>
</blockquote><p>When using the Page Object pattern, you create subclasses of <a href="api/geb/Page.html"><code>Page</code></a> that define content via a powerful DSL that allows you to refer to content by meaningful names instead of tag names or CSS expressions.</p>
<pre><code>class SignupPage extends Page {
    static url = &quot;signup&quot;
    static content = {
        heading { $(&quot;h1&quot;).text() }
    }
}

Browser.drive {
    to SignupPage
    assert heading == &quot;Signup Page&quot;
}
</code></pre><p>Page objects are discussed in depth in the <a href="pages.html">pages</a> chapter, which also explores the Content DSL.</p><h3><span id='changing_the_page'>2.3.1</span> Changing the page</h3><p>We have already seen that that <code>to()</code> methods change the browser&rsquo;s page instance. It is also possible to change the page instance without initiating a new request with the <code>page()</code> methods.</p><p>The <a href="api/geb/Browser.html#page(java.lang.Class)"><code>page(Class pageType)</code></a> method allows you to change the page to a new instance of the given class. The class must be <a href="api/geb/Page.html">Page</a> or a subclass thereof. This method <strong>does not</strong> verify that the given page actually matches the content (at checking is discussed shortly).</p><p>The <a href="api/geb/Browser.html#page(java.lang.Class[])"><code>page(Class[] potentialPageTypes)</code></a> method allows you to specify a number of <em>potential</em> page types. Each of the potential pages is instantiated and checked to see if it matches the content the browser is actually currently at by running each pages at checker.</p><p>These methods are not typically used explicitly but are used by the <code>to()</code> method and content definitions that specify the page that the content navigates to when clicked (see the section on the <a href="pages.html#to"><code>to</code> attribute of the Content DSL</a> for more information about this). However, should you need to manually change the page type they are there.</p><h2><span id='at_checking'>2.4</span> At checking</h2><p>Pages define an <a href="pages.html#at_verification">“at checker”</a> that the browser uses for checking if it is pointing at a given page.</p>
<pre><code>class SignupPage extends Page {
    static at = {
        $(&quot;h1&quot;).text() == &quot;Signup Page&quot;
    }
}

Browser.drive {
    to SignupPage
}
</code></pre>
<blockquote><p>Not using explicit <code>return</code> statements in “at” checkers is preffered. Geb transforms all “at” checkers so that each statement in them is asserted (just like for <code>then:</code> blocks in Spock specifications). Thanks to that you can immediately see evaluated values of your “at” checker if it fails. See the <a href="pages.html#at_verification">“at checker”</a> section for more details.</p>
</blockquote><p>The <code>to()</code> method that takes a single page type <strong>verifies</strong> that the the browser ends up at the given type. If the request may initiate a redirect and take the browser to a different page you should use <code>via()</code> method:</p>
<pre><code>Browser.drive {
    via SecurePage
    at AccessDeniedPage
}
</code></pre><p>Browser objects have an <a href="api/geb/Browser.html#at(java.lang.Class)"><code>at(Class pageType)</code></a> method that tests whether or not the browser is currently at the type of page modeled by the given page object type.</p><p>The <code>at AccessDeniedPage</code> method call will either return a page instance or throw an <code>AssertionError</code> even if there are no explicit assertions in the “at” checker if the checker doesn&rsquo;t pass.</p><p>It&rsquo;s a good idea to always use <code>to()</code> method or use <code>via()</code> together an <code>at()</code> check whenever the page changes in order to <em>fail fast</em>. Otherwise, subsequent steps may fail in harder to diagnose ways due to the content not matching what is expected and content lookups having strange results.</p><p>Pages can also define content that declares what the browser&rsquo;s page type should change to when that content is clicked. After clicking on such content page is automatically at verified (see the DSL reference for the <a href="pages.html#to"><code>to</code></a> parameter).</p>
<pre><code>class LoginPage extends Page {
    static content = {
        loginButton(to: AdminPage) { $(&quot;input&quot;, type: &quot;submit&quot;, name: &quot;login&quot;) }
    }
}

class AdminPage extends Page {
    static at = {
        assert $(&quot;h1&quot;).text() == &quot;Admin Page&quot;
    }
}

Browser.drive {
    to LoginPage
    loginButton.click()
    at AdminPage
}
</code></pre><p>The <code>at()</code> method will also update the browser&rsquo;s page instance to the given page type if its at checker is successful.</p><h2><span id='page_change_listening'>2.5</span> Page change listening</h2><p>It is possible to be notified when a browser&rsquo;s page <em>instance</em> changes (note that this is not necessarily when the browser makes a request to a new URL) using the <a href="api/geb/PageChangeListener.html"><code>PageChangeListener</code></a> interface.</p>
<pre><code>import geb.PageChangeListener

class EchoingPageChangeListener implements PageChangeListener {
    void pageWillChange(Browser browser, Page oldPage, Page newPage) {
        println &quot;browser &#39;$browser&#39; changing page from &#39;$oldPage&#39; to &#39;$newPage&#39;&quot;
    }
}

def browser = new Browser()
def listener = new EchoingPageChangeListener()

browser.registerPageChangeListener(listener)
</code></pre><p>As soon as a listener is registered, its <code>pageWillChange()</code> method will be called with <code>newPage</code> as the current page and <code>oldPage</code> as <code>null</code>. Subsequently, each time the page changes <code>oldPage</code> will be the page that the browser currently has, and <code>newPage</code> will be the page that will soon be the browser&rsquo;s page.</p><p>You can remove remove a listener at any time…</p>
<pre><code>browser.removePageChangeListener(listener)
</code></pre><p>The <a href="api/geb/Browser.html#removePageChangeListener(geb.PageChangeListener)"><code>removePageChangeListener(PageChangeListener listener)</code></a> returns <code>true</code> if <code>listener</code> was registered and has now been removed, otherwise it returns <code>false</code>.</p><p>Listeners cannot be registered twice. If an attempt is made to register a listener that is already registered (i.e. there is another listener that is <em>equal</em> to the listener trying to register, based on their <code>equals()</code> implementation) then a <a href="api/geb/error/PageChangeListenerAlreadyRegisteredException.html"><code>PageChangeListenerAlreadyRegisteredException</code></a> will be raised.</p><h2><span id='working_with_multiple_tabs_and_windows'>2.6</span> Working with multiple tabs and windows</h2><p>When you&rsquo;re working with an application that opens new windows or tabs, for example when clicking on a link with a target attribute set, you can use <code>withWindow()</code> and <code>withNewWindow()</code> methods to execute code in the context of other windows.</p><p>If you really need to know the name of the current window or all the names of open windows use <a href="api/geb/Browser.html#getCurrentWindow()"><code>getCurrentWindow()</code></a> and <a href="api/geb/Browser.html#getAvailableWindows()"><code>getAvailableWindows()</code></a> methods but <code>withWindow()</code> and <code>withNewWindow()</code> are the preferred methods when it comes to dealing with multiple windows.</p><h3><span id='switching_context_to_already_opened_windows'>2.6.1</span> Switching context to already opened windows</h3><p>If you know the name of the window in which context you want to execute the code you can use <a href="api/geb/Browser.html#withWindow(java.lang.String,%20groovy.lang.Closure)"><code>withWindow(String windowName, Closure block)</code></a>. Given this html:</p>
<pre><code>&lt;a href=&quot;http://www.gebish.org&quot; target=&quot;myWindow&quot;&gt;Geb&lt;/a&gt;
</code></pre><p>This code passes:</p>
<pre><code>$(&#39;a&#39;).click()
withWindow(&#39;myWindow&#39;) {
    assert $(&#39;title&#39;).text() == &#39;Geb - Very Groovy Browser Automation&#39;
}
</code></pre><p>If you don&rsquo;t know the name of the window but you know something about the content of the window you can use the <a href="api/geb/Browser.html#withWindow(groovy.lang.Closure,%20groovy.lang.Closure)"><code>withWindow(Closure specification, Closure block)</code></a> method. The first closure passed should return true for the window, or windows, you want to use as context. Note that if there is no window for which the window specification closure returns true then <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/NoSuchWindowException.html"><code>NoSuchWindowException</code></a> is thrown. So given:</p>
<pre><code>&lt;a href=&quot;http://www.gebish.org&quot; target=&quot;_blank&quot;&gt;Geb&lt;/a&gt;
</code></pre><p>This code passes:</p>
<pre><code>$(&#39;a&#39;).click()
withWindow({ $(&#39;title&#39;).text() == &#39;Geb - Very Groovy Browser Automation&#39; }) {
    assert $(&#39;#slogan&#39;).text() == &#39;very groovy browser automation… web testing, screen scraping and more&#39;
}
</code></pre><h3><span id='switching_context_to_newly_opened_windows'>2.6.2</span> Switching context to newly opened windows</h3><p>If you wish to execute code in a window that is newly opened by some of your actions use the <a href="api/geb/Browser.html#withNewWindow(groovy.lang.Closure,%20groovy.lang.Closure)"><code>withNewWindow(Closure windowOpeningBlock, Closure block)</code></a> method. Given html as above the following will pass:</p>
<pre><code>withNewWindow({ $(&#39;a&#39;).click() }) {
    assert $(&#39;title&#39;).text() == &#39;Geb - Very Groovy Browser Automation&#39;
}
</code></pre><p>Note that if the first parameter opens none or more than one window then <a href="api/geb/error/NoNewWindowException.html"><code>NoNewWindowException</code></a> is thrown.</p><h4><span id='passing_options_when_working_with_newly_opened_windows'>2.6.2.1</span> Passing options when working with newly opened windows</h4><p>There are several options that can be passed to a <a href="api/geb/Browser.html#withNewWindow(java.util.Map,%20groovy.lang.Closure,%20groovy.lang.Closure)"><code>withNewWindow()</code></a> call which make working with newly opened windows even simpler. The general syntax is:</p>
<pre><code>withNewWindow({ «window opening action» }, «option name»: «option value», ...) { «action executed within the context of the window» }
</code></pre><h5><span id='close'>2.6.2.1.1</span> close</h5><p>Default value: <code>true</code></p><p>If you pass any truly value as <code>close</code> option then the newly opened window will be closed after the execution of the closure passed as the last argument to the <code>withNewWindow()</code> call.</p><h5><span id='page'>2.6.2.1.2</span> page</h5><p>Default value: <code>null</code></p><p>If you pass a class that extends <code>Page</code> as <code>page</code> option then browser&rsquo;s page will be set to that value before executing the closure passed as the last argument and will be reverted to it&rsquo;s original value afterwards.</p><h5><span id='wait'>2.6.2.1.3</span> wait</h5><p>Default value: <code>null</code></p><p>You can specify <code>wait</code> option if the action defined in the window opening closure passed as the first argument is asynchronous and you need to wait for the new window to be opened. The possible values for the <code>wait</code> option are consistent with the ones for content definition and can be one of the following:</p>
<ul>
  <li><strong><code>true</code></strong> - wait for the content using the <em>default wait</em> configuration</li>
  <li><strong>a string</strong> - wait for the content using the <em>wait preset</em> with this name from the configuration</li>
  <li><strong>a number</strong> - wait for the content for this many seconds, using the <em>default retry interval</em> from the configuration</li>
  <li><strong>a 2 element list of numbers</strong> - wait for the content using element 0 as the timeout seconds value, and element 1 as the retry interval seconds value</li>
</ul><p>Given the following html:</p>
<pre><code>&lt;a href=&quot;http://www.gebish.org&quot; target=&quot;_blank&quot; id=&quot;new-window-link&quot;&gt;Geb&lt;/a&gt;
</code></pre><p>the following will pass:</p>
<pre><code>withNewWindow({
    js.exec &quot;&quot;&quot;
         setTimeout(function() {
          document.getElementById(&#39;new-window-link&#39;).click();
         }, 200);
       &quot;&quot;&quot;
}, wait: true) {
    assert $(&#39;title&#39;).text() == &#39;Geb - Very Groovy Browser Automation&#39;
}
</code></pre><h2><span id='quitting_the_browser'>2.7</span> Quitting the browser</h2><p>The browser object has <a href="api/geb/Browser.html#quit()"><code>quit()</code></a><br/>and <a href="api/geb/Browser.html#close()"><code>close()</code></a> methods (that simply delegate to the underlying driver). See the section on <a href="driver.html">driver management</a> for more information on when and why you need to quit the browser.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='the_webdriver_implementation'>3</span> The WebDriver Implementation</h1><p>A <code>geb.Browser</code> instance interacts with an actual browser via an instance of <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html">WebDriver</a>. The browser&rsquo;s driver can always be retrieved via the <code>WebDriver getDriver()</code> method.</p>
<blockquote><p>One of the key design principles that WebDriver embraces is that tests/scripts should be written to the <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html">WebDriver API</a> making them agnostic to the actual browser being driven, and therefore portable. Geb always supports this goal. However, the reality is that there are still quirks and behavioural differences between driver implementations. Each release of WebDriver has historically worked to minimise these issues so expect the situation to improve over time as WebDriver matures.</p>
</blockquote><h2><span id='explicit_driver_management'>3.1</span> Explicit Driver Management</h2><p>One option for specifying the driver implementation is to construct the driver instance and pass it to the <code>geb.Browser</code> to be used <a href="browser.html">when it is constructed</a>.</p><p>However, where possible prefer implicit driver management which is discussed later in this chapter.</p><h3><span id='explicit_lifecycle'>3.1.1</span> Explicit Lifecycle</h3><p>When the driver is constructed by the user, the user is responsible for quitting the driver at the appropriate time. This can be done via the methods on the webdriver instance (obtainable via <code>geb.Browser#getDriver()</code>) or by calling the <a href="browser.html#quitting_the_browser">delegating methods on the browser object</a>.</p><h2><span id='implicit_driver_management'>3.2</span> Implicit Driver Management</h2><p>If a driver is not given when a <code>Browser</code> object is constructed, one will be created and managed implicitly by Geb by the the <a href="configuration.html#driver_implementation">configuration mechanism</a>.</p><h3><span id='implicit_lifecycle'>3.2.1</span> Implicit Lifecycle</h3><p>By default, Geb internally caches and reuses the first driver created, meaning that all subsequent browser instances created without an explicit driver will reuse the cached driver. This avoids the overhead of creating a new driver each time which can be significant when working with a real browser.</p><p>This means that you may need to call the <code>clearCookies()</code> method on the browser in order to not get strange results due to cookies from previous executions.</p>
<blockquote><p>Note that some of the integrations (e.g. Spock, JUnit) automatically clear the browser cookies at appropriate times such as after each test. Consult the section on <a href="testing.html#cookie_management">testing</a> for specifics.</p>
</blockquote><p>The shared driver will be closed and quitted when the JVM shuts down.</p><p>A new driver can be forced at anytime by calling either of the following <code>static</code> methods on the <code>CachingDriverFactory</code> class…</p>
<pre><code>import geb.driver.CachingDriverFactory

def cachedDriver = CachingDriverFactory.clearCache()
def cachedDriver = CachingDriverFactory.clearCacheAndQuitDriver()
</code></pre><p>After calling either of this methods, the next request for a default driver will result in a new driver instance being created.</p><p>This caching behavior is <a href="configuration.html#driver_caching">configurable</a>. </p><h2><span id='driver_quirks'>3.3</span> Driver Quirks</h2><p>This section details various quirks or issues that have been encountered with different driver implementations.</p><h3><span id='htmlunitdriver'>3.3.1</span> HTMLUnitDriver</h3><h4><span id='dealing_with_pages_that_use_html_refreshes'>3.3.1.1</span> Dealing with pages that use HTML refreshes</h4><p>The default behaviour of the HTMLUnit driver is to immediately refresh the page as soon as it encounters a <code>&lt;meta http-equiv=&quot;refresh&quot; content=&quot;5&quot;&gt;</code> regardless of the specified time. The solution is to use a refresh handler that handles the refresh asynchronously.</p>
<pre><code>import com.gargoylesoftware.htmlunit.ThreadedRefreshHandler

Browser.drive {
  driver.webClient.refreshHandler = new ThreadedRefreshHandler()
  …
}
</code></pre><p>See <a href="http://markmail.org/thread/bu3g56oxz2uqzq43" title="[geb-user] Meta Refresh on a page causes infinite loop - Bob Brown - org.codehaus.geb.user - MarkMail">this mailing list thread</a> for details.</p><h4><span id='configuring_logging'>3.3.1.2</span> Configuring logging</h4><p>HTMLUnit can be very noisy, and it&rsquo;s not clear how to make it not so noisy.</p><p>See <a href="http://jira.codehaus.org/browse/GEB-98">this issue</a> for some tips on how to tune its logging.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='interacting_with_content'>4</span> Interacting with content</h1><p>Geb provides a concise and Groovy interface to the content and controls in your browser. This is implemented through the <code>Navigator</code> API which is a jQuery inspired mechanism for finding, filtering and interacting with DOM elements.</p><h2><span id='the__function'>4.1</span> The $ Function</h2><p>The $ function is the access point to the browser&rsquo;s page content. This returns a <code>geb.navigator.Navigator</code> object that is roughly analogous to a jQuery object. It is analogous in that it represents one or more elements on the page and can be used to refine the matched content or query the matched content. When a $ function is called that does not match any content, an “empty” navigator object is returned that represents no content. Operations on “empty” navigators return <code>null</code> or another “empty” navigator or other values that make sense (e.g. the <code>size()</code> method returns <code>0</code>).</p><p>The signature of the $ function is as follows…</p>
<pre><code>$(«css selector», «index or range», «attribute / text matchers»)
</code></pre><p>The following is a concrete example…</p>
<pre><code>$(&quot;h1&quot;, 2, class: &quot;heading&quot;)
</code></pre><p>This would find the 3rd (elements are 0 indexed) <code>h1</code> element whose <code>class</code> <em>attribute</em> is exactly “<code>heading</code>”.</p><p>All arguments are optional, meaning the following calls are all valid:</p>
<pre><code>$(&quot;div p&quot;, 0)
$(&quot;div p&quot;, title: &quot;something&quot;)
$(0)
$(title: &quot;something&quot;)
</code></pre>
<blockquote><p>There is an alias for the dollar function named “find” if a method named “$” is not to your test (a current limitation of Groovy prevents us supporting a <code>find()</code> method like <code>$()</code> though, this will be fixed in later versions).</p>
</blockquote><h3><span id='css_selectors'>4.1.1</span> CSS Selectors</h3><p>You can use any CSS selector that the underlying <code>WebDriver</code> supports…</p>
<pre><code>$(&quot;div.some-class p:first[title=&#39;something&#39;]&quot;)
</code></pre><p>In the case of the HTMLUnit driver, which does not support CSS selectors at all, only basic CSS 2 type selectors can be used. A future version of the HTMLUnit driver may gain better CSS selector support.</p><h3><span id='indexes_and_ranges'>4.1.2</span> Indexes and Ranges</h3><p>When matching, a single positive integer or integer range can be given to restrict by index.</p><p>Consider the following html…</p>
<pre><code>&lt;p&gt;a&lt;/p&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;p&gt;c&lt;/p&gt;
</code></pre><p>We can use indexes to match content like so…</p>
<pre><code>$(&quot;p&quot;, 0).text() == &quot;a&quot;
$(&quot;p&quot;, 2).text() == &quot;c&quot;
$(&quot;p&quot;, 0..1)*.text() = [&quot;a&quot;, &quot;b&quot;]
$(&quot;p&quot;, 1..2)*.text() = [&quot;b&quot;, &quot;c&quot;]
</code></pre><p>See below for an explanation of the <code>text()</code> method and the use of the spread operator.</p><h3><span id='attribute_and_text_matching'>4.1.3</span> Attribute and Text Matching</h3><p>Matches can be made on attributes and node text values via Groovy&rsquo;s named parameter syntax. The value <code>text</code> is treated specially as a match against the node&rsquo;s text. All other values are matched against their corresponding attribute values.</p><p>Consider the following html…</p>
<pre><code>&lt;p attr1=&quot;a&quot; attr2=&quot;b&quot;&gt;p1&lt;/p&gt;
&lt;p attr1=&quot;a&quot; attr2=&quot;c&quot;&gt;p2&lt;/p&gt;
</code></pre><p>We can use attribute matchers like so…</p>
<pre><code>$(&quot;p&quot;, attr1: &quot;a&quot;).size() == 2
$(&quot;p&quot;, attr2: &quot;c&quot;).size() == 1
</code></pre><p>Attribute values are <code>and</code>ed together…</p>
<pre><code>$(&quot;p&quot;, attr1: &quot;a&quot;, attr2: &quot;b&quot;).size() == 1
</code></pre><p>We can use text matchers like so…</p>
<pre><code>$(&quot;p&quot;, text: &quot;p1&quot;).size() == 1
</code></pre><p>You can mix attribute and text matchers…</p>
<pre><code>$(&quot;p&quot;, text: &quot;p1&quot;, attr1: &quot;a&quot;).size() == 1
</code></pre><h4><span id='using_patterns'>4.1.3.1</span> Using Patterns</h4><p>To match the entire value of an attribute or the text you use a <code>String</code> value. It is also possible to use a <code>Pattern</code> to do regexp matching…</p>
<pre><code>$(&quot;p&quot;, text: ~/p./).size() == 2
</code></pre><p>Geb also ships with a bunch of shortcut pattern methods…</p>
<pre><code>$(&quot;p&quot;, text: startsWith(&quot;p&quot;)).size() == 2
$(&quot;p&quot;, text: endsWith(&quot;2&quot;)).size() == 1
</code></pre><p>The following is the complete listing:</p>
<table class="graybox" border="0" cellspacing="0" cellpadding="5">
    <tr><th>Case Sensitive</th><th>Case Insensitive</th><th>Description</th></tr>
    <tr><td><code>startsWith</code></td><td><code>iStartsWith</code></td><td>Matches values that start with the given value</td>
    <tr><td><code>contains</code></td><td><code>iContains</code></td><td>Matches values that contain the given value anywhere</td>
    <tr><td><code>endsWith</code></td><td><code>iEndsWith</code></td><td>Matches values that end with the given value</td>
    <tr><td><code>containsWord</code></td><td><code>iContainsWord</code></td><td>Matches values that contain the given value surrounded by either whitespace or the beginning or end of the value</td>
    <tr><td><code>notStartsWith</code></td><td><code>iNotStartsWith</code></td><td>Matches values that DO NOT start with the given value</td>
    <tr><td><code>notContains</code></td><td><code>iNotContains</code></td><td>Matches values that DO NOT contain the given value anywhere</td>
    <tr><td><code>notEndsWith</code></td><td><code>iNotEndsWith</code></td><td>Matches values that DO NOT end with the given value</td>
    <tr><td><code>notContainsWord</code></td><td><code>iNotContainsWord</code></td><td>Matches values that DO NOT contain the given value surrounded by either whitespace or the beginning or end of the value</td>
        
</table><p>All of these methods themselves can take a <code>String</code> or a <code>Pattern</code>…</p>
<pre><code>$(&quot;p&quot;, text: contains(~/\d/)).size() == 2
</code></pre>
<blockquote><p>You might be wondering how this magic works, i.e. where these methods come from and where they can be used. They are methods that are available on <code>geb.Page</code> and other <em>places</em> where you can use the $ function. They simply just return patterns.</p>
</blockquote><h3><span id='navigators_are_iterable'>4.1.4</span> Navigators are Iterable</h3><p>The navigator objects implement the Java <code>Iterable</code> interface, which allows you to do lots of Groovy stuff like use the <code>max()</code> function…</p>
<pre><code>&lt;p&gt;1&lt;/p&gt;
&lt;p&gt;2&lt;/p&gt;

$(&quot;p&quot;).max { it.text() }.text() == &quot;2&quot;
</code></pre><p>This also means that navigator objects work with the Groovy spread operator…</p>
<pre><code>$(&quot;p&quot;)*.text().max() == &quot;2&quot;
</code></pre><p>When treating a navigator as <code>Iterable</code>, the iterated over content is always the exact matched elements (as opposed to including children).</p><h2><span id='finding__filtering'>4.2</span> Finding &amp; Filtering</h2><p>Navigator objects have a <code>find</code> method for finding descendants, and <code>filter</code> and <code>not</code> methods for reducing the matched content.</p><p>Consider the following html…</p>
<pre><code>&lt;div class=&quot;a&quot;&gt;
    &lt;p class=&quot;b&quot;&gt;geb&lt;/p&gt;
&lt;/div&gt;
&lt;div class=&quot;b&quot;&gt;goodness&lt;/div&gt;
</code></pre><p>We can select <code>p.b</code> by…</p>
<pre><code>$(&quot;div&quot;).find(&quot;.b&quot;)
</code></pre><p>We can select <code>div.b</code> by…</p>
<pre><code>$(&quot;div&quot;).filter(&quot;.b&quot;)
</code></pre><p>or…</p>
<pre><code>$(&quot;.b&quot;).not(&quot;p&quot;)
</code></pre><p>We can select the <code>div</code> containing the <code>p</code> with…</p>
<pre><code>$(&quot;div&quot;).has(&quot;p&quot;)
</code></pre><p>The <code>find</code> and <code>filter</code> methods support the <strong>exact same options as the $ function</strong>.</p><p>These methods return a new navigator object that represents the new content.</p><h2><span id='traversing'>4.3</span> Traversing</h2><p>Navigators also have methods for selecting content <em>around</em> the matched content.</p><p>Consider the following html…</p>
<pre><code>&lt;div class=&quot;a&quot;&gt;
    &lt;div class=&quot;b&quot;&gt;
        &lt;p class=&quot;c&quot;&gt;&lt;/p&gt;
        &lt;p class=&quot;d&quot;&gt;&lt;/p&gt;
        &lt;p class=&quot;e&quot;&gt;&lt;/p&gt;
    &lt;/div&gt;
    &lt;div class=&quot;f&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
</code></pre><p>You can select content <em>around</em> <code>p.d</code> by…</p>
<pre><code>$(&quot;p.d&quot;).previous() // &#39;p.c&#39;
$(&quot;p.e&quot;).prevAll() // &#39;p.c&#39; &amp; &#39;p.d&#39;
$(&quot;p.d&quot;).next() // &#39;p.e&#39;
$(&quot;p.c&quot;).nextAll() // &#39;p.d&#39; &amp; &#39;p.e&#39;
$(&quot;p.d&quot;).parent() // &#39;div.b&#39;
$(&quot;p.c&quot;).siblings() // &#39;p.d&#39; &amp; &#39;p.e&#39;
$(&quot;div.a&quot;).children() // &#39;div.b&#39; &amp; &#39;div.f&#39;
</code></pre><p>Consider the following html…</p>
<pre><code>&lt;p class=&quot;a&quot;&gt;&lt;/p&gt;
&lt;p class=&quot;b&quot;&gt;&lt;/p&gt;
&lt;p class=&quot;c&quot;&gt;&lt;/p&gt;
</code></pre><p>The following code will select <code>p.b</code> &amp; <code>p.c</code>…</p>
<pre><code>$(&quot;p&quot;).next()
</code></pre><p>The <code>previous</code>, <code>prevAll</code>, <code>next</code>, <code>nextAll</code>, <code>parent</code>, <code>parents</code>, <code>closest</code>, <code>siblings</code> and <code>children</code> methods can also take css selectors and attribute matchers.</p><p>Using the same html, the following code will select <code>p.c</code>…</p>
<pre><code>$(&quot;p&quot;).next(&quot;.c&quot;)
</code></pre><p>Likewise, consider the following html…</p>
<pre><code>&lt;div class=&quot;a&quot;&gt;
    &lt;div class=&quot;b&quot;&gt;
        &lt;p&gt;&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre><p>The following code will select <code>div.b</code>…</p>
<pre><code>$(&quot;p&quot;).parent(&quot;.b&quot;)
</code></pre><p>The <code>closest</code> method is a special case in that it will select the first ancestors of the current elements that match a selector. There is no no-argument version of the <code>closest</code> method. For example, this will select <code>div.a</code>…</p>
<pre><code>$(&quot;p&quot;).closest(&quot;.a&quot;)
</code></pre><p>These methods do not take indexes as they automatically select the first matching content. To select multiple elements you can use <code>prevAll</code>, <code>nextAll</code> and <code>parents</code> all of which have no-argument versions and versions that filter by a selector.</p><p>The <code>nextUntil</code>, <code>prevUntil</code> and <code>parentsUntil</code> methods return all nodes along the relevant axis <em>until</em> the first one that matches a selector. Consider the following markup:</p>
<pre><code>&lt;div class=&quot;a&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;b&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;c&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;d&quot;&gt;&lt;/div&gt;
</code></pre><p>The following code will select <code>div.b</code> and <code>div.c</code>:</p>
<pre><code>$(&quot;.a&quot;).nextUntil(&quot;.d&quot;)
</code></pre><h2><span id='composition'>4.4</span> Composition</h2><p>It is also to compose navigator objects from other navigator objects, for situations where you can&rsquo;t express a content set in one query. To do this, simply call the $ function with the navigators to use…</p>
<pre><code>$($(&quot;div.a&quot;), $(&quot;div.d&quot;))
</code></pre><p>This will return a new navigator object that represents only the <code>a</code> and <code>d</code> divs.</p><p>You can compose navigator objects from content. So given a page content definition:</p>
<pre><code>static content = {
    divElement { divClass -&gt; $(&#39;p&#39;, &#39;class&#39;: divClass) }
}
</code></pre><p>And a call:</p>
<pre><code>$(divElement(&#39;a&#39;), divElement(&#39;d&#39;))
</code></pre><p>You will get a navigator that contains the same elements as the one above.</p><h2><span id='clicking'>4.5</span> Clicking</h2><p>Navigator objects implement the <code>click()</code> method, which will instruct the browser to click <strong>only the first item</strong> the navigator has matched.</p><p>There are also <code>click(Class)</code> and <code>click(List&lt;Class&gt;)</code> methods that are analogous to the browser object&rsquo;s <a href="browser.html#changing_the_page"><code>page(Class)</code> and <code>page(List&lt;Class&gt;)</code> methods respectively</a>. This allow page changes to be specified at the same time as click actions.</p><p>For example…</p>
<pre><code>$(&quot;input.loginButton&quot;).click(LoginPage)
</code></pre><p>Would click the “<code>input.loginButton</code>” element, then effectively call <code>browser.page(LoginPage)</code> and verify that the browser is at the expected page.</p><h2><span id='determining_visibility'>4.6</span> Determining Visibility</h2><p>Navigator objects have a <code>displayed</code> property that indicates whether the element is visible to the user or not. The <code>displayed</code> property of a navigator object that doesn&rsquo;t match anything is always <code>false</code></p><h2><span id='size_and_location'>4.7</span> Size and Location</h2><p>You can obtain the size and location of content on the page. All units are in pixels. The size is available via the <code>height</code> and <code>width</code> properties, while the location is available as the <code>x</code> and <code>y</code> properties which represent the distance from the top left of the page (or parent frame) to the top left point of the content.</p><p>All of these properties operate on the <strong>first</strong> matched element only.</p>
<pre><code>$(&quot;div&quot;).height == 20
$(&quot;div&quot;).width == 40
$(&quot;div&quot;).x == 60
$(&quot;div&quot;).y == 80
</code></pre><p>To obtain any of the properties for all matched elements, you can use the Groovy spread operator.</p>
<pre><code>$(&quot;div&quot;)*.height == [20, 30]
$(&quot;div&quot;)*.width == [40, 50]
$(&quot;div&quot;)*.x == [60, 70]
$(&quot;div&quot;)*.y == [80, 90]
</code></pre><h2><span id='accessing_tag_name_attributes_text_and_classes'>4.8</span> Accessing tag name, attributes, text and classes</h2><p>The <code>tag()</code>, <code>text()</code>, <code>@attribute</code> and <code>classes()</code> methods return the requested content on the <em>first</em> matched content. The <code>classes()</code> method returns a <code>java.util.List</code> of unique class names sorted alphabetically.</p><p>Consider the following HTML…</p>
<pre><code>&lt;p title=&quot;a&quot; class=&quot;a para&quot;&gt;a&lt;/p&gt;
&lt;p title=&quot;b&quot; class=&quot;b para&quot;&gt;b&lt;/p&gt;
&lt;p title=&quot;c&quot; class=&quot;c para&quot;&gt;c&lt;/p&gt;
</code></pre><p>The following assertions are valid…</p>
<pre><code>$(&quot;p&quot;).text() == &quot;a&quot;
$(&quot;p&quot;).tag() == &quot;p&quot;
$(&quot;p&quot;).@title == &quot;a&quot;
$(&quot;p&quot;).classes() == [&quot;a&quot;, &quot;para&quot;]
</code></pre><p>To obtain information about all matched content, you use the Groovy <em>spread operator</em>…</p>
<pre><code>$(&quot;p&quot;)*.text() == [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
$(&quot;p&quot;)*.tag() == [&quot;p&quot;, &quot;p&quot;, &quot;p&quot;]
$(&quot;p&quot;)*.@title == [&quot;a&quot;, &quot;b&quot;, &quot;c&quot;]
$(&quot;p&quot;)*.classes() == [[&quot;a&quot;, &quot;para&quot;], [&quot;b&quot;, &quot;para&quot;], [&quot;c&quot;, &quot;para&quot;]]
</code></pre><h2><span id='sending_keystrokes'>4.9</span> Sending keystrokes</h2><p>Keystrokes can be sent to any content via the leftShift operator, which is a shortcut for the [<code>sendKeys()</code>](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html#sendKeys(java.lang.CharSequence...\)">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html#sendKeys(java.lang.CharSequence...\)</a>) method of WebDriver.</p>
<pre><code>$(&quot;div&quot;) &lt;&lt; &quot;abc&quot;
</code></pre><p>How content responds to the keystrokes depends on what the content is.</p><h3><span id='non_characters_eg_delete_key'>4.9.1</span> Non characters (e.g. delete key)</h3><p>It is possible to send non textual characters to content by using the WebDriver <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/Keys.html" title="Keys">Keys</a> enumeration…</p>
<pre><code>import org.openqa.selenium.Keys

$(&quot;input&quot;, name: &quot;firstName&quot;) &lt;&lt; Keys.chord(Keys.CONTROL, &quot;c&quot;)
</code></pre><p>Here we are sending a “control-c” to an input.</p><p>See the documentation for <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/Keys.html" title="Keys">Keys</a> for more information on the possible keys.</p><h2><span id='accessing_input_values'>4.10</span> Accessing input values</h2><p>The value of <code>input</code>, <code>select</code> and <code>textarea</code> elements can be retrieved and set with the <code>value</code> method. Calling <code>value()</code> with no arguments will return the String value of <em>the first</em> element in the Navigator. Calling <code>value(value)</code> will set the current value of <em>all</em> elements in the Navigator. The argument can be of any type and will be coerced to a <code>String</code> if necessary. The exceptions are that when setting a <code>checkbox</code> value the method expects a <code>boolean</code> (or, an existing checkbox value) and when setting a multiple <code>select</code> the method expects an array or Collection of values.</p><h2><span id='form_control_shortcuts'>4.11</span> Form Control Shortcuts</h2><p>Interacting with form controls (<code>input</code>, <code>select</code> etc.) is such a common task in web functional testing that Geb provides convenient shortcuts for common functions.</p><p>Geb supports the following shortcuts for dealing with form controls.</p><p>Consider the following HTML…</p>
<pre><code>&lt;form&gt;
    &lt;input type=&quot;text&quot; name=&quot;geb&quot; value=&quot;testing&quot; /&gt;
&lt;/form&gt;
</code></pre><p>The value can be read and written via property notation…</p>
<pre><code>$(&quot;form&quot;).geb == &quot;testing&quot;
$(&quot;form&quot;).geb = &quot;goodness&quot;
$(&quot;form&quot;).geb == &quot;goodness&quot;
</code></pre><p>These are literally shortcuts for…</p>
<pre><code>$(&quot;form&quot;).find(&quot;input&quot;, name: &quot;geb&quot;).value() == &quot;testing&quot;
$(&quot;form&quot;).find(&quot;input&quot;, name: &quot;geb&quot;).value(&quot;goodness&quot;)
$(&quot;form&quot;).find(&quot;input&quot;, name: &quot;geb&quot;).value() == &quot;goodness&quot;
</code></pre><p>There is also a shortcut for obtaining a navigator based on a control name</p>
<pre><code>$(&quot;form&quot;).geb()
</code></pre><p>Which is literally a shortcut for…</p>
<pre><code>$(&quot;form&quot;).find(&quot;input&quot;, name: &quot;geb&quot;)
</code></pre>
<blockquote><p>In the above and below examples with form controls we are using code like <code>$(&quot;form&quot;).someInput</code> where we could be using just <code>someInput</code> as long as there is only one control with the <em>name</em> <code>someInput</code> on the page. In the examples we are using <code>$(&quot;form&quot;).someInput</code> to hopefully be clearer.</p>
</blockquote><p>If your content definition (either a page or a module) describes content which is an <code>input</code>, <code>select</code> or <code>textarea</code> you can access and set its value the same way as described above for forms. Given a page and module definitions for the above mentioned html:</p>
<pre><code>class ShortcutModule extends Module {
    static content = {
       geb { $(&#39;form&#39;).geb() }
    }
}

static content = {
    geb { $(&#39;form&#39;).geb() }
    shortcutModule { module ShortcutModule }
}
</code></pre><p>The following will pass:</p>
<pre><code>assert geb == &quot;testing&quot;
geb = &quot;goodness&quot;
assert geb == &quot;goodness&quot;
</code></pre><p>As well as:</p>
<pre><code>assert shortcutModule.geb == &quot;testing&quot;
shortcutModule.geb = &quot;goodness&quot;
assert shortcutModule.geb == &quot;goodness&quot;
</code></pre>
<blockquote><p>The following examples describe usage of form controls only using code like <code>$(&quot;form&quot;).someInput</code>. Given a content definition <code>myContent { $(&quot;form&quot;).someInput }</code> you can substitute <code>$(&quot;form&quot;).someInput</code> in the examples with <code>myContent</code>.</p>
</blockquote><h3><span id='setting_values'>4.11.1</span> Setting Values</h3><h4><span id='select'>4.11.1.1</span> select</h4><p>Select values are set by assigning the value or text of the required option. Assigned values are automatically coerced to String. For example…</p>
<pre><code>&lt;select name=&quot;artist&quot;&gt;
    &lt;option value=&quot;1&quot;&gt;Ima Robot&lt;/option&gt;
    &lt;option value=&quot;2&quot;&gt;Edward Sharpe and the Magnetic Zeros&lt;/option&gt;
    &lt;option value=&quot;3&quot;&gt;Alexander&lt;/option&gt;
&lt;/select&gt;
</code></pre><p>We can select options with…</p>
<pre><code>$(&quot;form&quot;).artist = &quot;1&quot;         // first option selected by its value attribute
$(&quot;form&quot;).artist = 2           // second option selected by its value attribute
$(&quot;form&quot;).artist = &quot;Ima Robot&quot; // first option selected by its text
</code></pre><p>If you attempt to set a select to a value that does not match the value or text of any options, an <code>IllegalArgumentException</code> will be thrown.</p><h4><span id='multiple_select'>4.11.1.2</span> multiple select</h4><p>If the select has the <code>multiple</code> attribute it is set with a array or <code>Collection</code> of values. Any options not in the values are un-selected. For example…</p>
<pre><code>&lt;select name=&quot;genres&quot; multiple&gt;
    &lt;option value=&quot;1&quot;&gt;Alt folk&lt;/option&gt;
    &lt;option value=&quot;2&quot;&gt;Chiptunes&lt;/option&gt;
    &lt;option value=&quot;3&quot;&gt;Electroclash&lt;/option&gt;
    &lt;option value=&quot;4&quot;&gt;G-Funk&lt;/option&gt;
    &lt;option value=&quot;5&quot;&gt;Hair metal&lt;/option&gt;
&lt;/select&gt;
</code></pre><p>We can select options with…</p>
<pre><code>$(&quot;form&quot;).genres = [&quot;2&quot;, &quot;3&quot;]                 // second and third options selected by their value attributes
$(&quot;form&quot;).genres = [1, 4, 5]                  // first, fourth and fifth options selected by their value attributes
$(&quot;form&quot;).genres = [&quot;Alt folk&quot;, &quot;Hair metal&quot;] // first and last options selected by their text
$(&quot;form&quot;).genres = []                         // all options un-selected
</code></pre><p>If the collection being assigned contains a value that does not match the value or text of any options, an <code>IllegalArgumentException</code> will be thrown.</p><h4><span id='checkbox'>4.11.1.3</span> checkbox</h4><p>Checkboxes are generally checked/unchecked by setting their value to <code>true</code> or <code>false</code>.</p><p>You can also select a checkbox by explicitly setting its <code>value</code>. This is useful when you have a number of checkboxes with the same name, i.e.</p>
<pre><code>&lt;input type=&quot;checkbox&quot; name=&quot;pet&quot; value=&quot;dogs&quot; /&gt;
&lt;input type=&quot;checkbox&quot; name=&quot;pet&quot; value=&quot;cats&quot; /&gt;
</code></pre><p>You can select dogs as your pet type, as follows:</p>
<pre><code>$(&quot;checkbox&quot;, name: &quot;pet&quot;).value(&quot;dogs&quot;)
</code></pre><p>Calling <code>value()</code> on a checked checkbox will return the value of its <code>value</code> attribute, i.e:</p>
<pre><code>&lt;input type=&quot;checkbox&quot; name=&quot;pet&quot; value=&quot;dogs&quot; checked=&quot;checked&quot;/&gt;

assert $(&quot;checkbox&quot;, name: &quot;pet&quot;).value() == &quot;dogs&quot;
</code></pre><p>Calling <code>value()</code> on an unchecked checkbox will return <code>false</code>, i.e:</p>
<pre><code>&lt;input type=&quot;checkbox&quot; name=&quot;pet&quot; value=&quot;dogs&quot;/&gt;

assert $(&quot;checkbox&quot;, name: &quot;pet&quot;).value() == false
</code></pre><p>In general you should use <a href="http://docs.codehaus.org/display/GROOVY/Groovy+Truth">Groovy Truth</a> when checking if a checkbox is checked:</p>
<pre><code>if ($(&quot;checkbox&quot;, name: &quot;pet&quot;).value()) {
    //evaluated only if &quot;pet&quot; checkbox is checked
}
</code></pre><h4><span id='radio'>4.11.1.4</span> radio</h4><p>Radio values are set by assigning the value of the radio button that is to be selected or the label text associated with a radio button.</p><p>For example, with the following radio buttons…</p>
<pre><code>&lt;label for=&quot;site-current&quot;&gt;Search this site&lt;/label&gt;
&lt;input type=&quot;radio&quot; id=&quot;site-current&quot; name=&quot;site&quot; value=&quot;current&quot;&gt;

&lt;label&gt;Search Google
    &lt;input type=&quot;radio&quot; name=&quot;site&quot; value=&quot;google&quot;&gt;
&lt;/label&gt;
</code></pre><p>We can select the radios with…</p>
<pre><code>$(&quot;form&quot;).site = &quot;current&quot;          // selects the first radio by its value
$(&quot;form&quot;).site = &quot;Search this site&quot; // selects the first radio by its label
$(&quot;form&quot;).site = &quot;Search Google&quot;    // selects the second radio by its label
</code></pre><h4><span id='text_inputs_and_textareas'>4.11.1.5</span> text inputs and textareas</h4><p>In the case of a text <code>input</code>, the assigned value becomes the input&rsquo;s <em>value</em> attribute and for a <code>textarea</code> effectively becomes the text.</p><p>It is also possible to append text by using the send keys shorthand…</p>
<pre><code>&lt;input name=&quot;language&quot; value=&quot;gro&quot; /&gt;

$(&quot;form&quot;).language() &lt;&lt; &quot;ovy&quot;
assert $(&quot;form&quot;).language == &quot;groovy&quot;
</code></pre><p>Which an also be used for non character keys…</p>
<pre><code>&lt;input name=&quot;postcode&quot; /&gt;

import org.openqa.selenium.Keys

$(&quot;form&quot;).postcode = &quot;12345&quot;
$(&quot;form&quot;).postcode() &lt;&lt; Keys.BACK_SPACE
assert $(&quot;form&quot;).postcode == &quot;1234&quot;
</code></pre>
<blockquote><p>Note that WebDriver has some issues with textareas and surrounding whitespace. Namely, some drivers implicit trim whitespace from the beginning and end of the value. You can track this issue here: <a href="http://code.google.com/p/selenium/issues/detail?id=2131">http://code.google.com/p/selenium/issues/detail?id=2131</a></p>
</blockquote><h4><span id='file_upload'>4.11.1.6</span> file upload</h4><p>It&rsquo;s currently not possible with WebDriver to simulate the process of a user clicking on a file upload control and choosing a file to upload via the normal file chooser. However, you can directly set the value of the upload control to the <em>absolute path</em> of a file on the system where the driver is running and on form submission that file will be uploaded.</p>
<pre><code>&lt;input type=&quot;file&quot; name=&quot;csvFile&quot;&gt;

$(&quot;form&quot;).csvFile = &quot;/path/to/my/file.csv&quot;
</code></pre><h2><span id='complex_interactions'>4.12</span> Complex Interactions</h2><p>WebDriver supports interactions that are more complex than simply clicking or typing into items, such as dragging. You can use this API from Geb, or use the more Geb friendly <code>interact {}</code> DSL (explained below).</p><h3><span id='using_the_webdriver_api_directly'>4.12.1</span> Using the WebDriver API directly</h3><p>A Geb navigator object is built on top of a collection of WebDriver <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebElement.html">WebElement</a> objects. It is possible to access the contained <code>WebElement</code>s via the following methods on navigator objects:</p>
<pre><code>WebElement firstElement()
WebElement lastElement()
Collection&lt;WebElement&gt; allElements()
</code></pre><p>By using the methods of the WebDriver <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/interactions/Actions.html">Actions</a> class with WebElements, complex user gestures can be emulated.</p><h3><span id='using_actions'>4.12.2</span> Using Actions</h3><p>Create an Actions instance after obtaining the WebDriver driver:</p>
<pre><code>def actions = new Actions(driver)
</code></pre><p>Next, use methods of Actions to compose a series of UI actions, then call build() to create a concrete Action:</p>
<pre><code>import org.openqa.selenium.Keys

WebElement someItem = $(&#39;li.clicky&#39;).firstElement()
def shiftDoubleClickAction = actions.keyDown(Keys.SHIFT).doubleClick(someItem).keyUp(Keys.SHIFT).build()
</code></pre><p>Finally, call perform() to actually trigger the desired mouse or keyboard behavior:</p>
<pre><code>shiftDoubleClickAction.perform()
</code></pre><h3><span id='using_interact_closures'>4.12.3</span> Using Interact Closures</h3><p>To cut down on the amount of typing required, use an interact closure instead of using class <code>Actions</code> explicitly. When using an interact closure, an <code>Actions</code> instance is implicitly created, built into an Action, and performed. As an added bonus, Geb navigators can be passed directly to <code>Actions</code> methods within an interact closure.</p><p>This interact closure performs the same work as the calls in the &lsquo;Using Actions&rsquo; section:</p>
<pre><code>import org.openqa.selenium.Keys

interact {
    keyDown(Keys.SHIFT)
    doubleClick($(&#39;li.clicky&#39;))
    keyUp(Keys.SHIFT)
}
</code></pre><p>This method creates code that is more readable than using <code>Actions</code> directly.</p><p>For the full list of available interactions, see the documentation for the WebDriver <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/interactions/Actions.html">Actions</a> class.</p><h3><span id='interact_examples'>4.12.4</span> Interact Examples</h3><p>Interact closures (or Actions) can be used to perform behaviors that are more complicated than clicking buttons and anchors or typing in input fields. Shift-double-clicking was demonstrated earlier.</p><h4><span id='drag_and_drop'>4.12.4.1</span> Drag and Drop</h4><p>clickAndHold, moveByOffset, and then release will drag and drop an element on the page.</p>
<pre><code>interact {
    clickAndHold($(&#39;#element&#39;))
    moveByOffset(400, -150)
    release()
}
</code></pre><p>Drag-and-dropping can also be accomplished using the <code>dragAndDropBy</code> convenience method from the Actions API:</p>
<pre><code>interact {
    dragAndDropBy($(&#39;#element&#39;), 400, -150)
}
</code></pre><p>In this particular example the element will be clicked then dragged 400 pixels to the right and 150 pixels upward before being released.</p>
<blockquote><p>Note that moving to arbitrary locations with the mouse is currently not supported by the HTMLUnit driver, but moving directly to elements is.</p>
</blockquote><h4><span id='control_clicking'>4.12.4.2</span> Control-Clicking</h4><p>Control-clicking several elements, such as items in a list, is performed the same way as shift-clicking.</p>
<pre><code>import org.openqa.selenium.Keys

interact {
    keyDown(Keys.CONTROL)
    click($(&#39;ul.multiselect li&#39;, text: &#39;Order 1&#39;))
    click($(&#39;ul.multiselect li&#39;, text: &#39;Order 2&#39;))
    click($(&#39;ul.multiselect li&#39;, text: &#39;Order 3&#39;))
    keyUp(Keys.CONTROL)
}
</code></pre>
    </div>
  
    <div class="chapter">
      <h1><span id='pages'>5</span> Pages</h1>
<blockquote><p>Before reading this page, please make sure you have read the <a href="browser.html#the_drive_method">section on the Browser.drive() method</a></p>
</blockquote><h2><span id='the_page_object_pattern'>5.1</span> The Page Object pattern</h2>
<pre><code>import geb.Browser

Browser.drive {
    go &quot;http://google.com/ncr&quot;
    $(&quot;input[name=q]&quot;).value &quot;Chuck Norris&quot;
    $(&quot;input[value=&#39;Google Search&#39;]&quot;).click()
    waitFor { $(&quot;li.g&quot;, 0).find(&quot;a.l&quot;).text().contains(&quot;Chuck&quot;) }
}
</code></pre><p>This is valid Geb code, and it works well for a one off script but there are two big issues with this approach. Imagine that you have <em>many</em> tests that involve searching and checking results. The implementation of how to search and how to find the results is going to have to be duplicated in <em>every</em> test, maybe <em>many times</em> per test. As soon as something as trivial as the name of the search field changes you have to update a lot of code. The Page Object Pattern allows us to apply the same principles of modularity, reuse and encapsulation that we use in other aspects of programming to avoid such issues in browser automation code.</p><p>Here is the same script, utilising page objects…</p>
<pre><code>import geb.*

class GoogleHomePage extends Page {
    static url = &quot;http://google.com/?complete=0&quot;
    static at = { title == &quot;Google&quot; }
    static content = {
        searchField { $(&quot;input[name=q]&quot;) }
        searchButton(to: GoogleResultsPage) { $(&quot;input[value=&#39;Google Search&#39;]&quot;) }
    }
}

class GoogleResultsPage extends Page {
    static at = { waitFor { title.endsWith(&quot;Google Search&quot;) } }
    static content = {
        results(wait: true) { $(&quot;li.g&quot;) }
        result { index -&gt; results[index] }
        resultLink { index -&gt; result(index).find(&quot;a.l&quot;) }
    }
}

// Now the script
Browser.drive {
    to GoogleHomePage
    searchField().value &quot;Chuck Norris&quot;
    searchButton().click()
    at GoogleResultsPage
    resultLink(0).text().contains(&quot;Chuck&quot;)
}
</code></pre><p>You have now encapsulated, in a reusable fashion, information about each page and how to interact with it. As anyone who has tried to knows, maintaining a large suite of functional web tests for a changing application can become an expensive and frustrating process. Geb&rsquo;s support for the Page Object pattern addresses this problem.</p><h2><span id='the_page_superclass'>5.2</span> The Page superclass</h2><p>All page objects <strong>must</strong> inherit from <a href="api/geb/Page.html"><code>Page</code></a>.</p><h2><span id='the_content_dsl'>5.3</span> The Content DSL</h2><p>Geb features a DSL for defining page content in a <em>templated</em> fashion, which allows very concise yet flexible page definitions. Pages define a <code>static</code> closure property called <code>content</code> that describes the page content. </p><p>Consider the following HTML…</p>
<pre><code>&lt;div id=&quot;a&quot;&gt;a&lt;/div&gt;
</code></pre><p>We could define this content as so…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDiv { $(&#39;div&#39;, id: &#39;a&#39;) }
    }
}
</code></pre><p>The structure to the content DSL is…</p>
<pre><code>«name» { «definition» }
</code></pre><p>Where <code>«definition»</code> is Groovy code that is evaluated against the instance of the page.</p><p>Here is how it could be used…</p>
<pre><code>Browser.drive {
    to ExamplePage
    assert theDiv.text() == &quot;a&quot;
}
</code></pre><p>So how is this working? First, remember that the <code>Browser</code> instance delegates any method calls or property accesses that it doesn&rsquo;t know about to the current page instance. So the above code is the same as…</p>
<pre><code>Browser.drive {
    to ExamplePage
    assert page.theDiv.text() == &quot;a&quot;
}
</code></pre><p>Secondly, defined content becomes available as properties and methods on instance of the page…</p>
<pre><code>Browser.drive {
    to ExamplePage

    // Following two lines are equivalent
    assert theDiv.text() == &quot;a&quot;
    assert theDiv().text() == &quot;a&quot;
}
</code></pre><p>The Content DSL actually defines content <em>templates</em>. This is best illustrated by example…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDiv { id -&gt; $(&#39;div&#39;, id: id) }
    }
}

Browser.drive {
    to ExamplePage
    assert theDiv(&quot;a&quot;).text() == &quot;a&quot;
}
</code></pre><p>There are no restrictions on what arguments can be passed to content templates.</p><p>A content template can return <em>anything</em>. Typically they will return a <a href="api/geb/navigator/Navigator.html"><code>Navigator</code></a> object through the use of the <code>$()</code> function, but it can be anything.</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDivText { $(&#39;div#a&#39;).text() }
    }
}

Browser.drive {
    to ExamplePage
    assert theDivText == &quot;a&quot;
}
</code></pre><p>It&rsquo;s important to realise that <code>«definition»</code> code is evaluated against the page instance. This allows code like the following…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDiv { $(&#39;div#a&#39;) }
        theDivText { theDiv.text() }
    }
}
</code></pre><p>And this is not restricted to other content…</p>
<pre><code>class ExamplePage extends Page {
    def divId = a
    static content = {
        theDiv { $(&#39;div&#39;, id: divId) }
        theDivText { theDiv.text() }
    }
}
</code></pre><p>Or…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDiv { $(&#39;div&#39;, id: getDivId()) }
        theDivText { theDiv.text() }
    }
    def getDivId() {
        &quot;a&quot;
    }
}
</code></pre><h3><span id='template_options'>5.3.1</span> Template Options</h3><p>Template definitions can take different options. The syntax is…</p>
<pre><code>«name»(«options map») { «definition» }
</code></pre><p>For example…</p>
<pre><code>theDiv(cache: false, required: false) { $(&quot;div&quot;, id: &quot;a&quot;) }
</code></pre><p>The following are the available options.</p><h4><span id='required'>5.3.1.1</span> required</h4><p>Default value: <code>true</code></p><p>The <code>required</code> option controls whether or not the content returned by the definition has to exist or not. This is only relevant when the definition returns a <code>Navigator</code> object (via the <code>$()</code> function), it is ignored if the definition returns anything else.</p><p>If the <code>required</code> option is set to <code>true</code> and the returned content does not exist, a <a href="api/geb/error/RequiredPageContentNotPresent.html"><code>RequiredPageContentNotPresent</code></a> exception will be thrown.</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theDiv { $(&#39;div&#39;, id: &quot;b&quot;) }
    }
}

Browser.drive {
    to ExamplePage
    def thrown = false
    try {
        theDiv
    } catch (RequiredPageContentNotPresent e) {
        thrown = true
    }
    assert thrown
}
</code></pre><h4><span id='cache'>5.3.1.2</span> cache</h4><p>Default value: <code>false</code></p><p>The <code>cache</code> option controls whether or not the definition is evaluated each time the content is requested (the content is cached for each unique set of parameters). </p>
<pre><code>class ExamplePage extends Page {
    def value = 1
    static content = {
        theValue(cache: true) { value }
    }
}

Browser.drive {
    to ExamplePage
    assert theValue == 1
    value = 2
    assert theValue == 1
}
</code></pre><p>With caching disabled…</p>
<pre><code>class ExamplePage extends Page {
    def value = 1
    static content = {
        theValue(cache: false) { value }
    }
}

Browser.drive {
    to ExamplePage
    assert theValue == 1
    value = 2
    assert theValue == 2
}
</code></pre><p>Caching is a performance optimisation and is disabled by default. You may want to enable if you notice that the a particular content definition is taking a long time to resolve.</p><h4><span id='to'>5.3.1.3</span> to</h4><p>Default value: <code>null</code></p><p>The <code>to</code> option allows the definition of which page the browser will be sent to if the content is clicked.</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        helpLink(to: HelpPage) { $(&quot;a&quot;, text: &quot;Help&quot;) }
    }
}

class HelpPage extends Page {}

Browser.drive {
    to ExamplePage
    helpLink.click()
    assert at(HelpPage)
}
</code></pre><p>The <code>to</code> value will be implicitly used as an argument to the content&rsquo;s <code>click()</code> method, effectively setting the new page type and verifying its at checker. See the section on <a href="navigator.html#clicking">clicking content</a> for how this changes the browser&rsquo;s page object.</p><p>The list variant can also be used…</p>
<pre><code>static content = {
    loginButton(to: [LoginSuccessfulPage, LoginFailedPage]) { $(&quot;input.loginButton&quot;) }
}
</code></pre><p>Which on click sets the brower&rsquo;s page to be the first page in the list whose at checker returns true. This is equivalent to the <a href="api/geb/Browser.html#page(Class[])"><code>page(Class[] potentialPageTypes)</code> browser method</a> which is explained in the section on<br/><a href="browser.html#changing_the_page">changing pages</a>.</p><h4><span id='wait'>5.3.1.4</span> wait</h4><p>Default value: <code>false</code></p><p>The <code>wait</code> option allows Geb to wait an amount of time for content to appear on the page, instead of throwing a <a href="api/geb/error/RequiredPageContentNotPresent.html"><code>RequiredPageContentNotPresent</code></a> exception if the content is not present when requested.</p>
<pre><code>class DynamicPage extends Page {
    static content = {
        dynamicallyAdded(wait: true) { $(&quot;p.dynamic&quot;) }
    }
}

Browser.drive {
    to DynamicPage
    assert dynamicallyAdded.text() == &quot;I&#39;m here now&quot;
}
</code></pre><p>This is equivalent to:</p>
<pre><code>class DynamicPage extends Page {
    static content = {
        dynamicallyAdded(required: false) { $(&quot;p.dynamic&quot;) }
    }
}

Browser.drive {
    to DynamicPage
    assert waitFor { dynamicallyAdded }.text() == &quot;I&#39;m here now&quot;
}
</code></pre><p>See the <a href="javascript.html#waiting">section on waiting</a> for the semantics of the <code>waitFor()</code> method, that is used here internally. Like <code>waitFor()</code> a <a href="api/geb/waiting/WaitTimeoutException.html"><code>WaitTimeoutException</code></a> will be thrown if the wait timeout expires.</p><p>The value for the <code>wait</code> option can be one of the following:</p>
<ul>
  <li><strong><code>true</code></strong> - wait for the content using the <em>default wait</em> configuration</li>
  <li><strong>a string</strong> - wait for the content using the <em>wait preset</em> with this name from the configuration</li>
  <li><strong>a number</strong> - wait for the content for this many seconds, using the <em>default retry interval</em> from the configuration</li>
  <li><strong>a 2 element list of numbers</strong> - wait for the content using element 0 as the timeout seconds value, and element 1 as the retry interval seconds value</li>
</ul><p>Any other value will be interpreted as <code>false</code>.</p><p>It is also possible to use <code>wait</code> when defining non element content, such as a string or number. Geb will wait until the content definition returns a value that conforms to the Groovy Truth.</p>
<pre><code>class DynamicPage extends Page {
    static content = {
        status { $(&quot;p.status&quot;) }
        successStatus(wait: true) { status.text().contains(&quot;Success&quot;) }
    }
}

Browser.drive {
    to DynamicPage
    assert successStatus
}
</code></pre><p>In this case, we are inherently waiting for the <code>status</code> content to be on the page and for it to contain the string “Success”. If the <code>status</code> element is not present when we request <code>successStatus</code>, the <a href="api/geb/error/RequiredPageContentNotPresent.html"><code>RequiredPageContentNotPresent</code></a> exception that would be thrown is swallowed and Geb will try again after the retry interval has expired.</p><p>You can modify the behaviour of content with <code>wait</code> option set to true if you use it together with <code>required</code> option set to false. Given a content definition:</p>
<pre><code>static content = {
    dynamicallyAdded(wait: true, required: false) { $(&quot;p.dynamic&quot;) }
}
</code></pre><p>Then if wait timeout expires when retrieving <code>dynamicallyAdded</code> there will be no <code>WaitTimeoutException</code> thrown and the last closure evaluation value will be returned. If there is an exception thrown during closure evaluation it will be wrapped in an <a href="api/geb/waiting/UnknownWaitForEvaluationResult.html"><code>UnknownWaitForEvaluationResult</code></a> instance and returned.</p><p>Waiting content blocks are subject to “implicit assertions”. See the section on <a href="implicit-assertions.html">implicit assertions</a> for more information.</p><h4><span id='page'>5.3.1.5</span> page</h4><p>Default value: <code>null</code></p><p>The <code>page</code> option allows the definition of a page the browser will be set to if the content describes a frame and is used in a <code>withFrame()</code> call.</p><p>Given the following html&hellip;</p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;frame id=&quot;frame-id&quot; src=&quot;frame.html&quot;&gt;&lt;/frame&gt;
    &lt;body&gt;
&lt;/html&gt;
</code></pre><p>&hellip;and the code for frame.html&hellip;</p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;span&gt;frame text&lt;/span&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>&hellip;the following will pass&hellip;</p>
<pre><code>class PageWithFrame extends Page {
    static content = {
        myFrame(page: FrameDescribingPage) { $(&#39;#frame-id&#39;) }
    }
}

class FrameDescribingPage extends Page {
    static content = {
        frameContentsText { $(&#39;span&#39;).text() }
    }
}

to PageWithFrame
withFrame(myFrame) {
    assert frameContentsText == &#39;frame text&#39;
}
</code></pre><h3><span id='aliasing'>5.3.2</span> Aliasing</h3><p>If you wish to have the same content definitions available under diferent names you can create a content definition that specifies <code>aliases</code> parameter:</p>
<pre><code>class AliasingPage extends Page {
    static content = {
       someButton { $(&quot;button&quot;, text: &quot;foo&quot;) }
       someButtonByAnotherName(aliases: someButton)
    }
}

Browser.drive {
    to AliasingPage
    assert someButton.text() == someButtonByAnotherName.text()
}
</code></pre><p>Remember that the aliased content has to be defined before the aliasing content, otherwise you will get a <a href="api/geb/error/InvalidPageContent.html"><code>InvalidPageContent</code></a> exception.</p><h2><span id='at_verification'>5.4</span> “At” Verification</h2><p>Each page can define a way to check whether the underling browser is at the page that the page class actually represents. This is done via a <code>static</code> <code>at</code> closure…</p>
<pre><code>class ExamplePage extends Page {
    static at = { $(&quot;h1&quot;).text() == &quot;Example&quot; }
}
</code></pre><p>This closure can either return a <code>false</code> value or throw an <code>AssertionError</code> (via the <code>assert</code> method). The <code>verifyAt()</code> method call will either return true or throw an <code>AssertionError</code> even if there are no explicit assertions in the “at” checker.</p>
<pre><code>Browser.drive {
    to ExamplePage
    verifyAt()
}
</code></pre><p>The <code>verifyAt()</code> method is used by the browser <code>at()</code> method which also returns true or throws an <code>AssertionError</code> even if there are no explicit assertions in the “at” checker…</p>
<pre><code>Browser.drive {
    to ExamplePage
    at(ExamplePage)
}
</code></pre><p>At checkers are subject to “implicit assertions”. See the section on <a href="implicit-assertions.html">implicit assertions</a> for more information.</p><p>If you don&rsquo;t wish to get an exception when “at” checking fails there are methods that return <code>false</code> in that case: <a href="api/geb/Page.html#verifyAtSafely()"><code>Page#verifyAtSafely()</code></a> and <a href="api/geb/Browser.html#isAt(java.lang.Class)"><code>Browser#isAt(Class&lt;? extends Page&gt;)</code></a>.</p><p>As mentioned previously, when a content template defines a “to” option of more than one page the page&rsquo;s <code>verifyAt()</code> method is used to determine which one of the pages to use. In this situation, any <code>AssertionError</code>s thrown by at checkers are suppressed.</p><p>The “at” checker is evaluated against the page instance, and can access defined content or any other variables or methods…</p>
<pre><code>class ExamplePage extends Page {
    static at = { heading == &quot;Example&quot; }
    static content = {
        heading { $(&quot;h1&quot;).text() }
    }
}
</code></pre><p>If a page does not verify an “at” checker, the <code>verifyAt()</code> method will always return <code>true</code>.</p><h2><span id='page_urls'>5.5</span> Page URLs</h2><p>Pages can define URLs via the <code>static</code> <code>url</code> property.</p>
<pre><code>class ExamplePage extends Page {
    static url = &quot;examples&quot;
}
</code></pre><p>The url is used when using the browser <code>to()</code> method.</p>
<pre><code>Browser.drive {
    go &quot;http://myapp.com/&quot;
    to ExamplePage
}
</code></pre><p>See the section on <a href="browser.html#the_base_url">the base url</a> for notes about urls and slashes.</p><h2><span id='advanced_page_navigation'>5.6</span> Advanced Page Navigation</h2><p>Page classes can customise how they generate URLs when used in conjunction with the browser <code>to()</code> method. </p><p>Consider the following example…</p>
<pre><code>import geb.*

class ExamplePage extends Page {
    static url = &quot;example&quot;
}

Browser.drive(&quot;http://myapp.com/&quot;) {
    to ExamplePage
}
</code></pre><p>This will result in a request being made to “<code>http://myapp.com/example</code>”. </p><p>The <code>to()</code> method can also take arguments…</p>
<pre><code>Browser.drive(&quot;http://myapp.com&quot;) {
    to ExamplePage, 1, 2
}
</code></pre><p>This will result in a request being made to “<code>http://myapp.com/example/1/2</code>”. This is because by default, any arguments passed to the <code>to()</code> method after the page class are converted to a URL path by calling <code>toString()</code> on each argument and joining them with “<code>/</code>”. </p><p>However, this is extensible. You can specify how a set of arguments is converted to a URL path to be added to the page URL. This is done by overriding the <a href="api/geb/Page.html#convertToPath(Object[])"><code>convertToPath()</code></a> method.<br/>The <a href="api/geb/Page.html"><code>Page</code></a> implementation of this method looks like this…</p>
<pre><code>String convertToPath(Object[] args) {
    args ? &#39;/&#39; + args*.toString().join(&#39;/&#39;) : &quot;&quot;
}
</code></pre><p>You can either overwrite this catch all method control path conversion for all invocations, or provide an overloaded version for a specific type signature. Consider the following…</p>
<pre><code>class Person {
    Long id
    String name
}

class PersonPage {
    static url = &quot;person&quot;

    String convertToPath(Person person) {
        person.id.toString()
    }
}

def newPerson = new Person(id: 5, name: &quot;Bruce&quot;)

Browser.drive {
    go &quot;http://myapp.com/&quot;
    to PersonPage, newPerson
}
</code></pre><p>This will result in a request to “<code>http://myapp.com/person/5</code>”.</p><h3><span id='named_params'>5.6.1</span> Named params</h3><p>Any type of argument can be used with the <code>to()</code> method, <strong>except</strong> named parameters (i.e. a <code>Map</code>). Named parameters are <strong>always</strong> interpreted as query parameters. Using the classes from the above example…</p>
<pre><code>Browser.driver {
    go &quot;http://myapp.com/&quot;
    to PersonPage, newPerson, flag: true
}
</code></pre><p>This will result in a request to “<code>http://myapp.com/person/5?flag=true</code>”. The query parameters are <strong>not</strong> sent to the <a href="api/geb/Page.html#convertToPath(Object[])"><code>convertToPath()</code></a> method.</p><h2><span id='inheritance'>5.7</span> Inheritance</h2><p>Pages can be arranged in an inheritance hierarchy. The content definitions are merged…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        heading { $(&quot;h1&quot;) }
    }
}

class SpecialExamplePage extends ExamplePage {
    static content = {
        footer { $(&quot;div.footer&quot;) }
    }
}

Browser.drive {
    to SpecialExamplePage
    assert heading.text() == &quot;Special Example&quot;
    assert footer.text() == &quot;This is the footer&quot;
}
</code></pre><p>If a subclass defines a content template with the same name as a content template defined in a superclass, the subclass version replaces the version from the superclass.</p><h2><span id='lifecycle_hooks'>5.8</span> Lifecycle Hooks</h2><p>Page classes can optionally implement methods that are called when the page is set as the browser&rsquo;s current page and when it is swapped out for another page. This can be used to transfer state between pages.</p><h3><span id='onloadpage_previouspage'>5.8.1</span> onLoad(Page previousPage)</h3><p>The <code>onLoad()</code> method is called with previous page object instance when the page becomes the new page object for a browser.</p>
<pre><code>import geb.*

class SomePage extends Page {
    void onLoad(Page previousPage) {
        // do some stuff with the previous page
    }
}
</code></pre><h3><span id='onunloadpage_newpage'>5.8.2</span> onUnload(Page newPage)</h3><p>The <code>onUnload()</code> method is called with next page object instance when the page is being replaced as the page object for the browser.</p>
<pre><code>import geb.*

class SomePage extends Page {
    void onUnload(Page newPage) {
        // do some stuff with the new page
    }
}
</code></pre><h2><span id='dealing_with_frames'>5.9</span> Dealing with frames</h2><p>Frames might seem a thing of the past but if you&rsquo;re accessing or testing some legacy application with Geb you might still need to deal with them. Thankfully Geb makes working with them groovier thanks to the <code>withFrame()</code> method which is available on Browser, Page and Module.</p><h3><span id='executing_code_in_the_context_of_a_frame'>5.9.1</span> Executing code in the context of a frame</h3><p>There are multiple flavours of the <code>withFrame()</code> method, but the for all of them the closure parameter is executed in the context of a frame specified by the first parameter and after the execution the browser page is restored to what it was before the call:</p>
<ul>
  <li><code>withFrame(String, Closure)</code> - String parameter contains the name or id of a frame element</li>
  <li><code>withFrame(int, Closure)</code> - int parameter contains the index of the frame element, that is, if a page has three frames, the first frame would be at index “0”, the second at index “1” and the third at index “2”</li>
  <li><code>withFrame(Navigator, Closure)</code> - Navigator parameter should point to a frame element</li>
  <li><code>withFrame(SimplePageContent, Closure)</code> - SimplePageContent should contain a frame element</li>
</ul><p>Given the following html&hellip;</p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;frame name=&quot;header&quot; src=&quot;frame.html&quot;&gt;&lt;/frame&gt;
        &lt;frame id=&quot;footer&quot; src=&quot;frame.html&quot;&gt;&lt;/frame&gt;
        &lt;iframe id=&quot;inline&quot; src=&quot;frame.html&quot;&gt;&lt;/iframe&gt;
        &lt;span&gt;main&lt;/span&gt;
    &lt;body&gt;
&lt;/html&gt;
</code></pre><p>&hellip;and the code for frame.html&hellip;</p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;span&gt;frame text&lt;/span&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre><p>&hellip;then this code will pass&hellip;</p>
<pre><code>static content = {
    footerFrame { $(&#39;#footer&#39;) }
}

withFrame(&#39;header&#39;) { assert $(&#39;span&#39;) == &#39;frame text&#39; }
withFrame(&#39;footer&#39;) { assert $(&#39;span&#39;) == &#39;frame text&#39; }
withFrame(0) { assert $(&#39;span&#39;) == &#39;frame text&#39; }
withFrame($(&#39;#footer&#39;)) { assert $(&#39;span&#39;) == &#39;frame text&#39; }
withFrame(footerFrame) { assert $(&#39;span&#39;) == &#39;frame text&#39; }

assert $(&#39;span&#39;) == &#39;main&#39;
</code></pre><p>If a frame cannot be found for a given first argument of the <code>withFrame()</code> call then <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/NoSuchFrameException.html"><code>NoSuchFrameException</code></a> is thrown.</p><h3><span id='switching_pages_and_frames_at_once'>5.9.2</span> Switching pages and frames at once</h3><p>All of the aforementioned <code>withFrame()</code> variants also accept an optional second argument (a page class) which allows to switch page for the execution of the closure passed as the last parameter.</p><p>Following shows an example usage:</p>
<pre><code>to PageWithFrames
//browser.page set to a PageWithFrames instance

withFrame(&#39;frame-name&#39;, PageDescribingFrameContents) {
    //browser.page set to a PageDescribingFrameContents instance
}

//browser.page set back to the PageWithFrames instance
</code></pre><p>It is also possible to <a href="pages.html#page">specify a page to switch to for a page content that describes a frame</a>.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='modules'>6</span> Modules</h1><p>Modules are re-usable definitions of content that can be used across multiple pages. They are useful for modelling things like UI widgets that are used across multiple pages, or even for defining more complex UI elements in the one page.</p><p>They are defined in a manner similar to pages, but extend <a href="api/geb/Module.html"><code>Module</code></a>…</p>
<pre><code>class ExampleModule extends Module {
    static content = {
        button { $(&quot;input&quot;, type: &quot;submit&quot;) }
    }
}
</code></pre><p>Pages can “include” modules using the following syntax…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theModule { module ExampleModule }
    }
}
</code></pre><p>The <code>module</code> method is a special method only available in content template definitions. It sets the content to an instance of the module…</p>
<pre><code>Browser.drive {
    to ExamplePage
    theModule.button.click()
}
</code></pre><p>Modules can also be parameterised…</p>
<pre><code>class ExampleModule extends Module {
    def buttonName
    static content = {
        button { $(&quot;input&quot;, type: &quot;submit&quot;, name: buttonName) }
    }
}
</code></pre><p>Where the parameters are set using the <code>module</code> method…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        theModule { name -&gt; module ExampleModule, buttonName: name }
    }
}

Browser.drive {
    to ExamplePage
    theModule(&quot;something&quot;).button.click()
}
</code></pre><p>Modules can also include other modules…</p>
<pre><code>class ExampleModule extends Module {
    static content = {
        innerModule { module InnerModule }
    }
}

class InnerModule extends Module {
    static content = {
        button { $(&quot;input&quot;, type: &quot;submit&quot;) }
    }
}

class ExamplePage extends Page {
    static content = {
        theModule { module ExampleModule }
    }
}

Browser.drive {
    theModule.innerModule.button.click()
}
</code></pre><h2><span id='base_and_context'>6.1</span> Base And Context</h2><p>Modules can be localised to a specific section of the page that they are used in, or they can specify an absolute context as part of their definition. There are two ways that a modules base/context can be defined.</p><p>It can be defined at inclusion time…</p>
<pre><code>static content = {
    form { module FormModule, $(&quot;form&quot;) }
}
</code></pre><p>We can define a <code>Navigator</code> context when including the module using the above syntax. This now means that <em>all</em> <code>$()</code> function calls that occur within the module are against the given context (in this case, the <code>form</code> element).</p><p>However, module classes can also define their own base…</p>
<pre><code>import geb.Module

class FormModule extends Module {
    static base = { $(&quot;form&quot;) }
}
</code></pre><p>This has the same effect as the code above.</p><p>They can also be combined. Consider the following HTML…</p>
<pre><code>&lt;div class=&quot;a&quot;&gt;
    &lt;form&gt;
        &lt;input name=&quot;thing&quot; value=&quot;a&quot;/&gt;
    &lt;/form&gt;
&lt;/div&gt;
&lt;div class=&quot;b&quot;&gt;
    &lt;form&gt;
        &lt;input name=&quot;thing&quot; value=&quot;b&quot;/&gt;
    &lt;/form&gt;
&lt;/div&gt;
</code></pre><p>And the following content definitions…</p>
<pre><code>import geb.*

class ExamplePage extends Page {
    static content = {
        formA { module FormModule, $(&quot;div.a&quot;) }
        formB { module FormModule, $(&quot;div.b&quot;) }
    }
}

class FormModule extends Module {
    static base = { $(&quot;form&quot;) }
    static content = {
        thingValue { thing().value() }
    }
}
</code></pre><p>When working with a browser at a <code>ExamplePage</code> page…</p>
<pre><code>assert formA.thingValue == &quot;a&quot;
assert formB.thingValue == &quot;b&quot;
</code></pre><p>If the module declares a base, it is always calculated <em>relative</em> to the base given by the including statement. If the including statement does not specify a base, the module&rsquo;s base is calculated relative to the including page&rsquo;s base.</p><h2><span id='reusing_modules_across_pages'>6.2</span> Reusing modules across pages</h2><p>As previously stated, modules can be used to model page fragments that are reused across multiple pages. For example, many different types of pages in your application may show information about the user&rsquo;s shopping cart. You could handle this with modules…</p>
<pre><code>class CartInfoModule extends Module {
    static content = {
        section { $(&quot;div.cart-info&quot;) }
        itemCount { section.find(&quot;span.item-count&quot;).toInteger() }
        totalCost { section.find(&quot;span.total-cost&quot;).toDouble() }
    }
}

class HomePage extends Page {
    static content = {
        cartInfo { module CartInfoModule }
    }
}

class OtherPage extends Page {
    static content = {
        cartInfo { module CartInfoModule }
    }
}
</code></pre><p>Modules work well for this.</p><h2><span id='using_modules_for_repeating_content_on_a_page'>6.3</span> Using modules for repeating content on a page</h2><p>Other than content that is repeated on different pages (like the shopping cart mentioned above), pages also have content that is repeated on the page itself. On a checkout page, the contents of the shopping cart could be summarized with the product name, the quantity and price for each product contained. For this kind of page, a list of modules can be collected using the moduleList function.</p><p>Consider the following HTML for our cart contents:</p>
<pre><code>&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;Product&lt;/th&gt;&lt;th&gt;Quantity&lt;/th&gt;&lt;th&gt;Price&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;The Book Of Geb&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;5.99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Geb Single-User License&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;99.99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Geb Multi-User License&lt;/td&gt;&lt;td&gt;1&lt;/td&gt;&lt;td&gt;199.99&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
</code></pre><p>We can model one line of the table like this:</p>
<pre><code>class CartRow extends Module {
    static content = {
        cell { $(&quot;td&quot;, it) }
        productName { cell(0).text() }
        quantity { cell(1).text().toInteger() }
        price { cell(2).text().toDouble() }
    }
}
</code></pre><p>And define a list of CartRows in our Page:</p>
<pre><code>class CheckoutPage extends Page {
    static content = {
        cartItems { moduleList CartRow, $(&quot;table tr&quot;).tail() } // tailing to skip the header row
    }
}
</code></pre><p>Because the return value of cartItems is a list of CartRow instances, we can use any of the usual collection methods:</p>
<pre><code>assert cartItems.every { it.price &gt; 0.0 }
</code></pre><p>We can also access the cart items like this:</p>
<pre><code>assert cartItems[0].productName == &quot;The Book Of Geb&quot;
</code></pre><p>Unfortunatelly this has a perfromance penalty of creating all modules in the list. You can get around it and add support for ranges by changing your content definition to:</p>
<pre><code>class CheckoutPage extends Page {
    static content = {
       cartItems { index -&gt; moduleList CartRow, $(&quot;table tr&quot;).tail(), index }
    }
}
</code></pre><p>Now the all of the following will pass and is more efficient:</p>
<pre><code>assert cartItems.every { it.price &gt; 0.0 }
assert cartItems(0).productName == &quot;The Book Of Geb&quot;
assert cartItems(1..2)*.productName == [&quot;Geb Single-User License&quot;, &quot;Geb Multi-User License&quot;]
</code></pre><p>Keep in mind that you can also pass module parameters the same way as you would with the <code>module()</code> method:</p>
<pre><code>static content = {
    myContent { index -&gt; moduleList MyModule, $(&quot;.myModuleClass&quot;), index, myParam: &#39;param value&#39; }
}
</code></pre><h2><span id='the_content_dsl'>6.4</span> The Content DSL</h2><p>The Content DSL used for modules is <em>exactly</em> the same as the <a href="pages.html#the_content_dsl">one used for pages</a>, so all of the same options and techniques can be used.</p><h2><span id='inheritance'>6.5</span> Inheritance</h2><p>Modules can use inheritance in the same way that pages can. That is, their content definitions are merged with any content redefined in the subclass taking precedence of the superclass.</p><h2><span id='size_and_location'>6.6</span> Size and Location</h2><p>You can obtain the size and location of the module. All units are in pixels. The size is available via the <code>height</code> and <code>width</code> properties, while the location is available as the <code>x</code> and <code>y</code> properties which represent the distance from the top left of the page (or parent frame) to the top left point of the base of the module.</p>
<pre><code>$(&quot;div&quot;).height == 20
$(&quot;div&quot;).width == 40
$(&quot;div&quot;).x == 60
$(&quot;div&quot;).y == 80
</code></pre>
    </div>
  
    <div class="chapter">
      <h1><span id='configuration'>7</span> Configuration</h1><p>Geb provides a configuration mechanism that allows you to control various aspects of Geb in a flexible way. At the heart of this is the <a href="api/geb/Configuration.html">Configuration</a> object, which the <a href="api/geb/Browser.html">Browser</a> and other objects query at runtime.</p><p>There are three general mechanisms for influencing configuration; <em>system properties</em>, <em>config script</em> and the <em>build adapter</em>.</p><h2><span id='mechanisms_'>7.1</span> Mechanisms</h2><h3><span id='the_config_script'>7.1.1</span> The Config Script</h3><p>Geb attempts to load a <a href="http://groovy.codehaus.org/gapi/groovy/util/ConfigSlurper.html">ConfigSlurper</a> script named <code>GebConfig.groovy</code> from the <em>default package</em> (in other words, in the root of a directory that is on the classpath). If it is not found, Geb will try to load a <a href="http://groovy.codehaus.org/gapi/groovy/util/ConfigSlurper.html">ConfigSlurper</a> class named <code>GebConfig</code> from the <em>default package</em> - this is usefull if you run tests that use Geb from an IDE because you won&rsquo;t have to specify <code>GebConfig.groovy</code> as a resource, Geb will simply fall back to the compiled version of the script. If both script and class are not found Geb will continue using all defaults.</p><p>First, the script is looked for with the <strong>executing thread&rsquo;s context class loader</strong> and if it is not found, then it is looked for with the class loader that loaded Geb. This covers 99% of scenarios out of the box perfectly well without any intervention. If however you do need to configure the context class loader to load the config script, you <strong>must</strong> make sure that it is either the same as the class loader that loaded Geb or a child of it. If the script is not found by both of those class loaders the procedure will be repeated but this time the class will be searched for - first using <strong>executing thread&rsquo;s context class loader</strong> and then using the class loader that loaded Geb.</p>
<blockquote><p>In a Grails project, the <code>test/functional</code> directory is a good place to put your config script in. If you are using a build tool such as <a href="http://gradle.org/">Gradle</a> or <a href="http://maven.apache.org/">Maven</a> that has the concept of test “resources”, then that directory is a suitable place. You can also put your script together with your compilation source and then the compiled version of the script will be used.</p>
</blockquote><h4><span id='environment_sensitivity'>7.1.1.1</span> Environment Sensitivity</h4><p>The Groovy <a href="http://groovy.codehaus.org/gapi/groovy/util/ConfigSlurper.html">ConfigSlurper</a> mechanism has built in support for environment sensitive configuration, and Geb leverages this by using the <strong><code>geb.env</code></strong> system property to determine the environment to use. An effective use of this mechanism is to configure different drivers based on the designated Geb “environment” (concrete details on how to do this further down).</p><p>How you set the environment system property is going to be dependent on the build system you are using. For example, when using Grails you could control the Geb environment by specifying it on the command line…</p>
<pre><code>grails -Dgeb.env=windows test-app functional:
</code></pre><p>Other build environments will allow you to do this in different ways.</p><h3><span id='system_properties'>7.1.2</span> System Properties</h3><p>Some config options can be specified by system properties. In general, config options specified by system properties will <em>override</em> values set in the config script. See the config options below for which options are controllable via system properties.</p><h3><span id='build_adapter'>7.1.3</span> Build Adapter</h3><p>The build adapter mechanism exists to allow Geb to integrate with development/build environments that logically dictate config options. For example, Grails dictates what the base url and directory for reports should be set to and the Geb plugin for Grails uses the build adapter mechanism to set this up.</p><p>This mechanism works by loading the name of the class (fully qualified) by the system property <code>geb.build.adapter</code> that must implement the <a href="api/geb/BuildAdapter.html">BuildAdapter</a> interface. Currently, the build adapter can only influence the base url to use, and the location of the reports directory.</p><p>If the <code>geb.build.adapter</code> system property is not explicitly set, it defaults to <a href="api/geb/buildadapter/SystemPropertiesBuildAdapter.html"><code>SystemPropertiesBuildAdapter</code></a>. As you can probably deduce, this default implementation uses system properties to specify values, so is usable in most circumstances. See the linked API doc for the details of the specific system properties it looks for.</p>
<blockquote><p>Note that while the default build adapter uses system properties, it should not be considered to be the same as system property configuration due to values in the config script taking precedence over the build adapter which is not true for system properties.</p>
</blockquote><h2><span id='config_options'>7.2</span> Config Options</h2><h3><span id='driver_implementation'>7.2.1</span> Driver Implementation</h3><p>The driver to use is specified by the config key <code>driver</code>, or the system property <code>geb.driver</code>.</p><h4><span id='factory_closure'>7.2.1.1</span> Factory Closure</h4><p>In the config script it can be a closure that when invoked with no arguments returns an instance of <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html">WebDriver</a> …</p>
<pre><code>import org.openqa.selenium.firefox.FirefoxDriver

driver = { new FirefoxDriver() }
</code></pre><p>This is the preferred mechanism, as it allows the most control over the drivers creation and configuration.</p><p>You can use the <a href="http://groovy.codehaus.org/gapi/groovy/util/ConfigSlurper.html">ConfigSlurper</a> mechanism&rsquo;s environment sensitivity to configure different drivers per environment …</p>
<pre><code>import org.openqa.selenium.firefox.FirefoxDriver

import org.openqa.selenium.remote.DesiredCapabilities
import org.openqa.selenium.remote.RemoteWebDriver

// default is to use firefox
driver = { new FirefoxDriver() }

environments {
    // when system property &#39;geb.env&#39; is set to &#39;win-ie&#39; use a remote IE driver
    &#39;win-ie&#39; {
        driver = {
            new RemoteWebDriver(new URL(&quot;http://windows.ci-server.local&quot;), DesiredCapabilities.internetExplorer())
        }
    }
}
</code></pre>
<blockquote><p>WebDriver has the ability to drive browsers on a remote host, which is what we are using above. For more information consult the WebDriver documentation on <a href="http://code.google.com/p/selenium/wiki/RemoteWebDriver">remote clients</a> and <a href="http://code.google.com/p/selenium/wiki/RemoteWebDriverServer">remote servers</a>.</p>
</blockquote><h4><span id='driver_class_name'>7.2.1.2</span> Driver Class Name</h4><p>The name of the driver class to use (it will be constructed with no arguments) can be specified as a string with the key <code>driver</code> in the config script or via the <code>geb.driver</code> system property (the class must implement the <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/WebDriver.html">WebDriver API</a>).</p>
<pre><code>driver = &quot;org.openqa.selenium.firefox.FirefoxDriver&quot;
</code></pre><p>Or it can be one of the following short names; <code>ie</code>, <code>htmlunit</code>, <code>firefox</code> or <code>chrome</code>. These will be implicitly expanded to their fully qualified class names …</p>
<pre><code>driver = &quot;firefox&quot;
</code></pre><p>The following table gives the possible short names that can be used:</p>
<table class="graybox" border="0" cellspacing="0" cellpadding="5">
    <tr><th>Short Name</th><th>Driver</th></tr>
    <tr>
        <td><code>htmlunit</code></td>
        <td><a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/htmlunit/HtmlUnitDriver.html">org.openqa.selenium.htmlunit.HtmlUnitDriver</a></td>
    </tr>
    <tr>
        <td><code>firefox</code></td>
        <td><a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/firefox/FirefoxDriver.html">org.openqa.selenium.firefox.FirefoxDriver</a></td>
    </tr>
    <tr>
        <td><code>ie</code></td>
        <td><a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/ie/InternetExplorerDriver.html">org.openqa.selenium.ie.InternetExplorerDriver</a></td>
    </tr>
    <tr>
        <td><code>chrome</code></td>
        <td><a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/chrome/ChromeDriver.html">org.openqa.selenium.chrome.ChromeDriver</a></td>
    </tr>
</table><p>If no explicit driver is specified then Geb will look for the following drivers on the classpath in the order they are listed in the above table. If none of these classes can be found, a <a href="api/geb/error/UnableToLoadAnyDriversException.html"><code>UnableToLoadAnyDriversException</code></a> will be thrown.</p><h3><span id='navigator_factory'>7.2.2</span> Navigator Factory</h3><p>It is possible to specify your own implementation of <a href="api/geb/navigatory/factory/NavigatorFactory.html"><code>NavigatorFactory</code></a> via configuration. This is useful if you want to extend the <a href="api/geb/navigatory/Navigator.html"><code>Navigator</code></a> class to provide your own behaviour extensions.</p><p>Rather than inject your own <code>NavigatorFactory</code>, it is simpler to inject a custom <a href="api/geb/navigatory/factory/NavigatorFactory.html"><code>InnerNavigatorFactory</code></a> which is a much simpler interface. To do this, you can specify a closure for the config key <code>innerNavigatorFactory</code>…</p>
<pre><code>innerNavigatorFactory = { Browser browser, List&lt;org.openqa.selenium.WebElement&gt; elements
    elements ? new MyCustomNavigator(browser, elements) : new geb.navigator.EmptyNavigator()
}
</code></pre><p>This is a rather advanced use case. If you need to do this, check out the source code or get in touch via the mailing list if you need help.</p><h3><span id='driver_caching'>7.2.3</span> Driver Caching</h3><p>Geb&rsquo;s ability to cache a driver and re-use it for the lifetime of the JVM (i.e. <a href="driver.html#implicit_lifecycle">the implicit driver lifecycle</a>) can be disabled by setting the <code>cacheDriver</code> config option to <code>false</code>. However, if you do this you become <a href="driver.html#explicit_lifecycle">responsible for quitting</a> every driver that is created at the appropriate time.</p><p>The default caching behavior is to cache the driver globally across the JVM. If you are using Geb in multiple threads this may not be what you want as neither Geb <code>Browser</code> objects nor WebDriver at the core is thread safe. To remedy this, you can instruct Geb to cache the driver instance per thread by setting the config option <code>cacheDriverPerThread</code> to true.</p><p>Also, by default Geb will register a shutdown hook to quit any cached browsers when the JVM exits. You can disable this by setting te config property <code>quitCachedDriverOnShutdown</code> to <code>false</code>.</p><h3><span id='base_url'>7.2.4</span> Base URL</h3><p>The <a href="browser.html#the_base_url">base URL</a> to be used can be specified by setting the <code>baseUrl</code> config property (with a <code>String</code>) value or via the build adapter (the default implementation of which looks at the <code>geb.build.baseUrl</code> system property). Any value set in the config script will take precedence over the value provided by the build adapter.</p><h3><span id='waiting'>7.2.5</span> Waiting</h3><p>The <a href="javascript.html#waiting"><code>waitFor()</code></a> methods available on browser, page and module objects can be affected by configuration (this is also true for <a href="pages.html#wait">implicitly waiting content</a>). It is possible to specify default values for the timeout and retry interval, and to define presets of these values to be referred to by name.</p><h4><span id='defaults'>7.2.5.1</span> Defaults</h4><p>Defaults can be specified via:</p>
<pre><code>waiting {
    timeout = 10
    retryInterval = 0.5
}
</code></pre><p>Both values are optional and in seconds. If unspecified, the values of <code>5</code> for <code>timeout</code> and <code>0.1</code> for <code>retryInterval</code>.</p><h4><span id='presets'>7.2.5.2</span> Presets</h4><p>Presets can be specified via:</p>
<pre><code>waiting {
    presets {
        slow {
            timeout = 20
            retryInterval = 1
        }
        quick {
            timeout = 1
        }
    }
}
</code></pre><p>Here we have defined two presets, <code>slow</code> and <code>quick</code>. Notice that the <code>quick</code> preset does not specify a <code>retryInterval</code> value; defaults will be substituted in for any missing values (i.e. giving the <code>quick</code> preset the default <code>retryInterval</code> value of <code>0.1</code>).</p><h3><span id='reporter'>7.2.6</span> Reporter</h3><p>The <em>reporter</em> is the object responsible for snapshotting the state of the browser (see the <a href="reporting.html">reporting</a> chapter for details). All reporters are implemenations of the <a href="api/geb/report/Reporter.html"><code>Reporter</code></a> interface. If no reporter is explicitly defined, a <a href="api/geb/report/CompositeReporter.html">composite reporter</a> will be created from a <code>ScreenshotReporter</code> (takes a PNG screenshot) and <code>PageSourceReporter</code> (dumps the current DOM state as HTML). This is a sensible default, but should you wish to use a custom reporter you can assign it to the <code>reporter</code> config key.</p>
<pre><code>reporter = new CustomReporter()
</code></pre><h3><span id='reports_dir'>7.2.7</span> Reports Dir</h3><p>The reports dir configuration is used by to control where the browser should write reports (see the <a href="reporting.html">reporting</a> chapter for details).</p><p>In the config script, you can set the path to the directory to use for reports via the <code>reportsDir</code> key…</p>
<pre><code>reportsDir = &quot;target/geb-reports&quot;
</code></pre>
<blockquote><p>The value is interpreted as a path, and if not absolute will be relative to the JVM&rsquo;s working directory.</p>
</blockquote><p>The reports dir can also be specified by the build adapter (the default implementation of which looks at the <code>geb.build.reportsDir</code> system property). Any value set in the config script will take precedence over the value provided by the build adapter.</p><p>It is also possible to set the <code>reportsDir</code> config item to a file.</p>
<pre><code>reportsDir = new File(&quot;target/geb-reports&quot;)
</code></pre><p>By default this value is <strong>not set</strong>. The browser&rsquo;s <a href="browser.html#reporting"><code>report()</code></a> method requires a value for this config item so if you are using the reporting features you <strong>must</strong> set a reports dir.</p><h3><span id='report_test_failures_only'>7.2.8</span> Report Test Failures Only</h3><p>By default Geb will take a report at the end of each test method, regardless of whether it ended successfully or not. The <code>reportOnTestFailureOnly</code> setting allows you to specify that a report should be taken only if a failure occurs. This might be useful as a way to speed up large test suites.</p>
<pre><code>reportOnTestFailureOnly = true
</code></pre>
<blockquote><p>Currently this flag is only supported by the TestNG adapter. Support for JUnit, Spock and other frameworks is forthcoming.</p>
</blockquote><h3><span id='reporting_listener'>7.2.9</span> Reporting listener</h3><p>It is possible to specify a listener that will be notified when reports are taken. See the section on <a href="reporting.html#listening_to_reporting">listening to reporting</a> for details.</p><h3><span id='auto_clearing_cookies'>7.2.10</span> Auto Clearing Cookies</h3><p>Certain integrations will automatically clear the driver&rsquo;s cookies, which is usually necessary when using an <a href="driver.html#implicit_lifecycle">implicit driver</a>. This configuration flag, which is <code>true</code> by default, can be disabled by setting the <code>autoClearCookies</code> value in the config to <code>false</code>.</p>
<pre><code>autoClearCookies = false
</code></pre><h2><span id='runtime_overrides'>7.3</span> Runtime Overrides</h2><p>The <a href="api/geb/Configuration.html">Configuration</a> object also has setters for all of the config properties it exposes, allowing you to override config properties at runtime in particular circumstances if you need to.</p><p>For example, you may have one Spock spec that requires the <code>autoClearCookies</code> property to be disabled. You could disable it for just this spec by doing something like…</p>
<pre><code>import geb.spock.GebReportingSpec

class FunctionalSpec extends GebReportingSpec {
    def setup() {
       browser.config.autoClearCookies = false
    }
}
</code></pre>
    </div>
  
    <div class="chapter">
      <h1><span id='implicit_assertions'>8</span> Implicit Assertions</h1><p>As of Geb 0.7.0, certain parts of Geb utilise “<em>implicit assertions</em>”. This sole goal of this feature is to provide more informative error messages. Put simply it means that for a given block of code, all <em>expressions</em> are automatically turned into assertions. So the following code:</p>
<pre><code>1 == 1
</code></pre><p>Becomes…</p>
<pre><code>assert 1 == 1
</code></pre>
<blockquote><p>If you&rsquo;ve used the <a href="http://spockframework.org/">Spock Framework</a> you will be well familiar with the concept of implicit assertions from Spock&rsquo;s <code>then:</code> blocks.</p>
</blockquote><p>In Geb, waiting expressions and at expressions automatically use implicit assertions. Take the following page object…</p>
<pre><code>class ImplicitAssertionsExamplePage extends Page {

    static at = { title == &quot;Implicit Assertions!&quot; }

    static content = {
        dynamicParagraph(wait: true) { $(&quot;p&quot;, 0).text() == &quot;implicit assertions are cool!&quot; }
    }

    def waitForHeading() {
        waitFor { $(&quot;h1&quot;) }
    }
}
</code></pre><p>This automatically becomes…</p>
<pre><code>class ImplicitAssertionsExamplePage extends Page {

    static at = { assert title == &quot;Implicit Assertions!&quot; }

    static content = {
        dynamicParagraph(wait: true) { assert $(&quot;p&quot;, 0).text() == &quot;implicit assertions are cool!&quot; }
    }

    def waitForHeading() {
        waitFor { assert $(&quot;h1&quot;) }
    }
}
</code></pre><p>Because of this, Geb is able to provide much better error messages when the expression fails due to Groovy&rsquo;s <a href="http://dontmindthelanguage.wordpress.com/2009/12/11/groovy-1-7-power-assert/">power asserts</a>.</p><p><strong>Note:</strong> A special form of <code>assert</code> is used that returns the value of the expression, whereas a regular <code>assert</code> returns <code>null</code>. </p><p>This means that given…</p>
<pre><code>static content = {
    headingText(wait: true) { $(&quot;h1&quot;).text() }
}
</code></pre><p>Accessing <code>headingText</code> here will <em>wait</em> for there to be a <code>h1</code> and for it to have some text (because an <a href="http://docs.codehaus.org/display/GROOVY/Groovy+Truth">empty string is <code>false</code> in Groovy</a>), which will then be returned. This means that even when implicit assertions are used, the value is still returned and is is usable.</p><h2><span id='at_verification'>8.1</span> At Verification</h2><p>Let&rsquo;s take the <code>at</code> case.</p>
<blockquote><p>If you&rsquo;re unfamiliar with Geb&rsquo;s “at checking”, please read <a href="pages.html#at_verification">this section</a>. </p>
</blockquote><p>Consider the following small Geb script…</p>
<pre><code>Browser.drive {
    go ImplicitAssertionsExamplePage
    at ImplicitAssertionsExamplePage
}
</code></pre><p>At checking works by verifying that the page&rsquo;s “at check” returns a <em>trueish</em> value. If it does, the <code>at()</code> method returns <code>true</code>. If not, the <code>at()</code> method will return <code>false</code>. However, due to implicit assertions, the “at check” will never return <code>false</code>. Instead, the at checker will throw an <a href="http://docs.oracle.com/javase/6/docs/api/java/lang/AssertionError.html">AssertionError</a>. Because the page&rsquo;s “at check” is turned into an assertion, we&rsquo;ll get an error like:</p>
<pre><code>Assertion failed: 

title == &quot;Implicit Assertions!&quot;
|     |
|     false
Something else

    at ImplicitAssertionsExamplePage._clinit__closure1(ImplicitAssertionsExamplePage.groovy:3)
    at ImplicitAssertionsExamplePage._clinit__closure1(ImplicitAssertionsExamplePage.groovy)
    at geb.Page.verifyAt(Page.groovy:131)
    at geb.Browser.doAt(Browser.groovy:335)
    at geb.Browser.at(Browser.groovy:259)
    at groovyscript(groovyscript.groovy:3)
</code></pre><p>As you can see, this is much more informative than the <code>at()</code> method simply returning <code>false</code>.</p><h2><span id='waiting'>8.2</span> Waiting</h2><p>Another place where implicit assertions are utilised is for <em>waiting</em>.</p>
<blockquote><p>If you&rsquo;re unfamiliar with Geb&rsquo;s “waiting” support, please read <a href="javascript.html#waiting">this section</a>.</p>
</blockquote><p>Consider the following Geb script:</p>
<pre><code>Browser.drive {
    waitFor { title == &quot;Page Title&quot; }
}
</code></pre><p>The <code>waitFor</code> method verifies that the given clause returns a <em>trueish</em> value within a certain timeframe. Because of implicit assertions, when this fails the error will look something like this:</p>
<pre><code>geb.waiting.WaitTimeoutException: condition did not pass in 5.0 seconds (failed with exception)
    at geb.waiting.Wait.waitFor(Wait.groovy:128)
    at geb.waiting.WaitingSupport.doWaitFor(WaitingSupport.groovy:108)
    at geb.waiting.WaitingSupport.waitFor(WaitingSupport.groovy:84)
    at geb.waiting.WaitingSupport.waitFor(WaitingSupport.groovy:80)
    at geb.Browser.methodMissing(Browser.groovy:168)
    at geb.test.GebSpec.methodMissing(GebSpec.groovy:80)
    at groovyscript(groovyscript.groovy:2)
Caused by: Assertion failed: 

title == &quot;Page Title&quot;
|     |
|     false
Something else

    at geb.waiting.WaitingSupportSpec.failed waiting_closure4(WaitingSupportSpec.groovy:67)
    at geb.waiting.WaitingSupportSpec.failed waiting_closure4(WaitingSupportSpec.groovy)
    at geb.waiting.Wait.waitFor(Wait.groovy:117)
    ... 6 more
</code></pre><p>The failed assertion is carried as the cause of the <code>geb.waiting.WaitTimeoutException</code> and gives you an informative message as to why the waiting failed.</p><h3><span id='waiting_content'>8.2.1</span> Waiting Content</h3><p>The same implicit assertion semantics apply to content definitions that are waiting.</p>
<blockquote><p>If you&rsquo;re unfamiliar with Geb&rsquo;s “waiting content” support, please read <a href="pages.html#wait">this section</a>.</p>
</blockquote><p>Any content definitions that declare a <code>wait</code> parameter have implicit assertions added to each expression just like <code>waitFor()</code> method calls.</p><h2><span id='how_it_works_'>8.3</span> How it works</h2><p>The “implicit assertions” feature is implemented as a <a href="http://groovy.codehaus.org/Compile-time+Metaprogramming+-+AST+Transformations">Groovy compile time transformation</a>, which literally turns all <em>expressions</em> in a candidate block of code into assertions.</p><p>This transform is packaged as a separate jar named <code>geb-implicit-assertions</code>. This jar needs to be on the compilation classpath of your Geb test/pages/modules (and any other code that you want to use implicit assertions) in order for this feature to work.</p><p>If you are obtaining Geb via a dependency management system, this is typically not something you need to be concerned about as it will happen automatically. Geb is distributed via the Maven Central repository in Apache Maven format (i.e. via POM files). The main Geb module, <code>geb-core</code> depends on the <code>geb-implicit-assertions</code> module as a <code>compile</code> dependency. </p><p>If your dependency management system <em>inherits</em> transitive compile dependencies (i.e. also makes compile dependencies of first class compile dependencies first class compile dependencies) then you will automatically have the <code>geb-implicit-assertions</code> module as a compile dependency and everything will work fine (Maven, Gradle, Grails, and most configurations of Ivy do this). If your dependency management system does not do this, or if you are manually managing the <code>geb-core</code> dependency, be sure to include the <code>geb-implicit-assertions</code> dependency as a compile dependency.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='javascript_ajax_and_dynamic_pages'>9</span> Javascript, AJAX and Dynamic Pages</h1><p>This section discusses how to deal with some of the challenges in testing and/or automating modern web applications.</p><h2><span id='the_js_object'>9.1</span> The “js” object</h2><p>The browser instance exposes a “<a href="api/geb/Browser.html#getJs()"><code>js</code></a>” object that provides support for working with Javascript over and above what WebDriver provides.<br/>It&rsquo;s important to understand how WebDriver does handle Javascript, which is through a driver&rsquo;s implementation of <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html"><code>JavascriptExecutor</code></a>&rsquo;s [<code>executeScript()</code>](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String</a>, java.lang.Object[])) method. </p>
<blockquote><p>Before reading further, it&rsquo;s <strong>strongly</strong> recommended to read the description of [<code>executeScript()</code>](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String</a>, java.lang.Object[])) in order to understand how type conversion works between the two worlds.</p>
</blockquote><p>You can execute Javascript like you would with straight WebDriver using the driver instance via the browser…</p>
<pre><code>assert browser.driver.executeScript(&quot;return arguments[0];&quot;, 1) == 1
</code></pre><p>This is a bit long winded, and as you would expect Geb uses the dynamism of Groovy to make life easier.</p>
<blockquote><p>The <a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html">JavascriptExecutor</a> interface does not define any contract in regards to the driver&rsquo;s responsibility when there is some issue executing Javascript. All drivers however throw <em>some kind</em> of exception when this happens.</p>
</blockquote><h3><span id='accessing_variables'>9.1.1</span> Accessing Variables</h3><p>Any <em>global</em> javascript variables inside the browser can be read as <em>properties</em> of the <code>js</code> object.</p><p>Given the following page…</p>
<pre><code>&lt;html&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        var aVariable = 1;
    &lt;/script&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>We could access the javascript variable “<code>aVariable</code>” with…</p>
<pre><code>Browser.drive {
    assert js.aVariable == 1
}
</code></pre><p>Or if we wanted to map it to page content…</p>
<pre><code>class ExamplePage extends Page {
    static content = {
        aVar { js.aVariable }
    }
}

Browser.drive {
    to ExamplePage
    assert aVar == 1
}
</code></pre><p>We can even access <em>nested</em> variables…</p>
<pre><code>assert js.&quot;document.title&quot; == &quot;Book of Geb&quot;
</code></pre><h3><span id='calling_methods'>9.1.2</span> Calling Methods</h3><p>Any <em>global</em> javascript functions can be called as methods on the <code>js</code> object.</p><p>Given the following page…</p>
<pre><code>&lt;html&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        function addThem(a,b) {
            return a + b;
        }
    &lt;/script&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>We can call the <code>addThem()</code> function with…</p>
<pre><code>Browser.drive {
    assert js.addThem(1, 2) == 3
}
</code></pre><p>This also works from pages and modules.</p><p>To call <em>nested</em> methods, we use the same syntax as properties…</p>
<pre><code>Browser.drive {
    js.&quot;document.write&quot;(&quot;dynamic!&quot;)
}
</code></pre><h3><span id='executing_arbitrary_code'>9.1.3</span> Executing Arbitrary Code</h3><p>The <code>js</code> object also has an <code>exec()</code> method that can be used to run snippets of Javascript. It is identical to the [JavascriptExecutor.executeScript()](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String</a>, java.lang.Object[])) method, except that it takes its arguments in the other order…</p>
<pre><code>assert js.exec(1, 2, &quot;return arguments[0] + arguments[1];&quot;) == 3
</code></pre><p>You might be wondering why the order has been changed (i.e. the arguments go <em>before</em> the script). It makes writing multiline javascript more convenient…</p>
<pre><code>js.exec 1, 2, &quot;&quot;&quot;
    someJsMethod();
    // lots of javascript
    return true;
&quot;&quot;&quot;
</code></pre><h2><span id='waiting'>9.2</span> Waiting</h2><p>Geb provides some convenient methods for <em>waiting</em> for a certain condition to be true. This is useful for testing pages using AJAX, timers or effects.</p><p>The <code>waitFor</code> methods are provided by the <a href="api/geb/waiting/WaitingSupport.html"><code>WaitingSupport</code></a> mixin which delegates to the <a href="api/geb/waiting/Wait.html"><code>Wait</code> class</a> (see the documentation of the <a href="api/geb/waiting/Wait.html#waitFor(groovy.lang.Closure)"><code>waitFor</code> method</a> of this class for the precise semantics of <em>waiting</em>). These methods take various parameters that determine how long to wait for the given closure to return a true object according to the <a href="http://groovy.codehaus.org/Groovy+Truth" title="Groovy - Groovy Truth">Groovy Truth</a>, and how long to wait in between invoking the closure again.</p>
<pre><code>waitFor {} // use default configuration
waitFor(10) {} // wait for up to 10 seconds, using the default retry interval
waitFor(10, 0.5) {} // wait for up to 10 seconds, waiting half a second in between retries
waitFor(&quot;quick&quot;) {} // use the preset “quick” as the wait settings
</code></pre><p>See the section on <a href="configuration.html#waiting">wait configuration</a> for how to change the default values and define presets.</p>
<blockquote><p>It is also possible to declare that content should be implicitly waited on, see <a href="pages.html#wait">the <code>wait</code> option for content definition</a>. </p>
</blockquote><h3><span id='examples'>9.2.1</span> Examples</h3><p>Here is an example showing one way of using <code>waitFor()</code> to deal with the situation where clicking a button invokes an AJAX request that creates a new <code>div</code> on its completion.</p>
<pre><code>import geb.*

class DynamicPage extends Page {
    static content = {
        theButton { $(&quot;input&quot;, value: &quot;Make Request&quot;) }
        theResultDiv(required: false) { $(&quot;div#result&quot;) }
    }

    def makeRequest() {
        theButton.click()
        waitFor { theResultDiv.present }
    }
}

Browser.drive {
    to DynamicPage
    makeRequest()
    assert theResultDiv.text() == &quot;The Result&quot;
}
</code></pre>
<blockquote><p>Notice that the &lsquo;<code>theResultDiv</code>&rsquo; is declared <code>required: false</code>. This is almost always necessary when dealing with dynamic content as it&rsquo;s likely to not be present on the page when it is first accessed (see: <a href="pages.html#required">section on <code>required</code></a>)</p>
</blockquote><p>Because the browser delegates method calls to the page object, the above could have been written as…</p>
<pre><code>Browser.drive {
    $(&quot;input&quot;, value: &quot;Make Request&quot;)
    waitFor { $(&quot;div#result&quot;).present }
    assert $(&quot;div#result&quot;).text() == &quot;The Result&quot;
}
</code></pre><p>Recall that the <code>return</code> keyword is optional in Groovy, so in the example above the <code>$(&quot;div#result&quot;).present</code> statement acts as the return value for the closure and is used as the basis on whether the closure <em>passed</em> or not. This means that you must ensure that the last statement inside the closure returns a value that is <code>true</code> according to the <a href="http://groovy.codehaus.org/Groovy+Truth">Groovy Truth</a> (if you&rsquo;re unfamiliar with the Groovy Truth <strong>do</strong> read that page).</p>
<blockquote><p>Not using explicit <code>return</code> statements in closure expressions passed to <code>waitFor()</code> is actually preferred. See the section on <a href="implicit-assertions.html">implicit assertions</a> for more information.</p>
</blockquote><p>The closures given to the <code>waitFor</code> method(s) do not need to be single statement.</p>
<pre><code>waitFor {
    def a = 1
    def b = 2
    a == b
}
</code></pre><p>That will work fine.</p><p>If you wish to <em>test</em> multiple conditions as separate statement inside a <code>waitFor</code> closure, you can just put them in separate lines.</p>
<pre><code>waitFor {
    1 == 1
    2 == 2
}
</code></pre><h3><span id='custom_message'>9.2.2</span> Custom message</h3><p>If you wish to add a custom message to <code>WaitTimeoutException</code> that is being thrown when <code>waitFor</code> call times out you can do so by providing a message parameter to the <code>waitFor</code> call:</p>
<pre><code>waitFor (message: &#39;My custom message&#39;) { $(&quot;div#result&quot;).present }
</code></pre><h2><span id='alert_and_confirm_dialogs'>9.3</span> Alert and Confirm Dialogs</h2><p>WebDriver currently <a href="http://code.google.com/p/selenium/wiki/FrequentlyAskedQuestions#Q:_Does_support_Javascript_alerts_and_prompts?">does not handle</a> the <a href="http://www.w3schools.com/JS/js_popup.asp"><code>alert()</code> and <code>confirm()</code> dialog windows</a>. However, we can fake it through some Javascript magic as <a href="http://code.google.com/p/selenium/issues/detail?id=27#c17">discussed on the WebDriver issue for this</a>. Geb implements a workaround based on this solution for you. Note that this feature relies on making changes to the browser&rsquo;s <code>window</code> DOM object so may not work on all browsers on all platforms. At the time when WebDriver adds support for this functionality the underlying implementation of the following methods will change to use that which will presumably be more robust. Geb adds this functionality through the <a href="api/geb/js/AlertAndConfirmSupport.html"><code>AlertAndConfirmSupport</code></a> class that is mixed into<br/><a href="api/geb/Page.html"><code>Page</code></a> and<br/><a href="api/geb/Module.html"><code>Module</code></a>.</p><p>The Geb methods <strong>prevent</strong> the browser from actually displaying the dialog, which is a good thing. This prevents the browser blocking while the dialog is displayed and causing your test to hang indefinitely.</p>
<blockquote><p>Unexpected <code>alert()</code> and <code>confirm()</code> calls can have strange results. This is due to the nature of how Geb handles this internally. If you are seeing strange results, you may want to run your tests/scripts against a real browser and watch what happens to make sure there aren&rsquo;t <code>alert()</code>s or <code>confirm()</code>s being called that you aren&rsquo;t expecting. To do this, you need to disable Geb&rsquo;s handling by changing your code to not use the methods below.</p>
</blockquote><h3><span id='alert'>9.3.1</span> alert()</h3><p>There are two methods that deal with <code>alert()</code> dialogs:</p>
<pre><code>String withAlert(Closure actions)
void withNoAlert(Closure actions)
</code></pre><p>The first method, <code>withAlert()</code>, is used to verify actions that will produce an <code>alert()</code> dialog. This method returns the alert message.</p><p>Given the following HTML…</p>
<pre><code>&lt;input type=&quot;button&quot; name=&quot;showAlert&quot; onclick=&quot;alert(&#39;Bang!&#39;);&quot; /&gt;
</code></pre><p>The <code>withAlert()</code> method is used like so…</p>
<pre><code>assert withAlert { $(&quot;input&quot;, name: &quot;showAlert&quot;).click() } == &quot;Bang!&quot;
</code></pre><p>If an alert dialog is not raised by the given “actions” closure, an <code>AssertionError</code> will be thrown.</p><p>The <code>withAlert()</code> method also accepts a wait option. It is useful if the code in your “actions” closure is raising a dialog in an asynchronous manner and can be used like that:</p>
<pre><code>assert withAlert(wait: true) { $(&quot;input&quot;, name: &quot;showAlert&quot;).click() } == &quot;Bang!&quot;
</code></pre><p>The value for the <code>wait</code> option can be one of the following:</p>
<ul>
  <li><strong><code>true</code></strong> - wait for the content using the <em>default wait</em> configuration</li>
  <li><strong>a string</strong> - wait for the content using the <em>wait preset</em> with this name from the configuration</li>
  <li><strong>a number</strong> - wait for the content for this many seconds, using the <em>default retry interval</em> from the configuration</li>
  <li><strong>a 2 element list of numbers</strong> - wait for the content using element 0 as the timeout seconds value, and element 1 as the retry interval seconds value</li>
</ul><p>Any other value will be interpreted as <code>false</code>.</p><p>The second method, <code>withNoAlert()</code>, is used to verify actions that will not produce an <code>alert()</code> dialog. If an alert dialog is raised by the given “actions” closure, an <code>AssertionError</code> will be thrown.</p><p>Given the following HTML…</p>
<pre><code>&lt;input type=&quot;button&quot; name=&quot;dontShowAlert&quot; /&gt;
</code></pre><p>The <code>withNoAlert()</code> method is used like so…</p>
<pre><code>withNoAlert { $(&quot;input&quot;, name: &quot;dontShowAlert&quot;).click() }
</code></pre>
<blockquote><p>It&rsquo;s a good idea to use <code>withNoAlert()</code> when doing something that <em>might</em> raise an alert. If you don&rsquo;t, the browser is going to raise a real alert dialog and sit there waiting for someone to click it which means your test is going to hang. Using <code>withNoAlert()</code> prevents this.</p>
</blockquote><p>A side effect of the way that this is implemented is that we aren&rsquo;t able to definitively handle actions that cause the browser&rsquo;s actual page to change (e.g. clicking a link in the closure given to <code>withAlert()</code>/<code>withNoAlert()</code>). We can detect that the browser page did change, but we can&rsquo;t know if <code>alert()</code> did or did not get called before the page change. If a page change was detected the <code>withAlert()</code> method will return a literal <code>true</code> (whereas it would normally return the alert message), while the <code>withNoAlert()</code> will succeed.</p><h3><span id='confirm'>9.3.2</span> confirm()</h3><p>There are three methods that deal with <code>confirm()</code> dialogs:</p>
<pre><code>String withConfirm(boolean ok, Closure actions)
String withConfirm(Closure actions) // defaults &#39;ok&#39; to true
void withNoConfirm(Closure actions)
</code></pre><p>The first method, <code>withConfirm()</code> (and its ‘<code>ok</code>’ defaulted relative), is used to verify actions that will produce an <code>confirm()</code> dialog. This method returns the confirmation message. The <code>ok</code> parameter controls whether the <code>confirm()</code> call should return <code>true</code> or <code>false</code> (i.e. the user has clicked the “OK” or “Cancel” buttons).</p><p>Given the following HTML…</p>
<pre><code>&lt;input type=&quot;button&quot; name=&quot;showConfirm&quot; onclick=&quot;confirm(&#39;Do you like Geb?&#39;);&quot; /&gt;
</code></pre><p>The <code>withConfirm()</code> method is used like so…</p>
<pre><code>assert withConfirm(true) { $(&quot;input&quot;, name: &quot;showConfirm&quot;).click() } == &quot;Do you like Geb?&quot;
</code></pre><p>If a confirmation dialog is not raised by the given “actions” closure, an <code>AssertionError</code> will be thrown.</p><p>The <code>withConfirm()</code> method also accepts a wait option just like the <code>withAlert()</code> method. See the <a href="javascript.html#alert">description of <code>withAlert()</code></a> to learn about the possible values and usage.</p><p>The second method, <code>withNoConfirm()</code>, is used to verify actions that will not produce an <code>confirm()</code> dialog. If a confirmation dialog is raised by the given “actions” closure, an <code>AssertionError</code> will be thrown.</p><p>Given the following HTML…</p>
<pre><code>&lt;input type=&quot;button&quot; name=&quot;dontShowConfirm&quot; /&gt;
</code></pre><p>The <code>withNoConfirm()</code> method is used like so…</p>
<pre><code>withNoConfirm { $(&quot;input&quot;, name: &quot;dontShowConfirm&quot;).click() }
</code></pre>
<blockquote><p>It&rsquo;s a good idea to use <code>withNoConfirm()</code> when doing something that <em>might</em> raise a a confirmation. If you don&rsquo;t, the browser is going to raise a real confirmation dialog and sit there waiting for someone to click it which means your test is going to hang. Using <code>withNoConfirm()</code> prevents this.</p>
</blockquote><p>A side effect of the way that this is implemented is that we aren&rsquo;t able to definitively handle actions that cause the browser&rsquo;s actual page to change (e.g. clicking a link in the closure given to <code>withConfirm()</code>/<code>withNoConfirm()</code>). We can detect that the browser page did change, but we can&rsquo;t know if <code>confirm()</code> did or did not get called before the page change. If a page change was detected the <code>withConfirm()</code> method will return a literal <code>true</code> (whereas it would normally return the alert message), while the <code>withNoConfirm()</code> will succeed.</p><h3><span id='about_prompt'>9.3.3</span> About prompt()</h3><p>Geb does not provide any support for prompt() due to it&rsquo;s infrequent and generally discouraged use.</p><h2><span id='jquery_integration'>9.4</span> jQuery Integration</h2><p>Geb has special support for the <a href="http://jquery.com/" title="jQuery: The Write Less, Do More, JavaScript Library">jQuery javascript library</a>. Navigator objects have a special adapter that makes calling jQuery methods against the underlying DOM elements simple. This is best explained by example.</p>
<blockquote><p>The jQuery integration only works when the pages you are working with include jQuery, Geb does not install it in the page for you. The minimum supported version of jQuery is 1.4.</p>
</blockquote><p>Consider the following page:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/js/jquery-1.4.2.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        $(function() {
            $(&quot;#a&quot;).mouseover(function() {
               $(&quot;b&quot;).show(); 
            });
        });
    &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id=&quot;a&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;b&quot; style=&quot;display:none;&quot;&gt;&lt;a href=&quot;http://www.gebish.org&quot;&gt;Geb!&lt;/a&gt;&lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>We want to click the Geb link, but can&rsquo;t because it&rsquo;s hidden (WebDriver does not let you interact with hidden elements). The div containing the link (div “a”) is only displayed when the mouse moves over div “a”.</p><p>The jQuery library provides convenient methods for triggering browser events. We can use this to simulate the mouse being moved over the div “a”.</p><p>In straight jQuery JavaScript we would do…</p>
<pre><code>jQuery(&quot;div#a&quot;).mouseover()
</code></pre><p>Which we could invoke via Geb easy enough…</p>
<pre><code>js.exec &#39;jQuery(&quot;div#a&quot;).mouseover();&#39;
</code></pre><p>That will work, but can be inconvenient as it duplicates content definitions in our Geb pages. Geb&rsquo;s jQuery integration allows you to use your defined content in Geb with jQuery. Here is how we could call the <code>mouseover</code> jQuery function on an element from Geb…</p>
<pre><code>$(&quot;div#a&quot;).jquery.mouseover()
</code></pre><p>To be clear, that is Groovy (not JavaScript code). It can be used with pages…</p>
<pre><code>import geb.*

class ExamplePage extends Page {
    static content = {
        divA { $(&quot;#a&quot;) }
        divB { $(&quot;#b&quot;) }
        gebLink { divB.find(&quot;a&quot;) }
    }
}

Browser.drive {
    to ExamplePage
    // div b is not showing
    divA.jquery.mouseover()
    // div b is showing now
    gebLink.click()
}
</code></pre><p>The <code>jquery</code> property of a navigator is conceptually equivalent to a jQuery object for <em>all</em> of the navigator&rsquo;s matched page elements. </p><p>The methods can also take arguments…</p>
<pre><code>$(&quot;#a&quot;).jquery.trigger(&#39;mouseover&#39;)
</code></pre><p>The same set of restricted types as allowed by WebDriver&rsquo;s [<code>executeScript()</code>](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String</a>, java.lang.Object[])) method are permitted here.</p><p>The return value of methods called on the <code>jquery</code> property depends on what the corresponding jQuery method returns. A jQuery object will be converted to a Navigator representing the same set of elements, other values such as strings and numbers are returned as per WebDriver&rsquo;s [<code>executeScript()</code>](<a href="http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String">http://selenium.googlecode.com/svn/trunk/docs/api/java/org/openqa/selenium/JavascriptExecutor.html#executeScript(java.lang.String</a>, java.lang.Object[])) method.</p><h3><span id='why'>9.4.1</span> Why?</h3><p>This functionality was developed to make triggering mouse related events easier. Some applications are very sensitive to mouse events and triggering these events in an automated environment is a challenge. jQuery provides a good API for faking these events which makes for a good solution.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='direct_downloading'>10</span> Direct Downloading</h1><p>Geb features an API that can be used to make direct HTTP requests from the application that is executing the Geb scripts or tests. This facilitates fine grained requests and downloading content such as PDF, CSVs, images etc. into your scripts or tests to then do something with. </p><p>The direct download API works by using <a href="http://download.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html"><code>java.net.HttpURLConnection</code></a> to directly connect to a URL from the application executing Geb, bypassing WebDriver.</p><p>The Direct Download API is provided by the <a href="api/geb/download/DownloadSupport.html"><code>DownloadSupport</code></a> class, which is mixed in to pages and modules (which means you can just call these instance methods directly from anywhere where you would want to, e.g. drive blocks, in tests/specs, methods on page objects, methods on modules). Consult the <a href="api/geb/download/DownloadSupport.html"><code>DownloadSupport</code></a> API reference for the <code>download*</code> methods that are available.</p><h2><span id='downloading_example'>10.1</span> Downloading Example</h2><p>For example, let&rsquo;s say you are using Geb to exercise a web application that generates PDF documents. The WebDriver API can only deal with HTML documents. You want to hit the PDF download link and also do some tests on the downloaded PDF. The direct download API is there to fill this need.</p>
<pre><code>Browser.drive {
    go &quot;http://myapp.com/login&quot;

    // login
    username = &quot;me&quot;
    password = &quot;secret&quot;
    login().click()

    // now find the pdf download link
    def downloadLink = $(&quot;a.pdf-download-link&quot;)

    // now get the pdf bytes
    def bytes = downloadBytes(downloadLink.@href)
}
</code></pre><p>Simple enough, but consider what is happening behind the scenes. Our application required us to log in, which implies some kind of session state. Geb is using <a href="http://download.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html"><code>HttpURLConnection</code></a> behind the scenes to get the content and before doing so the cookies from the real browser will be transferred allowing this connection to assume the same session. The PDF download link href may also be relative and Geb handles this by resolving the link passed to the download function against the browser&rsquo;s current page URL.</p><h2><span id='fine_grained_request'>10.2</span> Fine Grained Request</h2><p>The Direct Download API can also be used for making fine grained requests which can be useful for testing edge cases or abnormal behavior.</p><p>All of the <code>download*()</code> methods take an optional closure that can configure the <a href="http://download.oracle.com/javase/6/docs/api/java/net/HttpURLConnection.html">java.net.HttpURLConnection</a> that will be used to make the request (after the <code>Cookie</code> header has been set).</p><p>For example, we could test what happens when we send gibberish in the <code>Accept-Encoding</code> header. </p>
<pre><code>Browser.drive {
    go &quot;http://myapp.com/somepage&quot;
    downloadText { HttpURLConnection connection -&gt;
        connection.setRequestProperty(&quot;Accept-Encoding&quot;, &quot;gibberish&quot;)
    }
}
</code></pre>
<blockquote><p>Before doing something like the above, it&rsquo;s worth considering whether doing such testing via Geb (a browser automation tool) is the right thing to do. You may find that it&rsquo;s more appropriate to directly use HttpURLConnection without Geb. That said, there are scenarios where such fine grained request control can be useful.</p>
</blockquote><h2><span id='errors'>10.3</span> Errors</h2><p>Any IO type errors that occur during a download operation (e.g. HTTP 500 responses) will result in a <a href="api/geb/download/DownloadException.html"><code>DownloadException</code></a> being thrown that wraps the original exception and provides access to the HttpURLConnection used to make the request.</p>
    </div>
  
    <div class="chapter">
      <h1><span id='scripts_and_binding'>11</span> Scripts and Binding</h1><p>Geb supports being used in scripting environments via both the <code>Browser.drive()</code> method, and by using the <a href="api/geb/binding/BindingUpdater.html"><code>geb.binding.BindingUpdater</code></a> class that populates and updates a <a href="http://groovy.codehaus.org/api/groovy/lang/Binding.html"><code>groovy.lang.Binding</code></a> that can be used with scripts. This is also the same mechanism that is used by the <a href="testing.html#easyb">EasyB Geb plugin</a> and can be used with <a href="testing.html#cucumber_cuke4duke">Cuke4Duke</a> (Cucumber for the JVM).</p><h2><span id='setup'>11.1</span> Setup</h2><p>To use the binding support, you simply create a <a href="api/geb/binding/BindingUpdater.html"><code>BindingUpdater</code></a> object with a <a href="http://groovy.codehaus.org/api/groovy/lang/Binding.html"><code>Binding</code></a> and <a href="api/geb/Browser.html"><code>Browser</code></a>…</p>
<pre><code>import geb.Browser
import geb.binding.BindingUpdater
import groovy.lang.Binding

def binding = new Binding()
def browser = new Browser()
def updater = new BindingUpdater(binding, browser)

// populate and start updating the browser
updater.initialize()

// Run a script from the filesystem
new GroovyShell(binding).evaluate(new File(&quot;someScript.groovy&quot;))

// remove Geb bits from the binding and stop updating it
updater.remove()
</code></pre><h2><span id='the_binding_environment'>11.2</span> The binding environment</h2><h3><span id='browser_methods__properties'>11.2.1</span> Browser methods &amp; properties</h3><p>The <a href="api/geb/binding/BindingUpdater.html"><code>BindingUpdater</code></a> installs shortcuts into the binding for most of the <a href="api/geb/Browser.html">browser</a> object&rsquo;s public methods. </p><p>For example…</p>
<pre><code>go &quot;some/page&quot;
assert at(SomePage)
waitFor { $(&quot;p.status&quot;).text() == &quot;ready&quot; }
js.someJavaScriptFunction()
downloadText($(&quot;a.csvFile&quot;))
</code></pre><p>In a managed binding, all of the methods/properties that you can usually call in the <a href="#the_drive_method"><code>Browser.drive()</code></a> method are available. This includes the <code>$()</code> function.</p><p>The following methods are available:</p>
<ul>
  <li>$</li>
  <li>go</li>
  <li>to</li>
  <li>at</li>
  <li>waitFor</li>
  <li>withAlert</li>
  <li>withNoAlert</li>
  <li>withConfirm</li>
  <li>withNoConfirm</li>
  <li>download</li>
  <li>downloadStream</li>
  <li>downloadText</li>
  <li>downloadBytes</li>
  <li>downloadContent</li>
  <li>report</li>
  <li>reportGroup</li>
  <li>cleanReportGroupDir</li>
</ul><p>The javascript interface property <a href="javascript.html#the_js_object"><code>js</code></a> is also available. The browser object itself is available as the <code>browser</code> property.</p><h3><span id='the_current_page'>11.2.2</span> The current page</h3><p>The binding updater also updates the <code>page</code> property of the binding to be the browser&rsquo;s current page…</p>
<pre><code>import geb.Page

class SomePage extends Page {
    static content = {
       button(to: OtherPage) { $(&quot;input.do-stuff&quot;) }
    }
}

to SomePage
assert page instanceof SomePage
page.button.click()
assert page instanceof OtherPage
</code></pre>
    </div>
  
    <div class="chapter">
      <h1><span id='reporting'>12</span> Reporting</h1><p>Geb includes a simple reporting mechanism which can be used to snapshot the state of the browser at any point in time. Reporters are implementations of the <a href="api/geb/report/Reporter.html"><code>Reporter</code></a> interface. Geb ships with two implementations; <a href="api/geb/report/PageSourceReporter.html"><code>PageSourceReporter</code></a> and <a href="api/geb/report/ScreenshotReporter.html"><code>ScreenshotAndPageSourceReporter</code></a>. There are three bits of configuration that pertain to reporting; the <a href="configuration.html#reporter">reporter</a> implementation, the <a href="configuration.html#reports_dir">reports directory</a> and whether to <a href="configuration.html#report_test_failures_only">only report test failures</a> or not.</p><p>If no reporter is explicitly defined, a <a href="api/geb/report/CompositeReporter.html">composite reporter</a> will be created from a <code>ScreenshotReporter</code> (takes a PNG screenshot) and <code>PageSourceReporter</code> (dumps the current DOM state as HTML).</p><p>You take a report by calling the <a href="api/geb/Browser.html#report(java.lang.String)"><code>report(String label)</code></a> method on the browser object.</p>
<pre><code>Browser.drive {
    go &quot;http://google.com&quot;
    report &quot;google home page&quot;
}
</code></pre>
<blockquote><p>The <code>report()</code> method will thrown an exception if it is called and there is no configured <code>reportsDir</code>. If you are going to use reporting you <strong>must</strong> specify a <code>reportsDir</code> via config.</p>
</blockquote><p>Assuming that we configured a <code>reportsDir</code> of “<code>reports/geb</code>”, after running this script we will find two files in this directory:</p>
<ul>
  <li><code>001-google home page.html</code> - A html dump of the page source</li>
  <li><code>001-google home page.png</code> - A screenshot of the browser as a PNG file (if the driver implementation supports this)</li>
</ul>
<blockquote><p>To avoid issues with reserved characters in filenames, Geb replaces any character in the report name that is not an alphanumeric, a space or a hyphen with an underscore.</p>
</blockquote><h2><span id='the_report_group'>12.1</span> The report group</h2><p>The configuration mechanism allows you to specify the base <code>reportsDir</code> which is where reports are written to by default. It is also possible to change the <a href="api/geb/Browser.html#reportGroup(java.lang.String)">report group</a> to a relative path inside this directory.</p>
<pre><code>Browser.drive {
    reportGroup &quot;google&quot;
    go &quot;http://google.com&quot;
    report &quot;home page&quot;

    reportGroup &quot;wikipedia&quot;
    go &quot;http://wikipedia.org&quot;
    report &quot;home page&quot;
}
</code></pre><p>We have now created the following files inside the <code>reportsDir</code>…</p>
<ul>
  <li><code>google/home page.html</code></li>
  <li><code>google/home page.png</code></li>
  <li><code>wikipedia/home page.html</code></li>
  <li><code>wikipedia/home page.png</code></li>
</ul><p>The browser will create the directory for the report group as needed. By default, the report group is not set which means that reports are written to the base of the <code>reportsDir</code>. To go back to this after setting a report group, simply call <code>reportGroup(null)</code>.</p>
<blockquote><p>It is common for test integrations to manage the report group for you, setting it to the name of the test class.</p>
</blockquote><h2><span id='listening_to_reporting'>12.2</span> Listening to reporting</h2><p>It is possible to register a listener on the reporter that gets notified when a report is taken. This was added to make it possible to write something to stdout when a report is taken, which is how the <a href="https://wiki.jenkins-ci.org/display/JENKINS/JUnit+Attachments+Plugin">Jenkins JUnit Attachments Plugin</a> makes it possible to associate arbitrary files to test execution. Reporting listeners are of type <a href="api/geb/report/ReportingListener.html"><code>ReportingListener</code></a> can be specified as part of the config…</p>
<pre><code>reportingListener = new ReportingListener() {
  void onReport(Reporter reporter, ReportState reportState, List&lt;File&gt; reportFiles) {
    reportFiles.each {
      println &quot;[[ATTACHMENT|$it.absolutePath]]&quot;
    }
  }
}
</code></pre><h2><span id='cleaning'>12.3</span> Cleaning</h2><p>Geb does not automatically clean the reports dir for you. It does however provide a method that you can call to do this.</p>
<pre><code>Browser.drive {
    cleanReportGroupDir()
    go &quot;http://google.com&quot;
    report &quot;home page&quot;
}
</code></pre><p>The <a href="api/geb/Browser.html#cleanReportGroupDir()"><code>cleanReportGroupDir()</code></a> method will remove whatever the reports group dir is set to at the time. If it cannot do this it will throw an exception.</p>
<blockquote><p>The Spock, JUnit and TestNG test integrations <strong>do</strong> automatically clean the reports dir for you, see the <a href="testing.html#reporting">section in the testing chapter</a> on these integrations.</p>
</blockquote>
    </div>
  
    <div class="chapter">
      <h1><span id='testing'>13</span> Testing</h1><p>Geb provides first class support for functional web testing via integration with popular testing frameworks such as <a href="http://spockframework.org/">Spock</a>, <a href="http://www.junit.org/">JUnit</a>, <a href="http://testng.org/">TestNG</a>, <a href="http://www.easyb.org/">EasyB</a> and <a href="https://github.com/cucumber/cuke4duke/wiki">Cuke4Duke</a>.</p><h2><span id='spock_junit__testng'>13.1</span> Spock, JUnit &amp; TestNG</h2><p>The Spock, JUnit and TestNG integrations work fundamentally the same way. They provide subclasses that setup a <a href="api/geb/Browser.html">browser</a> instance that all method calls and property accesses/references resolve against via Groovy&rsquo;s <code>methodMissing</code> and <code>propertyMissing</code> mechanism.</p>
<blockquote><p>Recall that the browser instance also forwards any method calls or property accesses/references that it can&rsquo;t handle to it&rsquo;s current page object, which helps to remove a lot of noise from the test.</p>
</blockquote><p>Consider the following Spock spec…</p>
<pre><code>import geb.spock.GebSpec

class FunctionalSpec extends GebSpec {
    def &quot;go to login&quot;() {
        when:
        go &quot;/login&quot;

        then:
        title == &quot;Login Screen&quot;
    }
}
</code></pre><p>Which is equivalent to…</p>
<pre><code>import geb.spock.GebSpec

class FunctionalSpec extends GebSpec {
    def &quot;go to login&quot;() {
        when:
        browser.go &quot;/login&quot;

        then:
        browser.page.title == &quot;Login Screen&quot;
    }
}
</code></pre><h3><span id='configuration'>13.1.1</span> Configuration</h3><p>The browser instance is created by the testing integration. The <a href="configuration.html">configuration mechanism</a> allows you to control aspects such as the driver implementation and base url.</p><h3><span id='reporting'>13.1.2</span> Reporting</h3><p>The Spock, JUnit and TestNG integrations also ship a superclass (the name of the class for each integration module is provided below) that automatically takes reports at the end of test methods with the label “end”. They also set the <a href="reporting.html#the_report_group">report group</a> to the name of the test class (substituting “.” for “/”).</p><p>The <a href="api/geb/Browser.html#report(java.lang.String)"><code>report(String label)</code></a> browser method is replaced with a specialised version. This method works the same as the browser method, but adds counters and the current test method name as prefixes to the given label.</p>
<pre><code>package my.tests

import geb.spock.GebReportingSpec

class FunctionalSpec extends GebReporting {

    def &quot;login&quot;() {
        when:
        go &quot;login&quot;
        username = &quot;me&quot;
        report &quot;login screen&quot; // take a report of the login screen
        login().click()

        then:
        title == &quot;Logged in!&quot;
    }
}
</code></pre><p>Assuming a configured <code>reportsDir</code> of <code>reports/geb</code> and the default reporter (i.e. <a href="api/geb/report/ScreenshotAndPageSourceReporter.html"><code>ScreenshotAndPageSourceReporter</code></a>), we would find the following files:</p>
<ul>
  <li><code>reports/geb/my/tests/FunctionalSpec/1-1-login-login screen.html</code></li>
  <li><code>reports/geb/my/tests/FunctionalSpec/1-1-login-login screen.png</code></li>
  <li><code>reports/geb/my/tests/FunctionalSpec/1-2-login-end.html</code></li>
  <li><code>reports/geb/my/tests/FunctionalSpec/1-2-login-end.png</code></li>
</ul><p>The report file name format is:</p>
<pre><code>«test method number»-«report number in test method»-«test method name»-«label».«extension»
</code></pre><p>Reporting is an extremely useful feature and can help you diagnose test failures much easier. Wherever possible, favour the use of the auto reporting base classes.</p><h3><span id='cookie_management'>13.1.3</span> Cookie management</h3><p>The Spock, JUnit and TestNG integrations will automatically clear the browser&rsquo;s cookies at the end of each test method. For JUnit 3 this happens in the <code>tearDown()</code> method in <code>geb.junit3.GebTest</code>, for JUnit 4 it happens in an <code>@After</code> method in <code>geb.junit4.GebTest</code> and for TestNG it happens in an <code>@AfterMethod</code> method in <code>geb.testng.GebTest</code>.</p><p>The <code>geb.spock.GebSpec</code> class will clear the cookies in the <code>cleanup()</code> method unless the spec is <code>@Stepwise</code>, in which case they are cleared in <code>cleanupSpec()</code> (meaning that all feature methods in a stepwise spec share the same browser state).</p><p>This auto clearing of cookies can be <a href="configuration.html#auto_clearing_cookies">disabled via configuration</a>.</p><h3><span id='jar_and_class_names'>13.1.4</span> Jar and class names</h3><p>The following table illustrates the specific jars and class names for Spock and JUnit.</p>
<table class="graybox" border="0" cellspacing="0" cellpadding="5">
    <tr>
        <th>Framework</th>
        <th>JAR</th>
        <th>Base Class</th>
        <th>Reporting Base Class</th>
    </tr>
    <tr>
        <td>Spock</td>
        <td><a href="http://mvnrepository.com/artifact/org.gebish/geb-spock">geb-spock</a></td>
        <td><a href="api/geb/spock/GebSpec.html">geb.spock.GebSpec</a></td>
        <td><a href="api/geb/spock/GebReportingSpec.html">geb.spock.GebReportingSpec</a></td>
    </tr>
    <tr>
        <td>JUnit 4</td>
        <td><a href="http://mvnrepository.com/artifact/org.gebish/geb-junit4">geb-junit4</a></td>
        <td><a href="api/geb/junit4/GebTest.html">geb.junit4.GebTest</a></td>
        <td><a href="api/geb/junit4/GebReportingTest.html">geb.junit4.GebReportingTest</a></td>
    </tr>
    <tr>
        <td>JUnit 3</td>
        <td><a href="http://mvnrepository.com/artifact/org.gebish/geb-junit3">geb-junit3</a></td>
        <td><a href="api/geb/junit3/GebTest.html">geb.junit3.GebTest</a></td>
        <td><a href="api/geb/junit3/GebReportingTest.html">geb.junit3.GebReportingTest</a></td>
    </tr>
    <tr>
        <td>TestNG</td>
        <td><a href="http://mvnrepository.com/artifact/org.gebish/geb-testng">geb-testng</a></td>
        <td><a href="api/geb/testng/GebTest.html">geb.testng.GebTest</a></td>
        <td><a href="api/geb/testng/GebReportingTest.html">geb.testng.GebReportingTest</a></td>
    </tr>
</table><h3><span id='example_projects'>13.1.5</span> Example Projects</h3><p>The following projects can be used as starting references:</p>
<ul>
  <li><a href="https://github.com/geb/geb-example-gradle">https://github.com/geb/geb-example-gradle</a></li>
</ul><h2><span id='easyb'>13.2</span> EasyB</h2><p>Geb&rsquo;s <a href="http://www.easyb.org/">EasyB</a> support is based around the <a href="binding.html">binding management features</a> discussed earlier.<br/>EasyB stories are implemented as Groovy scripts with a binding,<br/>and the Geb plugin simply integrates Geb&rsquo;s <a href="api/geb/binding/BindingUpdater.html">BindingUpdater</a> into the EasyB lifecycle.</p>
<blockquote><p>The Geb EasyB plugin is currently under-developed and is in need of some attention. If you&rsquo;d like to see better EasyB integration consider getting involved in its development.</p>
</blockquote><p>Here&rsquo;s a quick example…</p>
<pre><code>using &quot;geb&quot; // EasyB syntax for using plugins

scenario &quot;using geb&quot;, {
    given &quot;our base url&quot;, {
        baseUrl = &quot;http://my.app&quot;
    }

    when &quot;we go to the page&quot;, {
        to SomePage
    }

    then &quot;we arrive at the page&quot;, {
        at SomePage
    }

    and &quot;can use the javascript interface&quot;, {
        js.someJsVariable.shouldBe 1
    }

    and &quot;can do some waiting&quot;, {
        waitFor { $(&quot;p&quot;).text() == &quot;done&quot; }
    }

    and &quot;can work with the page&quot;, {
        page.div.text().shouldBe &quot;d1&quot;
    }
}

class SomePage extends geb.Page {
    static content = {
        div { $(&quot;#d1&quot;) }
    }
}
</code></pre><h3><span id='configuration'>13.2.1</span> Configuration</h3><p>Configuration is done in the <code>given</code> block of a scenario or story. Here you can optionally set 3 properties; <code>driver</code>, <code>baseUrl</code> and <code>browser</code>.</p><p>You can set the <code>driver</code> property to the driver instance that you want to implicitly created browser instance to use. However, using the <a href="configuration.html#driver_implementation">configuration mechanism for driver implementation</a> is preferred.</p><p>You can set the <code>baseUrl</code> property to the base url that you want to implicitly created browser instance to use. However, using the <a href="configuration.html#base_url">configuration mechanism for base url</a> is preferred.</p><p>For fine grained control, you can create your own <a href="api/geb/Browser.html">browser</a> instance and assign it to the <code>browser</code> property. Otherwise, an implicit browser object is created using <code>driver</code> and/or <code>baseUrl</code> if they were explicitly set (otherwise the configuration mechanism is used.)</p><h2><span id='cucumber_cuke4duke'>13.3</span> Cucumber (Cuke4Duke)</h2><p>Geb doesn&rsquo;t offer any explicit integration with <a href="https://github.com/cucumber/cuke4duke/wiki">Cuke4Duke</a> but due to Cuke4Duke&rsquo;s use of Groovy scripts, Geb&rsquo;s <a href="binding.html">binding management features</a> can be used to great effect.</p><p>The following is an example of what is possible…</p>
<pre><code>import static org.junit.Assert.*
import static org.junit.matchers.JUnitMatchers.*

import pages.*

this.metaClass.mixin(cuke4duke.GroovyDsl)

Given(~&quot;I am on the Google search page&quot;) { -&gt;
    to GoogleHomePage
    waitFor { at GoogleHomePage }
}

When(~&quot;I search for \&quot;(.*)\&quot;&quot;) { String query -&gt;
    page.searchField.value(query)
    page.searchButton.click()
}

Then(~&quot;I am at the results page&quot;) {
    assert at(GoogleResultsPage)
}

Then(~&quot;The first link should be \&quot;(.*)\&quot;&quot;) { String text -&gt;
    waitFor { page.results }
    assertThat page.resultLink(0).text(), containsString(text)
}
</code></pre><h3><span id='example_projects'>13.3.1</span> Example Projects</h3><p>The following projects can be used as starting references:</p>
<ul>
  <li><a href="https://github.com/geb/geb-example-cuke4duke">https://github.com/geb/geb-example-cuke4duke</a></li>
</ul>
    </div>
  
    <div class="chapter">
      <h1><span id='build_system__framework_integrations'>14</span> Build System &amp; Framework Integrations</h1><p>This kind of integration for Geb is typically focussed on managing the base url and reports dir as build systems tend to be able to provide this configuration (via the <a href="configuration.html#build_adapter">build adapter</a> mechanism).</p><h2><span id='grails'>14.1</span> Grails</h2><p><a href="http://grails.org">Grails</a> is a popular web app framework. There is a <a href="http://grails.org/plugin/geb">grails-geb plugin</a> available that allows you to use Geb for your Grails functional tests. This plugin simply manages the <code>baseUrl</code> and <code>reportsDir</code> configuration items.</p><p>You still need to include the appropriate Geb module for testing (i.e. <code>geb-junit4</code>, <code>geb-spock</code> or <code>geb-easyb</code>) yourself. You may also need to depend on other plugins like the <a href="http://grails.org/plugin/spock"><code>grails-spock</code></a> plugin to enable those kinds of tests.</p><p>For example, if you plan to use Spock with Geb you would need to add the following to the <code>BuildConfig.groovy</code>…</p>
<pre><code>dependencies {
    test &quot;org.gebish:geb-spock:0.9.0&quot;
}
plugins {
    test &quot;:spock:0.7&quot;
    test &quot;:geb:0.9.0&quot;
}
</code></pre><p>Where <code>0.9.0</code> and <code>0.7</code> are the versions of Geb and Spock you wish to use.</p><p>As Grails provides JUnit support out of the box, you only need to pull in the <code>geb-junit4</code> jar to use Geb with JUnit.</p>
<blockquote><p>Grails 1.3 and later use JUnit 4. Earlier versions of Grails than this use Groovy 1.6 which Geb no longer supports.</p>
</blockquote>
<pre><code>dependencies {
    test &quot;org.gebish:geb-junit4:0.9.0&quot;
}
plugins {
    test &quot;:geb:0.9.0&quot;
}
</code></pre><p>You only need the appropriate Geb test integration jar, as it will depend on <code>geb-core</code> and Grails&rsquo; dependency management will take care of getting that for you.</p><p>You will also of course need a driver and the <code>selenium-support</code> dependency, which you can also specify in <code>BuildConfig.groovy</code>.</p>
<pre><code>dependencies {
    test &quot;org.seleniumhq.selenium:selenium-support:«webdriver version»&quot;
    test &quot;org.seleniumhq.selenium:selenium-firefox-driver:«webdriver version»&quot;
}
</code></pre><p>HTMLUnit depends on some XML processing libraries that cause issues with Grails. You can avoid this by excluding certain dependencies of the HTMLUnit driver…</p>
<pre><code>test(&quot;org.seleniumhq.selenium:selenium-htmlunit-driver:«webdriver version»&quot;) {
    exclude &#39;xml-apis&#39;
}
</code></pre><p>Recall that Geb looks for its configuration file as <code>GebConfig.groovy</code> on the classpath. A good location for this file is in a Grails project is the <code>test/functional</code> directory is on the classpath at test time. You <strong>do not</strong> need to set the <code>baseUrl</code> and <code>reportsDir</code> config entries in a Grails project as the plugin takes care of those for you. The <code>baseUrl</code> is set to the root of the Grails application, and the <code>reportsDir</code> is set to <code>geb</code> inside Grails&rsquo; test reports dir (which by default is <code>target/test-reports</code>).</p><p>There is nothing special about writing Geb tests with Grails. You subclass the same classes as usual (e.g. <code>geb.spock.GebReportingSpec</code> for Spock tests).</p><p>There is an example project available that uses <code>geb-junit4</code> and <code>geb-spock</code> to test some Grails scaffold pages.</p>
<ul>
  <li><a href="https://github.com/geb/geb-example-grails">http://github.com/geb/geb-example-grails</a></li>
</ul><h2><span id='gradle'>14.2</span> Gradle</h2><p>Using Geb with Gradle simply involves pulling in the appropriate dependencies, and configuring the base URL and reports dir in the build script if they are necessary.</p><p>Below is a valid Gradle <code>build.gradle</code> file for working with Geb for testing.</p>
<pre><code>apply plugin: &quot;groovy&quot;

repositories {
    mavenCentral()
}

configurations {
    testCompile.transitive = true
}

dependencies {
    groovy &quot;org.codehaus.groovy:groovy-all:1.8.9&quot;

    def gebVersion = &quot;0.9.0&quot;
    def seleniumVersion = &quot;2.26.0&quot;

    // If using Spock, need to depend on geb-spock
    testCompile &quot;org.gebish:geb-spock:$gebVersion&quot;
    testCompile &quot;org.spockframework:spock-core:0.7-groovy-1.8&quot;

    // If using JUnit, need to depend on geb-junit (3 or 4)
    testCompile &quot;org.gebish:geb-junit4:$gebVersion&quot;
    testCompile &quot;junit:junit-dep:4.8.2&quot;

    // Need a driver implementation
    testCompile &quot;org.seleniumhq.selenium:selenium-firefox-driver:$seleniumVersion&quot;
    testRuntime &quot;org.seleniumhq.selenium:selenium-support:$seleniumVersion&quot;
}

test {
    systemProperties &quot;geb.build.reportsDir&quot;: &quot;$reportsDir/geb&quot;
}
</code></pre><p>There is a Gradle example project available.</p>
<ul>
  <li><a href="https://github.com/geb/geb-example-gradle">http://github.com/geb/geb-example-gradle</a></li>
</ul><h2><span id='maven'>14.3</span> Maven</h2><p>Using Geb with Maven simply involves pulling in the appropriate dependencies, and configuring the base URL and reports dir in the build script if they are necessary.</p><p>Below is a valid <code>pom.xml</code> file for working with Geb for testing (with Spock).</p>
<pre><code>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; 
        xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
  &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
  &lt;groupId&gt;org.gebish.example&lt;/groupId&gt;
  &lt;artifactId&gt;geb-maven-example&lt;/artifactId&gt;
  &lt;packaging&gt;jar&lt;/packaging&gt;
  &lt;version&gt;1&lt;/version&gt;
  &lt;name&gt;Geb Maven Example&lt;/name&gt;
  &lt;url&gt;http://www.gebish.org&lt;/url&gt;
  &lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt;
      &lt;artifactId&gt;groovy-all&lt;/artifactId&gt;
      &lt;version&gt;1.7.10&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;junit&lt;/groupId&gt;
      &lt;artifactId&gt;junit&lt;/artifactId&gt;
      &lt;version&gt;4.8.1&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.spockframework&lt;/groupId&gt;
      &lt;artifactId&gt;spock-core&lt;/artifactId&gt;
      &lt;version&gt;0.7-groovy-1.8&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.gebish&lt;/groupId&gt;
      &lt;artifactId&gt;geb-spock&lt;/artifactId&gt;
      &lt;version&gt;0.9.0&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
      &lt;artifactId&gt;selenium-firefox-driver&lt;/artifactId&gt;
      &lt;version&gt;2.26.0&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.seleniumhq.selenium&lt;/groupId&gt;
      &lt;artifactId&gt;selenium-support&lt;/artifactId&gt;
      &lt;version&gt;2.26.0&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.9&lt;/version&gt;
        &lt;configuration&gt;
          &lt;includes&gt;
            &lt;include&gt;*Spec.*&lt;/include&gt;
          &lt;/includes&gt;
          &lt;systemPropertyVariables&gt;
            &lt;geb.build.baseUrl&gt;http://google.com/ncr&lt;/geb.build.baseUrl&gt;
            &lt;geb.build.reportsDir&gt;target/test-reports/geb&lt;/geb.build.reportsDir&gt;
          &lt;/systemPropertyVariables&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.codehaus.gmaven&lt;/groupId&gt;
        &lt;artifactId&gt;gmaven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.3&lt;/version&gt;
        &lt;configuration&gt;
          &lt;providerSelection&gt;1.7&lt;/providerSelection&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;goals&gt;
              &lt;goal&gt;testCompile&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
&lt;/project&gt;
</code></pre><p>There is a Maven example project available.</p>
<ul>
  <li><a href="https://github.com/geb/geb-example-maven">http://github.com/geb/geb-example-maven</a></li>
</ul>
    </div>
  
    <div class="chapter">
      <h1><span id='about_the_project'>15</span> About the Project</h1><p>The Geb home page can be found at <a href="http://www.gebish.org">http://www.gebish.org</a>.</p><h2><span id='api_reference'>15.1</span> API Reference</h2><p>The API reference can be found <a href="api/index.html">here</a>.</p><h2><span id='support__development'>15.2</span> Support &amp; Development</h2><p>Support for Geb is offered on the <a href="mailto:&#117;s&#101;&#x72;&#x40;&#x67;&#x65;&#98;&#x2e;&#x63;o&#100;&#x65;&#104;a&#117;&#115;&#46;o&#114;g">&#117;s&#101;&#x72;&#x40;&#x67;&#x65;&#98;&#x2e;&#x63;o&#100;&#x65;&#104;a&#117;&#115;&#46;o&#114;g</a> mailing list, which can be subscribed to <a href="http://xircles.codehaus.org/lists/user@geb.codehaus.org">here</a>.</p><p>Ideas and new features for Geb can be discussed on the <a href="mailto:&#x64;&#101;&#x76;&#x40;&#103;&#101;b&#x2e;&#x63;o&#100;&#x65;&#x68;&#97;&#117;&#115;&#46;&#111;&#x72;&#x67;">&#x64;&#101;&#x76;&#x40;&#103;&#101;b&#x2e;&#x63;o&#100;&#x65;&#x68;&#97;&#117;&#115;&#46;&#111;&#x72;&#x67;</a> mailing list, which can be subscribed to <a href="http://xircles.codehaus.org/lists/dev@geb.codehaus.org">here</a>.</p><h2><span id='credits'>15.3</span> Credits</h2><h3><span id='committers'>15.3.1</span> Committers</h3>
<ul>
  <li><a href="http://ldaley.com">Luke Daley</a></li>
  <li><a href="http://blog.proxerd.pl">Marcin Erdmann</a></li>
  <li><a href="http://adhockery.blogspot.com/">Robert Fletcher</a></li>
  <li><a href="http://pniederw.wordpress.com/">Peter Niederwieser</a></li>
</ul><h3><span id='contributors'>15.3.2</span> Contributors</h3>
<ul>
  <li><a href="http://github.com/zolotov">Alexander Zolotov</a> - TestNG Integration</li>
  <li><a href="http://c089.wordpress.com/">Christoph Neuroth</a> - Various fixes and patches</li>
  <li><a href="http://www.desirableobjects.co.uk/">Antony Jones</a> - Various fixes and patches, doc improvements</li>
  <li><a href="http://hennr.name/imprint/">Jan-Hendrik Peters</a> - Doc improvements</li>
  <li><a href="http://fbflex.wordpress.com/">Tomás Lin</a> - Doc improvements</li>
</ul><h2><span id='history'>15.4</span> History</h2><p>This page lists the high level changes between versions of Geb.</p><h3><span id='090'>15.4.1</span> 0.9.0</h3><h4><span id='new_features'>15.4.1.1</span> New Features</h4>
<ul>
  <li>New <code>via()</code> method that behaves the same way as <code>to()</code> behaved previously - it sets the page on the browser and does not verify the at checker of that page[<a href="http://jira.codehaus.org/browse/GEB-249">GEB-249</a>].</li>
  <li>It is now possible to provide your own <a href="api/geb/navigator/Navigator.html"><code>Navigator</code></a> implementations by specifying a custom <a href="api/geb/navigator/factory/NavigatorFactory.html"><code>NavigatorFactory</code></a>, see <a href="configuration.html#navigator_factory">this manual section</a> for more information [<a href="http://jira.codehaus.org/browse/GEB-96">GEB-96</a>].</li>
  <li>New variants of <code>withFrame()</code> method that allow to switch into frame context and change the page in one go and also automatically change it back to the original page after the call, see <a href="pages.html#switching_pages_and_frames_at_once">switching pages and frames at once</a> in the manual [<a href="http://jira.codehaus.org/browse/GEB-213">GEB-213</a>].</li>
  <li><code>wait</code>, <code>page</code> and <code>close</code> options can be passed to <code>withNewWindow()</code> calls, see <a href="browser.html#passing_options_when_working_with_newly_opened_windows">this manual section</a> for more information [<a href="http://jira.codehaus.org/browse/GEB-167">GEB-167</a>].</li>
  <li>Improved message of UnresolvablePropertyException to include a hint about forgetting to import the class [<a href="http://jira.codehaus.org/browse/GEB-240">GEB-240</a>].</li>
  <li>Improved signature of <code>Browser.at()</code> and <code>Browser.to()</code> to return the exact type of the page that was asserted to be at / was navigated to.</li>
  <li><a href="api/geb/report/ReportingListener.html"><code>ReportingListener</code></a> objects can be registered to observe reporting (see: <a href="reporting.html#listening_to_reporting">reporting.html#listening_to_reporting</a></li>
</ul><h4><span id='fixes'>15.4.1.2</span> Fixes</h4>
<ul>
  <li>Fixed an issue where waitFor would throw a WaitTimeoutException even if the last evaluation before timeout returned a truthy value [<a href="http://jira.codehaus.org/browse/GEB-215">GEB-215</a>].</li>
  <li>Fixed taking screenshots for reporting when the browser is not on a HTML page (e.g. XML file) [<a href="http://jira.codehaus.org/browse/GEB-126">GEB-126</a>].</li>
  <li>Return the last evaluation value for a <code>(wait: true, required: false)</code> content instead of always returning null [<a href="http://jira.codehaus.org/browse/GEB-216">GEB-216</a>].</li>
  <li><code>isAt()</code> behaves the same as <code>at()</code> in regards to updating the browser&rsquo;s page instance to the given page type if its at checker is successful [<a href="http://jira.codehaus.org/browse/GEB-227">GEB-227</a>].</li>
  <li>Handling of <code>select</code> elements has been reworked to be far more efficient [<a href="http://jira.codehaus.org/browse/GEB-229">GEB-229</a>].</li>
  <li>Modules support accessing base attributes&rsquo; values using @attributeName notation [<a href="http://jira.codehaus.org/browse/GEB-237">GEB-237</a>].</li>
  <li>Use of text matchers in module base definitions is supported [<a href="http://jira.codehaus.org/browse/GEB-241">GEB-241</a>].</li>
  <li>Reading of textareas have been updated so that the current value of the text field is returned, instead of the initial [<a href="http://jira.codehaus.org/browse/GEB-174">GEB-174</a>].</li>
</ul><h4><span id='breaking_changes'>15.4.1.3</span> Breaking Changes</h4>
<ul>
  <li><code>to(Class&lt;? extends Page&gt;)</code> method now changes the page on the browser and verifies the at checker of that page in one method call [<a href="http://jira.codehaus.org/browse/GEB-1">GEB-1</a>], [<a href="http://jira.codehaus.org/browse/GEB-249">GEB-249</a>]; use <code>via()</code> if you need the old behaviour</li>
  <li><code>getAttribute(String)</code> on <code>Navigator</code> now returns <code>null</code> for boolean attributes that are not present.</li>
  <li><code>at()</code> and <code>to()</code> methods on <code>Browser</code> now return a page instance if they succeed and <code>via()</code> method always returns a page instance [<a href="http://jira.codehaus.org/browse/GEB-217">GEB-217</a>].</li>
  <li><code>withFrame()</code> calls that don&rsquo;t take a page argument now change the browser page to what it was before the call, after the call [<a href="http://jira.codehaus.org/browse/GEB-222">GEB-222</a>].</li>
  <li>due to performance improvements duplicate elements are not removed when creating new <code>Navigator</code>s anymore; the new <code>unique()</code> method on <code>Navigator</code> can be used to remove duplicates if needed [<a href="http://jira.codehaus.org/browse/GEB-223">GEB-223</a>].</li>
  <li><code>at(Page)</code> and <code>isAt(Page)</code> methods on <code>Browser</code> have been removed as they were inconsistent with the rest of the API [<a href="http://jira.codehaus.org/browse/GEB-242">GEB-242</a>].</li>
  <li>Navigator&rsquo;s <code>click(Class&lt;? extends Page&gt;)</code> and <code>to:</code> content option now verify page after switching to the new one to stay consistent with the new behaviour of <code>to(Class&lt;? extends Page&gt;)</code> [<a href="http://jira.codehaus.org/browse/GEB-250">GEB-250</a>].</li>
  <li>Reading an attribute that is not set on a navigator now returns an empty string across all drivers [<a href="http://jira.codehaus.org/browse/GEB-251">GEB-251</a>].</li>
</ul><h3><span id='072'>15.4.2</span> 0.7.2</h3><h4><span id='fixes'>15.4.2.1</span> Fixes</h4>
<ul>
  <li>Further fixes for Java 7 [<a href="http://jira.codehaus.org/browse/GEB-211">GEB-211</a>].</li>
</ul><h3><span id='071'>15.4.3</span> 0.7.1</h3><h4><span id='new_features'>15.4.3.1</span> New Features</h4>
<ul>
  <li>Geb is now built with Groovy 1.8.6. This was forced to resolve [<a href="http://jira.codehaus.org/browse/GEB-194">GEB-194</a>].</li>
</ul><h4><span id='fixes'>15.4.3.2</span> Fixes</h4>
<ul>
  <li><code>startsWith()</code>, <code>contains()</code> etc. now work for selecting via element text now works for multiline (i.e. <code>&lt;br/&gt;</code>) text [<a href="http://jira.codehaus.org/browse/GEB-202">GEB-202</a>]</li>
  <li>Geb now works with Java 7 [<a href="http://jira.codehaus.org/browse/GEB-194">GEB-194</a>].</li>
</ul><h3><span id='070'>15.4.4</span> 0.7.0</h3><h4><span id='new_features'>15.4.4.1</span> New Features</h4>
<ul>
  <li>Added support for indexes and ranges in <code>moduleList()</code> method</li>
  <li>Form control shortcuts now also work on page and module content</li>
  <li>Custom timeout message for <code>waitFor()</code> calls</li>
  <li>Navigators can be composed also from content</li>
  <li>Closure expressions passed to <code>waitFor()</code> calls are now transformed so that every statement in them is asserted - this provides better reporting on <code>waitFor()</code> timeouts.</li>
  <li><code>at</code> closure properties of Page classes are now transformed so that every statement in them is asserted - this provides better reporting on failed at checks</li>
  <li>new <code>isAt()</code> method on Browser that behaves like <code>at()</code> used to behave before, i.e. does not throw AssertionError but returns <code>false</code> if at checking fails</li>
  <li><code>withAlert()</code> and <code>withConfirm()</code> now accept a <code>wait</code> option and the possible values are the same as for waiting content</li>
</ul><h4><span id='breaking_changes'>15.4.4.2</span> Breaking Changes</h4>
<ul>
  <li><code>click()</code> now instructs the browser to click <strong>only on the first</strong> element the navigator has matched</li>
  <li>All <code>click()</code> method variants return the reciever</li>
  <li>Content definitions with <code>required: false, wait: true</code> return <code>null</code> and do not throw <code>WaitTimeoutException</code> if the timeout expires</li>
  <li>Assignment statements are not allowed anymore in closure expressions passed to <code>waitFor()</code> calls</li>
  <li><code>at()</code> now throws AssertionException if at checking fails instead of returning false</li>
</ul><h3><span id='063_'>15.4.5</span> 0.6.3</h3><h4><span id='new_features'>15.4.5.1</span> New Features</h4>
<ul>
  <li>Compatibility with Spock 0.6</li>
</ul><h3><span id='062'>15.4.6</span> 0.6.2</h3><h4><span id='new_features'>15.4.6.1</span> New Features</h4>
<ul>
  <li>New <code>interact()</code> function for mouse and keyboard actions which delegates to the WebDriver Actions class</li>
  <li>New <code>moduleList()</code> function for repeating content</li>
  <li>New <code>withFrame()</code> method for working with frames</li>
  <li>New <code>withWindow()</code> and <code>withNewWindow()</code> methods for working with multiple windows</li>
  <li>Added <code>getCurrentWindow()</code> and <code>getAvailableWindows()</code> methods to browser that delegate to the underlying driver instance</li>
  <li>Content aliasing is now possible using <code>aliases</code> parameter in content DSL</li>
  <li>If config script is not found a config class will be used if there is any - this is usefull if you run test using Geb from IDE</li>
  <li>Drivers are now cached across the whole JVM, which avoids the browser startup cost in some situations</li>
  <li>Added config option to disable quitting of cached browsers on JVM shutdown</li>
</ul><h4><span id='breaking_changes'>15.4.6.2</span> Breaking Changes</h4>
<ul>
  <li>The <code>Page.convertToPath()</code> function is now responsible for adding a prefix slash if required (i.e. it&rsquo;s not added implicitly in <code>Page.getPageUrl()</code>) [GEB-139].</li>
  <li>Unchecked checkboxes now report their value as <code>false</code> instead of null</li>
</ul><h3><span id='061'>15.4.7</span> 0.6.1</h3><h4><span id='new_features'>15.4.7.1</span> New Features</h4>
<ul>
  <li>Compatibility with at least Selenium 2.9.0 (version 0.6.0 of Geb did not work with Selenium 2.5.0 and up)</li>
  <li>Attempting to set a select to a value that it does not contain now throws an exception</li>
  <li>The waiting algorithm is now time based instead of number of retries based, which is better for blocks that are not near instant</li>
  <li>Better support for working with already instantiated pages</li>
</ul><h4><span id='breaking_changes'>15.4.7.2</span> Breaking Changes</h4>
<ul>
  <li>Using <code>&lt;select&gt;</code> elements with Geb now requires an explicit dependency on an extra WebDriver jar (see <a href="intro.html#installation__usage">the section on installation for more info</a>)</li>
  <li>The <code>Navigator</code> <code>classes()</code> method now returns a <code>List</code> (instead of <code>Set</code>) and guarantees that it will be sorted alphabetically</li>
</ul><h3><span id='06'>15.4.8</span> 0.6</h3><h4><span id='new_features'>15.4.8.1</span> New Features</h4>
<ul>
  <li>selenium-common is now a &lsquo;provided&rsquo; scoped dependency of Geb</li>
  <li>Radio buttons can be selected with their label text as well as their value attribute.</li>
  <li>Select options can be selected with their text as well as their value attribute.</li>
  <li><code>Navigator.getAttribute</code> returns <code>null</code> rather than the empty string when an attribute is not found.</li>
  <li>The <code>jquery</code> property on <code>Navigator</code> now returns whatever the jQuery method called on it returns.</li>
  <li>All waitFor clauses now treat exceptions raised in the condition as an evaluation failure, instead of propagating the exception</li>
  <li>Content can be defined with <code>wait: true</code> to make Geb implicitly wait for it when it is requested</li>
  <li>Screenshots are now taken when reporting for all drivers that implement the <code>TakesScreenshot</code> interface (which is nearly all)</li>
  <li>Added <code>BindingUpdater</code> class that can manage a groovy script binding for use with Geb</li>
  <li>Added <code>quit()</code> and <code>close()</code> methods to browser that delegate to the underlying driver instance</li>
  <li><code>geb.Browser.drive()</code> methods now return the used <code>Browser</code> instance</li>
  <li>The underlying WebElements of a Navigator are now retrievable</li>
  <li>Added $() methods that take one or more Navigator or WebElement objects and returns a new Navigator composed of these objects</li>
  <li>Added Direct Download API which can be used for directly downloading content (PDFs, CSVs etc.) into your Geb program (not via the browser)</li>
  <li>Introduced new configuration mechanism for more flexible and environment sensitive configuration of Geb (e.g. driver implementation, base url)</li>
  <li>Default wait timeout and retry interval is now configurable, and can now also use user configuration presets (e.g. quick, slow)</li>
  <li>Added a “build adapter” mechanism, making it easier for build systems to take control of relevant configuration</li>
  <li>The JUnit 3 integration now includes the test method name in the automatically generated reports</li>
  <li>The reporting support has been rewritten, making it much friendlier to use outside of testing</li>
  <li>Added the TestNG support (contributed by Alexander Zolotov)</li>
  <li>Added the <code>height</code>, <code>width</code>, <code>x</code> and <code>y</code> properties to navigator objects and modules</li>
</ul><h4><span id='breaking_changes'>15.4.8.2</span> Breaking Changes</h4>
<ul>
  <li>Raised minimum Groovy version to 1.7</li>
  <li>All failed waitFor clauses now throw a <code>geb.waiting.WaitTimeoutException</code> instead of <code>AssertionError</code></li>
  <li>Upgraded minimum version requirement of WebDriver to 2.0rc1</li>
  <li>The <code>onLoad()</code> and <code>onUnload()</code> page methods both have changed their return types from <code>def</code> to <code>void</code></li>
  <li>The Grails specific testing subclasses have been REMOVED. Use the direct equivalent instead (e.g <code>geb.spock.GebReportingSpec</code> instead of <code>grails.plugin.geb.GebSpec</code>)</li>
  <li>The Grails plugin no longer depends on the test integration modules, you need to depend on the one you want manually</li>
  <li>The <code>getBaseUrl()</code> method from testing subclasses has been removed, use the configuration mechanism</li>
  <li>Inputs with no value now report their value as an empty string instead of <code>null</code></li>
  <li>Select elements that are not multiple select enabled no longer report their value as a 1 element list, but now as the value of the selected element (if no selection, <code>null</code> is returned)</li>
</ul><h3><span id='051'>15.4.9</span> 0.5.1</h3>
<ul>
  <li>Fixed problem with incorrectly compiled specs and the geb grails module</li>
</ul><h3><span id='05'>15.4.10</span> 0.5</h3><h4><span id='new_features'>15.4.10.1</span> New Features</h4>
<ul>
  <li>Navigator objects now implement the Groovy truth (empty == false, non empty == true)</li>
  <li>Introduced “js” short notation</li>
  <li>Added “<a href="http://www.easyb.org/">easyb</a>” support (<code>geb-easyb</code> and Grails support)</li>
  <li>Page change listening support through <code>geb.PageChangeListener</code></li>
  <li><code>waitFor()</code> methods added, making dealing with dynamic pages easier</li>
  <li>Support for <code>alert()</code> and <code>confirm()</code> dialogs</li>
  <li>Added jQuery integration</li>
  <li>Reporting integration classes (e.g. GebReportingSpec) now save a screenshot if using the FirefoxDriver</li>
  <li>Added <code>displayed</code> property to navigator objects for determining visibility</li>
  <li>Added <code>find</code> as an alias for <code>$</code> (e.g. <code>find(&quot;div.section&quot;)</code>)</li>
  <li>Browser objects now implement the <code>page(List&lt;Class&gt;)</code> method that sets the page to the first type whose at-checker matches the page</li>
  <li>The click() methods that take one or more page classes are now available on <code>Navigator</code> objects</li>
  <li>Added page lifecycle methods <code>onLoad()</code>/<code>onUnload()</code></li>
</ul><h4><span id='breaking_changes'>15.4.10.2</span> Breaking Changes</h4>
<ul>
  <li>Exceptions raised in <code>drive()</code> blocks are no longer wrapped with <code>DriveException</code></li>
  <li>the <code>at(Class pageClass)</code> method no longer requires the existing page instance to be of that class (page will be updated if the given type matches)</li>
</ul><h3><span id='04'>15.4.11</span> 0.4</h3><p><strong>Initial Public Release</strong></p>
    </div>
  
  </div>
  <p style="text-align: center">
    The Book of <a href="http://www.gebish.org">Geb</a> - 0.9.0 - April, 2013<br />
    Licensed under the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>
  </p>
</body>
</html>